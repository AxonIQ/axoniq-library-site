<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Implementation :: ðŸ“š AxonIQ Library</title>
    <link rel="prev" href="README.html">
    <link rel="next" href="associations.html">
    <meta name="generator" content="Antora 3.1.1">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">ðŸ“š AxonIQ Library</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Explanations</a>
          <div class="navbar-dropdown">
                <a class="navbar-item" href="../../../../concepts/index.html">Software Development Concepts</a>
                <a class="navbar-item" href="../../../../understanding-axon/index.html">Understanding Axon</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">References</a>
          <div class="navbar-dropdown">
                <a class="navbar-item" href="../../../../axon_framework_ref/4.6/index.html">Axon Framework</a>
                <a class="navbar-item" href="../../README.html">Axon Legacy Reference Guide</a>
                <a class="navbar-item" href="../../../../axon_server_ref/4.6/index.html">Axon Server</a>
                <a class="navbar-item" href="../../../../axoniq_cloud_ref/latest/index.html">AxonIQ Cloud</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Tutorials</a>
          <div class="navbar-dropdown">
                <a class="navbar-item" href="../../../../giftcard/4.6/index.html">Axon Framework - from design to deployment</a>
                <a class="navbar-item" href="../../../../as_admin/index.html">Axon Server Administration</a>
                <a class="navbar-item" href="../../../../af_customization/4.6/index.html">Customizing Axon Framework</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">How-to guides</a>
          <div class="navbar-dropdown">
                <a class="navbar-item" href="../../../../ac_howtos/latest/index.html">AxonIQ Cloud Console How-to Guides</a>
          </div>
        </div>
        <a class="navbar-item" href="https://academy.axoniq.io" target="_blank">AxonIQ Academy</a>
        <a class="navbar-item" href="https://discuss.axoniq.io" target="_blank">Discuss</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="lagacy_ref_gute" data-version="4.6">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../README.html">Axon Legacy Reference Guide</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../README.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../architecture-overview/README.html">Architecture Overview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../architecture-overview/ddd-cqrs-concepts.html">DDD &amp; CQRS Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../architecture-overview/event-sourcing.html">Event Sourcing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../architecture-overview/event-driven-microservices.html">Event-Driven Microservices</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../axon-server-introduction.html">Axon Server</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/README.html">Release Notes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-axon-framework/README.html">Axon Framework</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../release-notes/rn-axon-framework/rn-af-major-releases.html">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../release-notes/rn-axon-framework/rn-af-minor-releases.html">Minor Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-axon-server/README.html">Axon Server</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../release-notes/rn-axon-server/rn-as-major-releases.html">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../release-notes/rn-axon-server/rn-asse-minor-releases.html">Minor Releases Standard Edition</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../release-notes/rn-axon-server/rn-as-minor-releases.html">Minor Releases Enterprise Edition</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/README.html">Axon Framework Extensions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-amqp/README.html">AMQP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-amqp/rn-amqp-major-releases.html">Major Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-cdi/README.html">CDI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-cdi/rn-cdi-major-releases.html">Major Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-jgroups/README.html">JGroups</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-jgroups/rn-jgroups-major-releases.html">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-jgroups/rn-jgroups-minor-releases.html">Minor Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-kafka/README.html">Kafka</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-kafka/rn-kafka-major-releases.html">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-kafka/rn-kafka-minor-releases.html">Minor Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-kotlin/README.html">Kotlin</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-kotlin/rn-kotlin-major-releases.html">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-kotlin/rn-kotlin-experimental-releases.html">Experimental Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-mongo/README.html">Mongo</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-mongo/rn-mongo-major-releases.html">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-mongo/rn-mongo-minor-releases.html">Minor Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-multi-tenancy/README.html">Multi-Tenancy</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-multi-tenancy/rn-multi-tenancy-major-releases.html">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-multi-tenancy/rn-multi-tenancy-minor-releases.html">Minor Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-reactor/README.html">Reactor</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-reactor/rn-reactor-major-releases.html">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-reactor/rn-reactor-minor-releases.html">Minor Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-spring-native/README.html">Spring-Native Cloud</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-spring-native/rn-spring-native-experimental-releases.html">Experimental Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-springcloud/README.html">Spring Cloud</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-springcloud/rn-springcloud-major-releases.html">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-springcloud/rn-springcloud-minor-releases.html">Minor Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-tracing/README.html">Tracing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-tracing/rn-tracing-major-releases.html">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../release-notes/rn-extensions/rn-tracing/rn-tracing-minor-releases.html">Minor Releases</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../getting-started/quick-start.html">Quick Start</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Axon Framework</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../messaging-concepts/README.html">Messaging Concepts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../messaging-concepts/anatomy-message.html">Anatomy of a Message</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../messaging-concepts/message-correlation.html">Message Correlation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../messaging-concepts/message-intercepting.html">Message Intercepting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../messaging-concepts/supported-parameters-annotated-handlers.html">Supported Parameters for Annotated Handlers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../messaging-concepts/exception-handling.html">Exception Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../messaging-concepts/unit-of-work.html">Unit of Work</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../axon-framework-commands/README.html">Commands</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../axon-framework-commands/modeling/README.html">Modeling</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../axon-framework-commands/modeling/aggregate.html">Aggregate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../axon-framework-commands/modeling/multi-entity-aggregates.html">Multi-Entity Aggregates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../axon-framework-commands/modeling/state-stored-aggregates.html">State Stored Aggregates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../axon-framework-commands/modeling/aggregate-creation-from-another-aggregate.html">Aggregate Creation from another Aggregate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../axon-framework-commands/modeling/aggregate-polymorphism.html">Aggregate Polymorphism</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../axon-framework-commands/modeling/conflict-resolution.html">Conflict Resolution</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../axon-framework-commands/command-dispatchers.html">Command Dispatchers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../axon-framework-commands/command-handlers.html">Command Handlers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../axon-framework-commands/infrastructure.html">Infrastructure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../axon-framework-commands/configuration.html">Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../events/README.html">Events</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../events/event-dispatchers.html">Event Dispatchers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../events/event-handlers.html">Event Handlers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../events/event-processors/README.html">Event Processors</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../events/event-processors/subscribing.html">Subscribing Event Processors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../events/event-processors/streaming.html">Streaming Event Processors</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../events/event-bus-and-event-store.html">Event Bus &amp; Event Store</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../events/event-versioning.html">Event Versioning</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../queries/README.html">Queries</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../queries/query-processing.html">Query Processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../queries/query-dispatchers.html">Query Dispatchers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../queries/query-handlers.html">Query Handlers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../queries/implementations.html">Implementations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../queries/configuration.html">Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="README.html">Sagas</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="implementation.html">Implementation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="associations.html">Associations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="infrastructure.html">Infrastructure</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../deadlines/README.html">Deadlines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deadlines/deadline-managers.html">Deadline Managers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deadlines/event-schedulers.html">Event Schedulers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../testing/README.html">Testing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../testing/commands-events.html">Commands / Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../testing/sagas-1.html">Sagas</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../serialization.html">Serialization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tuning/README.html">Tuning</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tuning/event-snapshots.html">Event Snapshots</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tuning/event-processing.html">Event Processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tuning/command-processing.html">Command Processing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../monitoring/README.html">Monitoring and Metrics</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../monitoring/tracing.html">Distributed Tracing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../monitoring/metrics.html">Metrics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../monitoring/health.html">Health Indicators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../monitoring/processors.html">Event Tracker Status</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../monitoring/message-tracking.html">Message Tracking</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../spring-boot-integration.html">Spring Boot Integration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../modules.html">Modules</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Axon Server</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../axon-server/introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-server/installation/README.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-server/installation/local-installation/README.html">Local Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/installation/local-installation/axon-server-se.html">Axon Server SE</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/installation/local-installation/axon-server-ee.html">Axon Server EE</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-server/installation/docker-k8s/README.html">Docker / K8s</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/installation/docker-k8s/axon-server-se.html">Axon Server SE</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/installation/docker-k8s/axon-server-ee.html">Axon Server EE</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-server/administration/README.html">Administration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-server/administration/admin-configuration/README.html">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/administration/admin-configuration/configuration.html">System Properties</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/administration/admin-configuration/command-line-interface.html">Command Line Interface</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/administration/admin-configuration/rest-api.html">REST API</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/administration/admin-configuration/grpc-api.html">GRPC API</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-server/administration/monitoring/README.html">Monitoring</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/administration/monitoring/actuator-endpoints.html">Actuator Endpoints</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/administration/monitoring/grpc-metrics.html">gRPC Metrics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/administration/monitoring/heartbeat-monitoring.html">Heartbeat Monitoring</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/administration/clustering.html">Clusters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/administration/replication-groups.html">Replication Groups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/administration/multi-context.html">Multi-Context</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/administration/tagging.html">Tagging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/administration/backup-and-messaging-only-nodes.html">Backup and Messaging-only Nodes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/administration/backups.html">Backups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/administration/recovery.html">Recovery</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/administration/plugins.html">Plugins</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-server/administration/logging/README.html">Logging</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-server/administration/logging/logging-format.html">Logging Format</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/administration/error-codes.html">Error Codes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-server/security/README.html">Security</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/security/ssl.html">SSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/security/access-control.html">Access Control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/security/access-control-se.html">Access Control - Standard Edition</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/security/access-control-ee.html">Access Control - Enterprise Edition</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/security/access-control-clients.html">Access Control - Client Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/security/access-control-cli.html">Access Control - CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/security/access-control-api.html">Access Control - API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/security/access-control-ldap.html">Access Control - LDAP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/security/access-control-oauth2.html">Access Control - OAuth 2.0</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-server/performance/README.html">Performance</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/performance/tuning-event-processing.html">Event Segments</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/performance/flow-control.html">Flow Control</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-server/migration/README.html">Migration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/migration/standard-to-enterprise-edition.html">Standard to Enterprise Edition</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-server/migration/non-axon-server-to-axon-server.html">Non-Axon Server to Axon Server</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extensions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../extensions/spring-amqp.html">Spring AMQP</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../extensions/jgroups.html">JGroups</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../extensions/kafka.html">Kafka</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../extensions/kotlin.html">Kotlin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../extensions/mongo.html">Mongo</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../extensions/reactor/reactor.html">Reactor</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../extensions/reactor/reactive-gateways/reactive-gateways.html">Reactor Gateways</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../extensions/spring-cloud.html">Spring Cloud</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../extensions/tracing.html">Tracing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Appendices</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="/lagacy_ref_gute/4.6/appendices/rdbms-tuning.html" class="xref page">A.
RDBMS Tuning</a></span>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text"><a href="/lagacy_ref_gute/4.6/appendices/message-handler-tuning/README.html" class="xref page">B.
Message Handler Tuning</a></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../appendices/message-handler-tuning/parameter-resolvers.html">Parameter Resolvers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../appendices/message-handler-tuning/handler-enhancers.html">Handler Enhancers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="/lagacy_ref_gute/4.6/appendices/meta-annotations.html" class="xref page">C.
Meta Annotations</a></span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="/lagacy_ref_gute/4.6/appendices/identifier-generation.html" class="xref page">D.
Identifier Generation</a></span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="#./appendices/query-reference.md.adoc" class="xref unresolved">E.
Axon Server Query Language</a></span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../README.html">Axon Legacy Reference Guide</a></li>
    <li>Axon Framework</li>
    <li><a href="README.html">Sagas</a></li>
    <li><a href="implementation.html">Implementation</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/azzazzel/axoniq-reference-guide/edit/kramdoc/modules/ROOT/pages/axon-framework/sagas/implementation.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Implementation</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A Saga is a special type of event listener: one that manages a business transaction.
Some transactions could be running for days or even weeks, while others are completed within a few milliseconds.
In Axon, each instance of a Saga is responsible for managing a single business transaction.
That means a Saga maintains state necessary to manage that transaction, continuing it or taking compensating actions to roll back any actions already taken.
Typically, and contrary to regular event listeners, a saga has a starting point and an end, both triggered by events.
While the starting point of a saga is usually very clear, there could be many ways for a saga to end.</p>
</div>
<div class="paragraph">
<p>In Axon, sagas are classes that define one or more <code>@SagaEventHandler</code> methods.
Unlike regular event handlers, multiple instances of a saga may exist at any time.
Sagas are managed by a single event processor (Tracking or Subscribing), which is dedicated to dealing with events for that specific saga type.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_life_cycle"><a class="anchor" href="#_life_cycle"></a>Life cycle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A single Saga instance is responsible for managing a single transaction.
That means you need to be able to indicate the start and end of a saga&#8217;s life cycle.</p>
</div>
<div class="paragraph">
<p>In a saga, event handlers are annotated with <code>@SagaEventHandler</code>.
If a specific event signifies the start of a transaction, add another annotation to that same method: <code>@StartSaga</code>.
This annotation will create a new saga and invoke its event handler method when a matching event is published.</p>
</div>
<div class="paragraph">
<p>By default, a new saga is only started if no suitable existing saga (of the same type) can be found.
You can also force the creation of a new saga instance by setting the <code>forceNew</code> property on the <code>@StartSaga</code> annotation to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>Ending a saga can be done in two ways.
If a certain event always indicates the end of a saga its life cycle, annotate that event handler on the saga with <code>@EndSaga</code>.
The saga its life cycle will be ended after the invocation of the handler.
Alternatively, you can call <code>SagaLifecycle.end()</code> from inside the saga to end the life cycle.
This allows you to conditionally end the saga.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_event_handling"><a class="anchor" href="#_event_handling"></a>Event handling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Event handling in a saga is quite comparable to that of a regular event listener.
The same rules for method and parameter resolution are valid here.
There is one major difference, though.
While there is a single instance of an event listener that deals with all incoming events, multiple instances of a saga may exist, each interested in different events.
For example, a saga that manages a transaction around an Order with Id "1" will not be interested in events regarding Order "2", and vice versa.</p>
</div>
<div class="paragraph">
<p>Instead of publishing all events to all saga instances (which would be a complete waste of resources), Axon will only publish events containing properties that the saga has been associated with.
This is done using <code>AssociationValue</code>s.
An <code>AssociationValue</code> consists of a key and a value.
The key represents the type of identifier used, for example "orderId" or "order".
The value represents the corresponding value, "1" or "2" in the previous example.</p>
</div>
<div class="paragraph">
<p>The order in which <code>@SagaEventHandler</code> annotated methods are evaluated is identical to that of <code>@EventHandler</code> methods (see <a href="#../events/event-handlers.adoc" class="xref unresolved">Annotated event handler</a>).
A method matches if the parameters of the handler method match the incoming event, and if the saga has an association with the property defined on the handler method.</p>
</div>
<div class="paragraph">
<p>The <code>@SagaEventHandler</code> annotation has two attributes, of which <code>associationProperty</code> is the most important one.
This is the name of the property on the incoming event that should be used to find associated sagas.
The key of the association value is the name of the property.
The value is the value returned by property its getter method.</p>
</div>
<div class="paragraph">
<p>For example, consider an incoming Event with a method <code>String getOrderId()</code>, which returns "123".
If a method accepting this event is annotated with <code>@SagaEventHandler(associationProperty="orderId")</code>, this Event is routed to all Sagas that have been associated with an <code>AssociationValue</code> with key "orderId" and value "123".
This may either be exactly one, more than one, or even none at all.</p>
</div>
<div class="paragraph">
<p>Sometimes, the name of the property you want to associate with is not the name of the association you want to use.
For example, you have a Saga that matches "Sell orders" against "Buy orders", you could have a transaction object that contains the "buyOrderId" and a "sellOrderId".
If you want the saga to associate the "sellOrderId" value as "orderId", you can define a different <code>keyName</code> in the <code>@SagaEventHandler</code> annotation.
It would then become <code>@SagaEventHandler(associationProperty="sellOrderId", keyName="orderId")</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_injecting_resources"><a class="anchor" href="#_injecting_resources"></a>Injecting Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sagas generally do more than just maintaining state based on events.
They interact with external components.
To do so, they need access to the resources necessary to address to components.
Usually, these resources aren&#8217;t really part of the saga and its state and these resources should not be persisted as such.
However, once a saga is reconstructed, these resources must be injected before an event is routed to that instance.</p>
</div>
<div class="paragraph">
<p>For that purpose, there is the <code>ResourceInjector</code>.
It is used by the <code>SagaRepository</code> to inject resources into a saga.
Axon provides a <code>SpringResourceInjector</code>, which injects annotated fields and methods with resources from the Application Context.
Axon also provides a <code>SimpleResourceInjector</code>, which injects resources that have been registered with it into <code>@Inject</code> annotated methods and fields.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Tip</strong></p>
</div>
<div class="paragraph">
<p>Since resources should not be persisted with the saga, make sure to add the <code>transient</code> keyword to those fields.
This will prevent the serialization mechanism to attempt to write the contents of these fields to the repository.
The repository will automatically re-inject the required resources after a saga has been deserialized.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The <code>SimpleResourceInjector</code> allows for a pre-specified collection of resources to be injected.
It scans the (setter) methods and fields of a Saga to find ones that are annotated with <code>@Inject</code>.</p>
</div>
<div class="paragraph">
<p>When using the Configuration API, Axon will default to the <code>ConfigurationResourceInjector</code>.
It will inject any resource available in the configuration.
Components like the <code>EventBus</code>, <code>EventStore</code>, <code>CommandBus</code> and <code>CommandGateway</code> are available by default.
You can also register your own components using <code>configurer.registerComponent()</code>.</p>
</div>
<div class="paragraph">
<p>The <code>SpringResourceInjector</code> uses Spring&#8217;s dependency injection mechanism to inject resources into a Saga.
This means you can use setter injection or direct field injection if you require.
The method or field to be injected needs to be annotated in order for Spring to recognize it as a dependency, for example with <code>@Autowired</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_saga_infrastructure"><a class="anchor" href="#_saga_infrastructure"></a>Saga Infrastructure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Events need to be redirected to the appropriate saga instances.
To do so, some infrastructure classes are required.
The most important components are the <code>SagaManager</code> and the <code>SagaRepository</code>.</p>
</div>
<div class="sect2">
<h3 id="_saga_manager"><a class="anchor" href="#_saga_manager"></a>Saga Manager</h3>
<div class="paragraph">
<p>Like any component that handles events, the processing is done by an <a href="#../events/event-processors/README.adoc" class="xref unresolved">Event Processor</a>.
However, Sagas are not singleton instances handling events.
They have individual life cycles that need to be managed.</p>
</div>
<div class="paragraph">
<p>Axon supports life cycle management through the <code>AnnotatedSagaManager</code>, which is provided to an Event Processor to perform the actual invocation of handlers.
It is initialized using the type of the Saga to manage, as well as a <a href="#saga-repository-and-saga-store"><code>SagaRepository</code></a> where Sagas of that type can be stored and retrieved.
A single <code>AnnotatedSagaManager</code> can only manage a single Saga type.</p>
</div>
</div>
<div class="sect2">
<h3 id="_saga_repository_and_saga_store"><a class="anchor" href="#_saga_repository_and_saga_store"></a>Saga repository and saga store</h3>
<div class="paragraph">
<p>The <code>SagaRepository</code> is responsible for storing and retrieving sagas, for use by the <code>SagaManager</code>.
It is capable of retrieving specific saga instances by their identifier as well as by their association values.</p>
</div>
<div class="paragraph">
<p>There are some special requirements, however.
Since concurrency handling in sagas is a very delicate procedure, the repository must ensure that for each conceptual saga instance (with an equal identifier) only a single instance exists in the JVM.</p>
</div>
<div class="paragraph">
<p>Axon provides the <code>AnnotatedSagaRepository</code> implementation, which allows the lookup of saga instances while guaranteeing that only a single instance of the saga may be accessed at the same time.
It uses a <code>SagaStore</code> to perform the actual persistence of saga instances.</p>
</div>
<div class="paragraph">
<p>The choice for the implementation to use depends mainly on the storage engine used by the application.
Axon provides the <code>JdbcSagaStore</code>, <code>InMemorySagaStore</code>, <code>JpaSagaStore</code> and <code>MongoSagaStore</code>.</p>
</div>
<div class="paragraph">
<p>In some cases, applications benefit from caching saga instances.
In that case, there is a <code>CachingSagaStore</code> which wraps another implementation to add caching behavior.
Note that the <code>CachingSagaStore</code> is a write-through cache, which means save operations are always immediately forwarded to the backing Store, to ensure data safety.</p>
</div>
<div class="sect3">
<h4 id="_jpasagastore"><a class="anchor" href="#_jpasagastore"></a>JpaSagaStore</h4>
<div class="paragraph">
<p>The <code>JpaSagaStore</code> uses JPA to store the state and association values of sagas.
Sagas themselves do not need any JPA annotations;
Axon will serialize the sagas using a <code>Serializer</code> (similar to event serialization, you can choose between an <code>XStreamSerializer</code> or <code>JacksonSerializer</code>, which can be set by configuring the default <code>Serializer</code> in your application.
For more details, see <a href="#../serialization.adoc" class="xref unresolved">Serializers</a>.</p>
</div>
<div class="paragraph">
<p>The <code>JpaSagaStore</code> is configured with an <code>EntityManagerProvider</code>, which provides access to an <code>EntityManager</code> instance to use.
This abstraction allows for the use of both application managed and container managed <code>EntityManager</code>s.
Optionally, you can define the serializer to serialize the Saga instances with.
Axon defaults to the <code>XStreamSerializer</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_jdbcsagastore"><a class="anchor" href="#_jdbcsagastore"></a>JdbcSagaStore</h4>
<div class="paragraph">
<p>The <code>JdbcSagaStore</code> uses plain JDBC to store stage instances and their association values.
Similar to the <code>JpaSagaStore</code>, saga instances do not need to be aware of how they are stored.
They are serialized using a serializer.</p>
</div>
<div class="paragraph">
<p>The <code>JdbcSagaStore</code> is initialized with either a <code>DataSource</code> or a <code>ConnectionProvider</code>.
While not required, when initializing with a <code>ConnectionProvider</code>, it is recommended to wrap the implementation in a <code>UnitOfWorkAwareConnectionProviderWrapper</code>.
It will check the current Unit of Work for an already open database connection, to ensure that all activity within a unit of work is done on a single connection.</p>
</div>
<div class="paragraph">
<p>Unlike JPA, the <code>JdbcSagaRepository</code> uses plain SQL statements to store and retrieve information.
This may mean that some operations depend on the database specific SQL dialect.
It may also be the case that certain database vendors provide non-standard features that you would like to use.
To allow for this, you can provide your own <code>SagaSqlSchema</code>.
The <code>SagaSqlSchema</code> is an interface that defines all the operations the repository needs to perform on the underlying database.
It allows you to customize the SQL statement executed for each operation.
The default is the <code>GenericSagaSqlSchema</code>.
Other implementations available are <code>PostgresSagaSqlSchema</code>, <code>Oracle11SagaSqlSchema</code> and <code>HsqlSagaSchema</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mongosagastore"><a class="anchor" href="#_mongosagastore"></a>MongoSagaStore</h4>
<div class="paragraph">
<p>The <code>MongoSagaStore</code> stores the saga instances and their associations in a MongoDB database.
The <code>MongoSagaStore</code> stores all sagas in a single collection in a MongoDB database.
For each saga instance, a single document is created.</p>
</div>
<div class="paragraph">
<p>The <code>MongoSagaStore</code> also ensures that at any time, only a single Saga instance exists for any unique Saga in a single JVM.
This ensures that no state changes are lost due to concurrency issues.</p>
</div>
<div class="paragraph">
<p>The <code>MongoSagaStore</code> is initialized using a <code>MongoTemplate</code> and optionally a <code>Serializer</code>.
The <code>MongoTemplate</code> provides a reference to the collection to store the sagas in.
Axon provides the <code>DefaultMongoTemplate</code>, which takes a <code>MongoClient</code> instance as well as the database name and name of the collection to store the sagas in.
The database name and collection name may be omitted.
In that case, they default to <code>"axonframework"</code> and <code>"sagas"</code>, respectively.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_caching"><a class="anchor" href="#_caching"></a>Caching</h3>
<div class="paragraph">
<p>If a database backed saga storage is used, saving and loading saga instances may be a relatively expensive operation.
In situations where the same saga instance is invoked multiple times within a short time span, a cache can be especially beneficial to the application&#8217;s performance.</p>
</div>
<div class="paragraph">
<p>Axon provides the <code>CachingSagaStore</code> implementation.
It is a <code>SagaStore</code> that wraps another one, which does the actual storage.
When loading sagas or association values, the <code>CachingSagaStore</code> will first consult its caches, before delegating to the wrapped repository.
When storing information, all calls are always delegated to ensure that the backing storage always has a consistent view on the saga&#8217;s state.</p>
</div>
<div class="paragraph">
<p>To configure caching, simply wrap any <code>SagaStore</code> in a <code>CachingSagaStore</code>.
The constructor of the <code>CachingSagaStore</code> takes three parameters: 1.
The <code>SagaStore</code> to wrap 2.
The cache to use for association values 3.
The cache to use for saga instances</p>
</div>
<div class="paragraph">
<p>The latter two arguments may refer to the same cache, or to different ones.
This depends on the eviction requirements of your specific application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_a_saga"><a class="anchor" href="#_configuring_a_saga"></a>Configuring a Saga</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although a Saga requires a <a href="#saga-manager">manager</a>, <a href="#saga-repository-and-saga-store">repository / store</a> and wiring to the right message busses, configuring a Saga is straightforward.
When using the Configuration API, Axon will use sensible defaults for most components.</p>
</div>
<div class="paragraph">
<p>As a specific type of <a href="#../events/event-handlers.adoc" class="xref unresolved">Event Handling Component</a>, configuration of a Saga is closely related to the configuration of <a href="#../events/event-processors/README.adoc" class="xref unresolved">Event Processors</a>.
Due to this, configuring a processor will impact the behaviour of a Saga, albeit on a non-functional level.
The configuration of <a href="../events/event-processors/README.md#error-handling">error handling</a> or <a href="../events/event-processors/README.md#assigning-handlers-to-processors">processor assignment rules</a>, for example, are thus equally valid for Sagas as long as the right processor name is used during configuration.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Default Saga Processor name</strong></p>
</div>
<div class="paragraph">
<p>As a Saga is a type of event handler, it is part of an Event Processor.
Without defining any <a href="../events/event-processors/README.md#assigning-handlers-to-processors">assignment rules</a>, a Saga&#8217;s processor name equals the Saga name appended with "Processor",</p>
</div>
<div class="paragraph">
<p>With a Saga called <code>MySaga</code>, that would mean the processor is called <code>MySagaProcessor</code>.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Internally, Axon uses a <code>SagaConfigurer</code> to construct the Saga, Saga Manager, Saga Repository and Saga Store.
A default configuration for a Saga called <code>MySaga</code> would look as follows:</p>
</div>
<div class="paragraph">
<p>{% tabs %} {% tab title="Axon Configuration API" %} As a specific type of event handler, registering a Saga is done through the <code>EventProcessingConfigurer</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AxonConfig {
    // omitting other configuration methods...
    void configureMySaga(EventProcessingConfigurer eventProcessingConfigurer) {
        eventProcessingConfigurer.registerSaga(MySaga.class);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endtab %}</p>
</div>
<div class="paragraph">
<p>{% tab title="Spring Boot AutoConfiguration" %} In a Spring environment, the Saga implementation should be annotated with <code>@Saga</code> to auto-configure it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.axonframework.spring.stereotype.Saga;

@Saga
class MySaga {
    // saga implementation left out...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endtab %} {% endtabs %}</p>
</div>
<div class="paragraph">
<p>Although the defaults lead us to a working Saga environment, it is recommended to define the <a href="#saga-repository-and-saga-store"><code>SagaStore</code></a> to use.
The <code>SagaStore</code> represents the mechanism that 'physically' stores the Saga instances, for which it uses the <code>AnnotatedSagaRepository</code> (the default) to store and retrieve Saga instances.
If no <code>SagaStore</code> is configured Axon defaults an <code>InMemorySagaStore</code>, thus not persisting the Saga on shutdown.
To configure a <code>SagaStore</code> for <code>MySaga</code> consider the following snippet:</p>
</div>
<div class="paragraph">
<p>{% tabs %} {% tab title="Axon Configuration API" %} To define a custom <code>SagaStore</code>, the <code>SagaConfigurer</code> should be used through the <code>EventProcessingConfigurer#registerSaga(Class&lt;T&gt;, Consumer&lt;SagaConfigurer&lt;T&gt;&gt;)</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AxonConfig {
    // omitting other configuration methods...
    void configureMySaga(EventProcessingConfigurer eventProcessingConfigurer,
                         EntityManagerProvider entityManagerProvider) {
        eventProcessingConfigurer.registerSaga(
                MySaga.class,
                sagaConfigurer -&gt; sagaConfigurer.configureSagaStore(
                        c -&gt; JpaSagaStore.builder()
                                         .entityManagerProvider(entityManagerProvider)
                                         .build()
                )
        );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, a default store can be defined through <code>EventProcessingConfigurer#registerSagaStore(Function&lt;Configuration, SagaStore&gt;)</code> method.
{% endtab %}</p>
</div>
<div class="paragraph">
<p>{% tab title="Spring Boot AutoConfiguration" %} When Spring Boot is used and JPA or JDBC is on the classpath, then Axon auto-configures a <code>JpaSagaStore</code> or <code>JdbcSagaStore</code> respectively.
To provide a custom <code>SagaStore</code>, providing a bean to the application context and defining the bean name on the <code>@Saga</code> annotation suffices:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.axonframework.spring.stereotype.Saga;

@Saga(sagaStore = "mySagaStore")
public class MySaga {
    // saga implementation left out...
}

@Configuration
public class AxonConfig {
    // omitting other configuration methods...
    @Bean
    public SagaStore mySagaStore(DataSource dataSource) {
        return JdbcSagaStore.builder()
                            .dataSource(dataSource)
                            .build();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>{% endtab %} {% endtabs %}</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="README.html">Sagas</a></span>
  <span class="next"><a href="associations.html">Associations</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="primary-footer">
    <div class="footer-logo ">
      <a href="https://axoniq.io/">
        <img src="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png" alt="Logo AxonIQ" loading="lazy" srcset="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=45&amp;height=10&amp;name=Logo%20AxonIQ%20(2).png 45w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png 90w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=135&amp;height=30&amp;name=Logo%20AxonIQ%20(2).png 135w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=180&amp;height=40&amp;name=Logo%20AxonIQ%20(2).png 180w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=225&amp;height=50&amp;name=Logo%20AxonIQ%20(2).png 225w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=270&amp;height=60&amp;name=Logo%20AxonIQ%20(2).png 270w" sizes="(max-width: 90px) 100vw, 90px" width="90" height="20">
      </a>
    </div>

    <div class="footer-menu">
	    <h3>Products</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-framework/overview">Axon Framework</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-server/overview">Axon Server Standard</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-server-enterprise/overview">Axon Server Enterprise</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axoniq-cloud/overview">AxonIQ Cloud</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-data-protection/overview">AxonIQ Data Protection</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Sites</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="http://support.axoniq.io/"> Client Support Portal</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/">AxonIQ Developer Portal</a></li>
          <li><a class="ext" target="_blank" href="https://academy.axoniq.io/">AxonIQ Academy</a></li>
          <li><a class="ext" target="_blank" href="https://discuss.axoniq.io/">AxonIQ Discuss</a></li>
          <li><a class="ext" target="_blank" href="https://start.axoniq.io/">AxonIQ Initializr</a></li>
          <li><a class="ext" target="_blank" href="https://console.cloud.axoniq.io">AxonIQ Cloud</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Follow us</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.youtube.com/axoniq">YouTube</a></li>
          <li><a class="ext" target="_blank" href="https://www.linkedin.com/company/axoniq">LinkedIn</a></li>
          <li><a class="ext" target="_blank" href="https://www.facebook.com/AxonIQ.io">Facebook</a></li>
          <li><a class="ext" target="_blank" href="https://twitter.com/axon_iq">Twitter</a></li>
          <li><a class="ext" target="_blank" href="https://github.com/AxonIQ">GitHub</a></li>
          <li><a class="ext" target="_blank" href="https://medium.com/axoniq">Medium</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
