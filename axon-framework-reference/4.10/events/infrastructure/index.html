<!DOCTYPE html>
<html lang="en">
  <head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Event Bus &amp; Event Store</title>
    <link rel="canonical" href="https://docs.axoniq.io/axon-framework-reference/4.11/events/infrastructure/">
    <link rel="prev" href="../event-processors/dead-letter-queue/">
    <link rel="next" href="../event-versioning/">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/vendor/tabs.css">
    <link rel="icon" href="../../../../_/img/favicon.ico" sizes="32x32">
    <link rel="icon" href="../../../../_/img/icon.svg" type="image/svg+xml" media="(prefers-color-scheme: light)">
    <link rel="icon" href="../../../../_/img/icon-light.svg" type="image/svg+xml" media="(prefers-color-scheme: dark)">
    <link rel="apple-touch-icon" href="../../../../_/img/apple-touch-icon.png"><!-- 180Ã—180 -->
    <link rel="manifest" href="../../../../_/static/manifest.webmanifest">
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QD58ZB');</script>
        <!-- End Google Tag Manager -->

    <script>var uiRootPath = '../../../../_'</script>


  </head>
  <body class="article">
    <div class="header_container">
      <div class="banner">
    <a href="https://console.axoniq.io">Manage and monitor your Axon Framework applications and Axon Server environments. <span class="banner_button" target="_blank">Try AxonIQ Console</span></a>
</div>      
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QD58ZB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.axoniq.io"><img src="../../../../_/img/logo-dark4x.png" class="header_logo" /></a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="../../../../home/basics/">Basics</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../../../home/guides/">Guides</a>
          <div class="navbar-dropdown card">
            <a class="navbar-item" href="../../../../home/guides/axon-framework">Axon Framework</a>
            <a class="navbar-item" href="../../../../home/guides/axon-server">Axon Server</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../../../home/reference/">Reference</a>
          <div class="navbar-dropdown card">
                <a class="navbar-item" href="../../../4.11/">Axon Framework</a>
                <a class="navbar-item" href="../../../../axon-framework-extensions/">Axon Framework Extensions</a>
                <a class="navbar-item" href="../../../../axon-server-reference/v2025.1/">Axon Server</a>
                <a class="navbar-item" href="../../../../synapse-reference/v0.12/">Axon Synapse</a>
                <a class="navbar-item" href="../../../../axoniq-console-reference/">AxonIQ Console</a>
          </div>
        </div>
      </div>
      <div class="navbar-end">
        <div class="navbar-item search hide-for-print">
          <div id="search-field" class="field">
            <input id="search-input" type="text" placeholder="Search AxonIQ Docs">
          </div>
        </div>
        <a class="navbar-item navbar-button" href="https://academy.axoniq.io" target="_blank">AxonIQ Academy</a>
        <a class="navbar-item navbar-button" href="https://discuss.axoniq.io" target="_blank">AxonIQ Discuss</a>
        <a class="navbar-item navbar-button" href="https://axoniq.io/contact" target="_blank">Get in touch</a>
      </div>
    </div>
  </nav>
</header>
      <div class="toolbar card" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../home/" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../">Axon Framework Reference</a></li>
    <li><a href="../">Events</a></li>
    <li><a href="./">Infrastructure</a></li>
  </ul>
</nav>
<div class="page-actions">
  <button class="actions-menu-toggle" title="Show actions related to this page">Actions</button>
  <div class="actions-menu toolbar_dropdown_menu card">
      <a class="action item" href="https://github.com/AxonFramework/AxonFramework/edit/axon-4.10.x/docs/old-reference-guide/modules/events/pages/infrastructure.adoc">Edit this Page</a>
    
    <a class="action item" href="https://discuss.axoniq.io/search?q&#x3D;Event%20Bus%20%26amp%3B%20Event%20Store" target="discuss_search">View Discussions</a>
    <a class="action item" href="https://discuss.axoniq.io/new-topic?category&#x3D;library&amp;title&#x3D;%22Event%20Bus%20%26amp%3B%20Event%20Store%22%20Discussion&amp;body&#x3D;%3C!--%20Replace%20this%20comment%20with%20your%20comment%2Fsuggestion%2Fquestion%2F...%20--%3E%0A%0A%0A%3C!--%0AKeep%20the%20section%20below!%0ALinking%20back%20to%20the%20documentation%20URL%20not%20only%20helps%20people%20go%20to%20the%20page%0Abut%20also%20helps%20find%20relevant%20discussions%20from%20the%20documentation%20page%20via%20the%20%22View%20Discussion%22%20menu.%0A--%3E%0A%5Bdetails%3D%22Related%20library%20page%22%5D%0A%5BEvent%20Bus%20%26amp%3B%20Event%20Store%5D(https%3A%2F%2Fdocs.axoniq.io%2Faxon-framework-reference%2F4.10%2Fevents%2Finfrastructure%2F)%0A%5B%2Fdetails%5D%0A" target="discuss_add">Start new discussion</a>
  </div>
</div>


<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">4.10</button>
  <div class="version-menu toolbar_dropdown_menu card">
    <a class="version item" href="../../../4.12/events/infrastructure/">4.12</a>
    <a class="version item" href="../../../4.11/events/infrastructure/">4.11</a>
    <a class="version item is-current" href="./">4.10</a>
    <a class="version item is-missing" href="../../../0/">older releases</a>
  </div>
</div>
</div>
    </div>
    <div class="content_container">
      <div class="body">
<div class="nav-container" data-component="axon-framework-reference" data-version="4.10">
    <aside class="nav card">
      <div class="panels">
        <div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../">Axon Framework</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../upgrading-to-4-7/">Upgrading to Axon Framework 4.7</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../messaging-concepts/">Messaging Concepts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/anatomy-message/">Anatomy of a Message</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/message-correlation/">Message Correlation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/message-intercepting/">Message Intercepting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/supported-parameters-annotated-handlers/">Supported Parameters for Annotated Handlers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/exception-handling/">Exception Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/unit-of-work/">Unit of Work</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-framework-commands/">Commands</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-framework-commands/command-handlers/">Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-framework-commands/command-dispatchers/">Dispatching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../axon-framework-commands/modeling/aggregate/">Aggregates</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-framework-commands/modeling/multi-entity-aggregates/">Multi-Entity Aggregates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-framework-commands/modeling/state-stored-aggregates/">State Stored Aggregates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-framework-commands/modeling/aggregate-creation-from-another-aggregate/">Aggregate Creation from another Aggregate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-framework-commands/modeling/aggregate-polymorphism/">Aggregate Polymorphism</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../axon-framework-commands/modeling/conflict-resolution/">Conflict Resolution</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-framework-commands/infrastructure/">Infrastructure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../axon-framework-commands/configuration/">Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../">Events</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../event-handlers/">Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../event-dispatchers/">Dispatching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../event-processors/">Event Processors</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../event-processors/subscribing/">Subscribing Event Processor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../event-processors/streaming/">Streaming Event Processor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../event-processors/dead-letter-queue/">Dead-Letter Queue</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="./">Infrastructure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../event-versioning/">Event Versioning</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../queries/">Queries</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/query-handlers/">Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/query-dispatchers/">Dispatching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/implementations/">Implementations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/configuration/">Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../sagas/">Sagas</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../sagas/implementation/">Implementation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../sagas/associations/">Associations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../sagas/infrastructure/">Infrastructure</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../deadlines/">Deadlines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../deadlines/deadline-managers/">Deadline Managers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../deadlines/event-schedulers/">Event Schedulers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../testing/">Testing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../testing/commands-events/">Commands / Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../testing/sagas-1/">Sagas</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../serialization/">Serialization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../tuning/">Tuning</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../tuning/event-snapshots/">Event Snapshots</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../tuning/event-processing/">Event Processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../tuning/command-processing/">Command Processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../tuning/rdbms-tuning/">Relational Databases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../monitoring/">Monitoring</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../monitoring/tracing/">Distributed Tracing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../monitoring/metrics/">Metrics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../monitoring/health/">Health Indicators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../monitoring/processors/">Event Processor Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../monitoring/message-tracking/">Message Tracking</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../spring-boot-integration/">Spring Boot Integration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../modules/">Modules</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/">Release Notes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../release-notes/major-releases/">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../release-notes/minor-releases/">Minor Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../known-issues-and-workarounds/">Known Issues and Workarounds</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
      </div>
    </aside>
</div>
<main class="article">
    <div class="page_content">
        <aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
          <article class="doc">
                <h1 class="page">Event Bus &amp; Event Store</h1>
            <div class="sect1">
<h2 id="_event_bus"><a class="anchor" href="#_event_bus"></a>Event bus</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>EventBus</code> is the mechanism that dispatches events to the subscribed event handlers.
Axon provides three implementations of the Event Bus: <code>AxonServerEventStore</code>, <code>EmbeddedEventStore</code> and <code>SimpleEventBus</code>.
All three implementations support subscribing and tracking processors (see <a href="../event-processors/" class="xref page">Event Processors</a>).
However, the <code>AxonServerEventStore</code> and <code>EmbeddedEventStore</code> persist events (see <a href="#event-store">Event Store</a>), which allows you to replay them at a later stage.
The <code>SimpleEventBus</code> has a volatile storage and 'forgets' events as soon as they have been published to subscribed components.</p>
</div>
<div class="paragraph">
<p>An <code>AxonServerEventStore</code> event bus/store is configured by default.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="event-store"><a class="anchor" href="#event-store"></a>Event store</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Event sourcing repositories need an event store to store and load events from aggregates.
An event store offers the functionality of an event bus.
Additionally, it persists published events and is able to retrieve previous events based on a given aggregate identifier.</p>
</div>
<div class="sect2">
<h3 id="_axon_server_as_an_event_store"><a class="anchor" href="#_axon_server_as_an_event_store"></a>Axon Server as an event store</h3>
<div class="paragraph">
<p>Axon provides an event store out of the box, the <code>AxonServerEventStore</code>.
It connects to the <a href="https://www.axoniq.io/products/axon-server" class="external" target="_blank" rel="noopener">AxonIQ AxonServer Server</a> to store and retrieve Events.</p>
</div>
<div id="_tabs_1" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_1_configuration_api" class="tab">
<p>Configuration API</p>
</li>
<li id="_tabs_1_spring_boot" class="tab">
<p>Spring Boot</p>
</li>
</ul>
</div>
<div id="_tabs_1_configuration_api--panel" class="tabpanel" aria-labelledby="_tabs_1_configuration_api">
<div class="paragraph">
<p>Declare dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;!--somewhere in the POM file--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.axonframework&lt;/groupId&gt;
    &lt;artifactId&gt;axon-server-connector&lt;/artifactId&gt;
    &lt;version&gt;${axon.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.axonframework&lt;/groupId&gt;
    &lt;artifactId&gt;axon-configuration&lt;/artifactId&gt;
    &lt;version&gt;${axon.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configure your application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Returns a Configurer instance with default components configured.
// `AxonServerEventStore` is configured as Event Store by default.
Configurer configurer = DefaultConfigurer.defaultConfiguration();</code></pre>
</div>
</div>
</div>
<div id="_tabs_1_spring_boot--panel" class="tabpanel" aria-labelledby="_tabs_1_spring_boot">
<div class="paragraph">
<p>By simply declaring a dependency on <code>axon-spring-boot-starter</code>, Axon will automatically configure the event bus/event store:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;!--somewhere in the POM file--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.axonframework&lt;/groupId&gt;
    &lt;artifactId&gt;axon-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;${axon.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Excluding the Axon Server Connector</div>
<div class="paragraph">
<p>If you exclude the <code>axon-server-connector</code> dependency from <code>axon-spring-boot-starter</code> the <code>EmbeddedEventStore</code> will be auto-configured for you, if a concrete implementation of <code>EventStorageEngine</code> is available.
If JPA or JDBC is detected on the classpath, a <code>JpaEventStorageEngine</code> or <code>JdbcEventStorageEngine</code> will respectively be auto-configured as the <code>EventStorageEngine</code>.
In absence of either, the auto configuration falls back to the <code>SimpleEventBus</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="embedded-event-store"><a class="anchor" href="#embedded-event-store"></a>Embedded event store</h3>
<div class="paragraph">
<p>Alternatively, Axon provides a non-axon-server option, the <code>EmbeddedEventStore</code>.
It delegates the actual storage and retrieval of events to an <code>EventStorageEngine</code>.</p>
</div>
<div class="paragraph">
<p>There are multiple <code>EventStorageEngine</code> implementations available:</p>
</div>
<div class="sect3">
<h4 id="JpaEventStorageEngine"><a class="anchor" href="#JpaEventStorageEngine"></a><code>JpaEventStorageEngine</code></h4>
<div class="paragraph">
<p>The <code>JpaEventStorageEngine</code> stores events in a JPA-compatible data source.
The JPA event store stores events in entries.
These entries contain the serialized form of an event, as well as some fields where metadata is stored for fast lookup of these entries.
To use the <code>JpaEventStorageEngine</code>, you must have the JPA (<code>jakarta.persistence</code>) annotations on your classpath.
The old, javax JPA (<code>javax.persistence</code>) annotations are also still supported.
This will use an instance of the <code>JpaEventStorageEngine</code> using the <code>legacyjpa</code> namespace.</p>
</div>
<div class="paragraph">
<p>By default, the event store needs you to configure your persistence context (for example, as defined in the <code>META-INF/persistence.xml</code> file) to contain the classes <code>DomainEventEntry</code> and <code>SnapshotEventEntry</code> (both of these classes are located in the <code>org.axonframework.eventsourcing.eventstore.jpa</code> package).</p>
</div>
<div class="paragraph">
<p>Below is an example configuration of a persistence context configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;persistence xmlns="http://java.sun.com/xml/ns/persistence" version="1.0"&gt;
    &lt;persistence-unit name="eventStore" transaction-type="RESOURCE_LOCAL"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;class&gt;org.axonframework.eventsourcing.eventstore.jpa.DomainEventEntry&lt;/class&gt; <i class="conum" data-value="2"></i><b>(2)</b>
        &lt;class&gt;org.axonframework.eventsourcing.eventstore.jpa.SnapshotEventEntry&lt;/class&gt;
    &lt;/persistence-unit&gt;
&lt;/persistence&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In this example, there is a specific persistence unit for the event store.
You may, however, choose to add the third line to any other persistence unit configuration.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This line registers the <code>DomainEventEntry</code> (the class used by the <code>JpaEventStorageEngine</code>) with the persistence context.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Unique Key Constraint Consideration</div>
<div class="paragraph">
<p>Axon uses locking to prevent two threads from accessing the same aggregate.
However, if you have multiple JVMs using the same database, this won&#8217;t help you.
In that case, you&#8217;d have to rely on the database to detect conflicts.
Concurrent access to the event store will result in a Key Constraint Violation, as the table only allows a single event for a given aggregate and sequence number.
Therefore, inserting a second event for an existing aggregate with an existing sequence number will result in an error.</p>
</div>
<div class="paragraph">
<p>The <code>JpaEventStorageEngine</code> can detect this error and translate it to a <code>ConcurrencyException</code>.
However, each database system reports this violation differently.
If you register your <code>DataSource</code> with the <code>JpaEventStorageEngine</code>, it will try to detect the type of database and figure out which error codes represent a Key Constraint Violation.
Alternatively, you may provide a <code>PersistenceExceptionResolver</code> instance, which can tell if a given exception represents a key constraint violation.</p>
</div>
<div class="paragraph">
<p>If no <code>DataSource</code> or <code>PersistenceExceptionTranslator</code> is provided, exceptions from the database driver are thrown as-is.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, the <code>JpaEventStorageEngine</code> requires an <code>EntityManagerProvider</code> implementation that returns the <code>EntityManager</code> instance for the <code>EventStorageEngine</code> to use.
This also allows application managed persistence contexts to be used.
It is the <code>EntityManagerProvider&#8217;s responsibility to provide a correct instance of the `EntityManager</code>.</p>
</div>
<div class="paragraph">
<p>There are a few implementations of the <code>EntityManagerProvider</code> available, each for different needs.
The <code>SimpleEntityManagerProvider</code> simply returns the <code>EntityManager</code> instance which is given to it at construction time.
This makes the implementation a simple option for container managed contexts.
Alternatively, there is the <code>ContainerManagedEntityManagerProvider</code>, which returns the default persistence context, and is used by default by the JPA event store.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Move from javax.persistence to jakarta.persistence</div>
<div class="paragraph">
<p>Since version 4.6.0, we moved to using the jakarta namespace by default.
This means some classes like the <code>JpaTokenStore</code> are duplicated to accommodate for the <code>javax</code> to <code>jakarta</code> namespace change.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have a persistence unit called <code>"myPersistenceUnit"</code> which you wish to use in the <code>JpaEventStorageEngine</code>, the <code>EntityManagerProvider</code> implementation could look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyEntityManagerProvider implements EntityManagerProvider {

    private EntityManager entityManager;

    @Override
    public EntityManager getEntityManager() {
        return entityManager;
    }

    @PersistenceContext(unitName = "myPersistenceUnit")
    public void setEntityManager(EntityManager entityManager) {
        this.entityManager = entityManager;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the JPA event store stores entries in <code>DomainEventEntry</code> and <code>SnapshotEventEntry</code> entities.
While this will suffice in many cases, you might encounter a situation where the metadata provided by these entities is not enough.
It is also possible that you might want to store events for different aggregate types in different tables.</p>
</div>
<div class="paragraph">
<p>If that is the case, you can extend the <code>JpaEventStorageEngine</code>.
It contains a number of protected methods that you can override to tweak its behavior.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that persistence providers, such as Hibernate, use a first-level cache in their <code>EntityManager</code> implementation.
Typically, this means that all entities used or returned in queries are attached to the <code>EntityManager</code>.
They are only cleared when the surrounding transaction is committed or an explicit "clear" is performed inside the transaction.
This is especially the case when the queries are executed in the context of a transaction.</p>
</div>
<div class="paragraph">
<p>To work around this issue, make sure to exclusively query for non-entity objects.
You can use JPA&#8217;s <code>SELECT new SomeClass(parameters) FROM &#8230;&#8203;</code> style queries to work around this issue.
Alternatively, call <code>EntityManager.flush()</code> and <code>EntityManager.clear()</code> after fetching a batch of events.
Failure to do so might result in `OutOfMemoryException`s when loading large streams of events.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="_tabs_2" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_2_configuration_api" class="tab">
<p>Configuration API</p>
</li>
<li id="_tabs_2_spring_boot" class="tab">
<p>Spring Boot</p>
</li>
</ul>
</div>
<div id="_tabs_2_configuration_api--panel" class="tabpanel" aria-labelledby="_tabs_2_configuration_api">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AxonConfig {
    // omitting other configuration methods...
    public Configurer jpaEventStorageConfigurer(
            EntityManagerProvider entityManagerProvider,
            TransactionManager transactionManager
    ) {
        return DefaultConfigurer.jpaConfiguration(entityManagerProvider, transactionManager);
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_2_spring_boot--panel" class="tabpanel" aria-labelledby="_tabs_2_spring_boot">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class AxonConfig {
    // omitting other configuration methods...

    // The EmbeddedEventStore delegates actual storage and retrieval of events to an EventStorageEngine.
    @Bean
    public EventStore eventStore(
        EventStorageEngine storageEngine,
        GlobalMetricRegistry metricRegistry
    ) {
        return EmbeddedEventStore.builder()
                                 .storageEngine(storageEngine)
                                 .messageMonitor(metricRegistry.registerEventBus("eventStore"))
                                 .spanFactory(spanFactory)
                                 // ...
                                 .build();
    }

    // The JpaEventStorageEngine stores events in a JPA-compatible data source.
    @Bean
    public EventStorageEngine eventStorageEngine(
            Serializer serializer,
            PersistenceExceptionResolver persistenceExceptionResolver,
            @Qualifier("eventSerializer") Serializer eventSerializer,
            EntityManagerProvider entityManagerProvider,
            TransactionManager transactionManager
    ) {
         return JpaEventStorageEngine
             .builder()
             .snapshotSerializer(serializer)
             .persistenceExceptionResolver(persistenceExceptionResolver)
             .eventSerializer(eventSerializer)
             .entityManagerProvider(entityManagerProvider)
             .transactionManager(transactionManager)
             // ...
             .build();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="JdbcEventStorageEngine"><a class="anchor" href="#JdbcEventStorageEngine"></a><code>JdbcEventStorageEngine</code></h4>
<div class="paragraph">
<p>The JDBC event storage engine uses a JDBC Connection to store events in a JDBC compatible data storage.
Typically, these are relational databases.
Theoretically, anything that has a JDBC driver could be used to back the <code>JdbcEventStorageEngine</code>.</p>
</div>
<div class="paragraph">
<p>Similar to its JPA counterpart, the <code>JDBCEventStorageEngine</code> stores events in entries.
By default, each event is stored in a single entry, which corresponds with a row in a table.
The storage engine uses one table for events and another for snapshots.</p>
</div>
<div class="paragraph">
<p>The <code>JdbcEventStorageEngine</code> uses a <code>ConnectionProvider</code> to obtain connections.
Typically, the engine can obtain these connections directly from a <code>DataSource</code>.
However, Axon will bind these connections to a <code>UnitOfWork</code> to use a single connection within a unit of work.
This approach ensures that the framework uses a single transaction to store all events, even when multiple units of work are nested in the same thread.</p>
</div>
<div id="_tabs_3" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_3_configuration_api" class="tab">
<p>Configuration API</p>
</li>
<li id="_tabs_3_spring_boot" class="tab">
<p>Spring Boot</p>
</li>
</ul>
</div>
<div id="_tabs_3_configuration_api--panel" class="tabpanel" aria-labelledby="_tabs_3_configuration_api">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AxonConfig {
    // omitting other configuration methods...
    public void configureJdbcEventStorage(
            Configurer configurer,
            ConnectionProvider connectionProvider,
            EventTableFactory eventTableFactory
    ) {
        configurer.configureEmbeddedEventStore(config -&gt; {
            JdbcEventStorageEngine storageEngine = JdbcEventStorageEngine
                .builder()
                .snapshotSerializer(config.serializer())
                .connectionProvider(connectionProvider)
                .transactionManager(config.getComponent(TransactionManager.class))
                .eventSerializer(config.eventSerializer())
                // ...
                .build();
            // If the schema has not been constructed yet, the createSchema method can be used:
            storageEngine.createSchema(eventTableFactory);
            return storageEngine;
        });
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_3_spring_boot--panel" class="tabpanel" aria-labelledby="_tabs_3_spring_boot">
<div class="paragraph">
<p>By having JDBC on the classpath, Axon&#8217;s <code>JdbcAutoConfiguration</code> will automatically generate the <code>JdbcEventStorageEngine</code> for you.</p>
</div>
<div class="paragraph">
<p>All that might be left is the creation of the schema.
Axon can help you here with the <code>createSchema</code> operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class AxonConfig {
    // omitting other configuration methods...

    // The EmbeddedEventStore delegates actual storage and retrieval of events to an EventStorageEngine.
    @Bean
    public EventStore eventStore(
            EventStorageEngine storageEngine,
            GlobalMetricRegistry metricRegistry
    ) {
        return EmbeddedEventStore
            .builder()
            .storageEngine(storageEngine)
            .messageMonitor(metricRegistry.registerEventBus("eventStore"))
            .spanFactory(spanFactory)
            // ...
            .build();
    }

    // The JdbcEventStorageEngine stores events in a JDBC-compatible data source.
    @Bean
    public EventStorageEngine storageEngine(
            Serializer serializer,
            ConnectionProvider connectionProvider,
            @Qualifier("eventSerializer") Serializer eventSerializer,
            TransactionManager transactionManager,
            EventTableFactory tableFactory
    ) {
        JdbcEventStorageEngine storageEngine = JdbcEventStorageEngine
            .builder()
            .snapshotSerializer(serializer)
            .connectionProvider(connectionProvider)
            .eventSerializer(eventSerializer)
            .transactionManager(transactionManager)
            // ...
            .build();
        // If the schema has not been constructed yet, the createSchema method can be used:
        storageEngine.createSchema(tableFactory);
        return storageEngine;
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Data sources providers with Spring</div>
<div class="paragraph">
<p>We recommend that Spring users use the <code>SpringDataSourceConnectionProvider</code> to attach a connection from a <code>DataSource</code> to an existing transaction.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">SQL Statement Customizability</div>
<div class="paragraph">
<p>Databases have slight deviations from what&#8217;s the optimal SQL statement to perform in differing scenarios.
Since optimizing for all possibilities out there is beyond the framework&#8217;s scope, you can adjust the default statements used by the storage engine.</p>
</div>
<div class="paragraph">
<p>Check the <code>JdbcEventStorageEngineStatements</code> utility class for the default statements used by the <code>JdbcEventStorageEngine</code>.
Furthermore, the <code>org.axonframework.eventsourcing.eventstore.jdbc.statements</code> package contains the set of adjustable statements.
Each of these statement-builders can be customized through the <code>JdbcEventStorageEngine.Builder</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="MongoEventStorageEngine"><a class="anchor" href="#MongoEventStorageEngine"></a><code>MongoEventStorageEngine</code></h4>
<div class="paragraph">
<p><a href="https://www.mongodb.com/">MongoDB</a> is a document based NoSQL store.
Its scalability characteristics make it suitable for use as an event store.
Axon provides the <code>MongoEventStorageEngine</code>, which uses MongoDB as a backing database.
It is contained in the Axon Mongo module (Maven artifactId <code>axon-mongo</code>).</p>
</div>
<div class="paragraph">
<p>Events are stored in two separate collections: one for the event streams and one for snapshots.</p>
</div>
<div class="paragraph">
<p>By default, the <code>MongoEventStorageEngine</code> stores each event in a separate document.
It is, however, possible to change the <code>StorageStrategy</code> used.
The alternative provided by Axon is the <code>DocumentPerCommitStorageStrategy</code>, which creates a single document for all events that have been stored in a single commit (that is, in the same <code>DomainEventStream</code>).</p>
</div>
<div class="paragraph">
<p>The advantage of storing an entire commit in a single document is that commit is stored atomically.
Furthermore, it requires only a single roundtrip for any number of events.
The disadvantage is that it becomes harder to query events directly in the database.
For example, when refactoring the domain model it is harder to "transfer" events from one aggregate to another if they are included in a "commit document".</p>
</div>
<div class="paragraph">
<p>The <code>MongoEventStorageEngine</code> does not require a lot of configuration.
All it needs is a reference to the collections to store the events in, and you&#8217;re set to go.
For production environments, you may want to double check the indexes on your collections.
If you want transactions to be handled correctly, it&#8217;s important to set a <code>TransactionManager</code>.
Please note that there are several other optional configuration properties, like the serializers and an (optional) upcaster chain.</p>
</div>
<div id="_tabs_4" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_4_configuration_api" class="tab">
<p>Configuration API</p>
</li>
<li id="_tabs_4_spring_boot" class="tab">
<p>Spring Boot</p>
</li>
</ul>
</div>
<div id="_tabs_4_configuration_api--panel" class="tabpanel" aria-labelledby="_tabs_4_configuration_api">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AxonConfig {
    // omitting other configuration methods...
    public void configureMongoEventStorage(Configurer configurer, MongoTemplate mongoTemplate) {
        configurer.configureEmbeddedEventStore(config -&gt; MongoEventStorageEngine
            .builder()
            .mongoTemplate(mongoTemplate)
            // ...
            .build()
        );
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_4_spring_boot--panel" class="tabpanel" aria-labelledby="_tabs_4_spring_boot">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class AxonConfig {
    // omitting other configuration methods...

    // The EmbeddedEventStore delegates actual storage and retrieval of events to an EventStorageEngine.
    @Bean
    public EventStore eventStore(EventStorageEngine storageEngine,
                                 GlobalMetricRegistry metricRegistry) {
       return EmbeddedEventStore
           .builder()
           .storageEngine(storageEngine)
           .messageMonitor(metricRegistry.registerEventBus("eventStore"))
           .spanFactory(spanFactory)
           // ...
           .build();
    }

    // The MongoEventStorageEngine stores each event in a separate MongoDB document.
    @Bean
    public EventStorageEngine storageEngine(MongoClient client) {
        return MongoEventStorageEngine
            .builder()
            .mongoTemplate(DefaultMongoTemplate.builder()
                                               .mongoDatabase(client)
                                               .build())
            // ...
            .build();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_event_store_utilities"><a class="anchor" href="#_event_store_utilities"></a>Event store utilities</h3>
<div class="paragraph">
<p>Axon provides a number of Event Storage Engines that may be useful in certain circumstances.</p>
</div>
<div class="sect3">
<h4 id="_in_memory_event_storage"><a class="anchor" href="#_in_memory_event_storage"></a>In-Memory event storage</h4>
<div class="paragraph">
<p>The <code>InMemoryEventStorageEngine</code> keeps stored events in memory.
While it probably outperforms any other event store out there, it is not really meant for long-term production use.
However, it is useful in short-lived tools or tests that require an event store.</p>
</div>
<div id="_tabs_5" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_5_configuration_api" class="tab">
<p>Configuration API</p>
</li>
<li id="_tabs_5_spring_boot" class="tab">
<p>Spring Boot</p>
</li>
</ul>
</div>
<div id="_tabs_5_configuration_api--panel" class="tabpanel" aria-labelledby="_tabs_5_configuration_api">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class AxonConfig {
    // omitting other configuration methods...
    public void configureInMemoryEventStorage(Configurer configurer) {
        configurer.configureEmbeddedEventStore(config -&gt; new InMemoryEventStorageEngine());
    }
}</code></pre>
</div>
</div>
</div>
<div id="_tabs_5_spring_boot--panel" class="tabpanel" aria-labelledby="_tabs_5_spring_boot">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class AxonConfig {
    // omitting other configuration methods...

    // The EmbeddedEventStore delegates actual storage and retrieval of events to an EventStorageEngine.
    @Bean
    public EventStore eventStore(EventStorageEngine storageEngine,
                                 GlobalMetricRegistry metricRegistry) {
        return EmbeddedEventStore.builder()
                                 .storageEngine(storageEngine)
                                 .messageMonitor(metricRegistry.registerEventBus("eventStore"))
                                 .spanFactory(spanFactory)
                                 // ...
                                 .build();
    }

    // The InMemoryEventStorageEngine stores each event in memory.
    @Bean
    public EventStorageEngine storageEngine() {
        return new InMemoryEventStorageEngine();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_combining_multiple_event_stores_into_one"><a class="anchor" href="#_combining_multiple_event_stores_into_one"></a>Combining multiple event stores into one</h4>
<div class="paragraph">
<p>The <code>SequenceEventStorageEngine</code> is a wrapper around two other event storage engines.
When reading, it returns the events from both event storage engines.
Appended events are only appended to the second event storage engine.
This is useful in cases where two different implementations of event storage are used for performance reasons, for example.
The first would be a larger, but slower event store, while the second is optimized for quick reading and writing.</p>
</div>
</div>
<div class="sect3">
<h4 id="_filtering_stored_events"><a class="anchor" href="#_filtering_stored_events"></a>Filtering stored events</h4>
<div class="paragraph">
<p>The <code>FilteringEventStorageEngine</code> allows events to be filtered based on a predicate.
Only events that match the given predicate will be stored.
Note that event processors that use the event store as a source of events may not receive these events because they are not being stored.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_influencing_the_serialization_process"><a class="anchor" href="#_influencing_the_serialization_process"></a>Influencing the serialization process</h3>
<div class="paragraph">
<p>Event stores need a way to serialize the event to prepare it for storage.
By default, Axon uses the <code>XStreamSerializer</code>, which uses <a href="http://x-stream.github.io/">XStream</a> to serialize events into XML.
XStream is reasonably fast and is more flexible than Java Serialization.
Furthermore, the result of XStream serialization is human-readable.
This makes it quite useful for logging and debugging purposes.</p>
</div>
<div class="paragraph">
<p>The <code>XStreamSerializer</code> can be configured.
You can define aliases it should use for certain packages, classes or even fields.
Besides being a nice way to shorten potentially long names, aliases can also be used when class definitions of events change.
For more information about aliases, visit the <a href="http://x-stream.github.io/">XStream website</a>.</p>
</div>
<div class="paragraph">
<p>Alternatively, Axon also provides the <code>JacksonSerializer</code>, which uses <a href="https://github.com/FasterXML/jackson">Jackson</a> to serialize events into JSON.
While it produces a more compact serialized form, it does require that classes stick to the conventions (or configuration) required by Jackson.</p>
</div>
<div class="paragraph">
<p>You may also implement your own serializer, simply by creating a class that implements <code>Serializer</code>, and configuring the event store to use that implementation instead of the default.</p>
</div>
<div id="_tabs_6" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_6_configuration_api" class="tab">
<p>Configuration API</p>
</li>
<li id="_tabs_6_spring_boot" class="tab">
<p>Spring Boot</p>
</li>
</ul>
</div>
<div id="_tabs_6_configuration_api--panel" class="tabpanel" aria-labelledby="_tabs_6_configuration_api">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Returns a Configurer instance with default components configured.
// We explicitly set `JacksonSerializer` as desired event serializer.
Configurer configurer = DefaultConfigurer.defaultConfiguration()
      .configureEventSerializer(c -&gt; JacksonSerializer.builder().build());</code></pre>
</div>
</div>
</div>
<div id="_tabs_6_spring_boot--panel" class="tabpanel" aria-labelledby="_tabs_6_spring_boot">
<div class="paragraph">
<p>You can specify a serializer in your <code>application.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># somewhere in your `application.properties`

axon.serializer.events=jackson
# possible values: java, xstream, jackson</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can explicitly define your Serializer in the Spring context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// somewhere in your `@Configuration` class
@Qualifier("eventSerializer")
@Bean
public Serializer eventSerializer() {
    return JacksonSerializer.builder().build();
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_serializing_events_vs_the_others"><a class="anchor" href="#_serializing_events_vs_the_others"></a>Serializing events vs 'the others'</h4>
<div class="paragraph">
<p>It is possible to use a different serializer for the storage of events, than all other objects that Axon needs to serialize (such as commands, snapshots, sagas, etc).
While the <code>XStreamSerializer&#8217;s capability to serialize virtually anything makes it a  decent default, its output is not always a form that makes it nice to share with other applications. The `JacksonSerializer</code> creates much nicer output, but requires a certain structure in the objects to serialize.
This structure is typically present in events, making it a suitable event serializer.</p>
</div>
<div class="paragraph">
<p>If no explicit <code>eventSerializer</code> is configured, events are serialized using the main serializer that has been configured (which defaults to the <code>XStreamSerializer</code>).</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_distributing_events"><a class="anchor" href="#_distributing_events"></a>Distributing events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To distribute events between applications, it is important to know whether the applications belong to the same bounded context. If you don&#8217;t recognize this concept, we recommend reading the <a href="https://www.axoniq.io/concepts/domain-driven-design">Bounded Context</a> section first.
Applications within the same context "speak the same language." In other words, they communicate using the same set of messages and thus events.</p>
</div>
<div class="paragraph">
<p>As such, we can share the <code>EventStore&#8217;s</code> data source between these applications.
We may thus achieve distribution by utilizing the source itself.
You can use both the <a href="#embedded-event-store"><code>EmbeddedEventStore</code></a> and <a href="https://www.axoniq.io/products/axon-server" class="external" target="_blank" rel="noopener">Axon Server</a> for this.
The former would require the applications to point to the same data source, whereas the latter would require the applications to partake in the same context.</p>
</div>
<div class="paragraph">
<p>However, sharing the entire event API is not recommended whenever the applications do not belong to the same context.
Instead, we should protect the boundary of the contexts, except for some clearly defined cross-boundary messages.
Since accessing the same source isn&#8217;t an option, we require a different solution to share events.</p>
</div>
<div class="paragraph">
<p>To distribute events between bounded contexts, you can use Axon Server&#8217;s <a href="../../../../axon-server-reference/v2025.1/axon-server/administration/multi-context/" class="xref page">Multi-Context</a> solution, for example.
The multi-context support requires application registration to specific contexts.
Then, you can open a stream to another context through the <code>AxonServerEventStore#createStreamableMessageSourceForContext(String)</code> operation.
With this source in hand, you can configure a <a href="../event-processors/streaming/" class="xref page">Streaming Processor</a> to start reading from it.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can use a message broker to distribute events between contexts.
Axon provides a good bunch of these as extension modules, for example <a href="../../../../amqp-extension-reference/4.11/" class="xref page">Spring AMQP</a> or  <a href="../../../../kafka-extension-reference/4.11/" class="xref page">Kafka</a>.</p>
</div>
<div class="paragraph">
<p>Although this allows further event distribution, we still recommend consciously sharing <em>the correct</em> events.
Ideally, we add a form of context mapping, like an anti-corruption layer, between the contexts.
In other words, we recommend using a separate component that maps the events from the local context to a shared language right before distribution.</p>
</div>
<div class="paragraph">
<p>For example, this mapper would publish the messages on the AMQP queue or Kafka topic.
When it comes to Axon Server, we could, for example, use a distinct shared/global context to contain the shared language.</p>
</div>
</div>
</div>
        <nav class="pagination">
  <span class="prev"><a href="../event-processors/dead-letter-queue/">Dead-Letter Queue</a></span>
  <span class="next"><a href="../event-versioning/">Event Versioning</a></span>
</nav>
    </article>
  </div>
</main>
</div>
      <footer class="footer">
  <div class="primary-footer">
    <div class="footer-logo ">
      <a href="https://axoniq.io/">
        <img src="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png" alt="Logo AxonIQ" loading="lazy" srcset="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=45&amp;height=10&amp;name=Logo%20AxonIQ%20(2).png 45w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png 90w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=135&amp;height=30&amp;name=Logo%20AxonIQ%20(2).png 135w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=180&amp;height=40&amp;name=Logo%20AxonIQ%20(2).png 180w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=225&amp;height=50&amp;name=Logo%20AxonIQ%20(2).png 225w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=270&amp;height=60&amp;name=Logo%20AxonIQ%20(2).png 270w" sizes="(max-width: 90px) 100vw, 90px" width="90" height="20">
      </a>
    </div>

    <div class="footer-menu">
	    <h3>Products</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-framework">Axon Framework</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-server">Axon Server</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axoniq-console">AxonIQ Console</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/blog/protect-sensitive-data-in-an-event-sourced-application">AxonIQ Data Protection</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Sites</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="http://support.axoniq.io/">Customer Support Portal</a></li>
          <li><a class="ext" target="_blank" href="https://academy.axoniq.io/">AxonIQ Academy</a></li>
          <li><a class="ext" target="_blank" href="https://console.axoniq.io/">AxonIQ Console</a></li>
          <li><a class="ext" target="_blank" href="https://discuss.axoniq.io/">AxonIQ Discuss</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Follow us</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.youtube.com/axoniq">YouTube</a></li>
          <li><a class="ext" target="_blank" href="https://www.linkedin.com/company/axoniq">LinkedIn</a></li>
          <li><a class="ext" target="_blank" href="https://github.com/AxonIQ">GitHub</a></li>
          <li><a class="ext" target="_blank" href="https://axoniq.bsky.social/">Bluesky</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>&nbsp;</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.instagram.com/axoniq/">Instagram</a></li>
          <li><a class="ext" target="_blank" href="https://www.facebook.com/AxonIQ.io">Facebook</a></li>
          <li><a class="ext" target="_blank" href="https://twitter.com/axon_iq">Twitter</a></li>
          <li><a class="ext" target="_blank" href="https://medium.com/axoniq">Medium</a></li>
        </ul>
      </div>
    </div>

  </div>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../_/js/vendor/page-actions.js"></script>
<script async src="../../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab" data-sync-storage-scope="session"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
    </div>
  </body>
</html>
