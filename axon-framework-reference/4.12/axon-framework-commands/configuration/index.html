<!DOCTYPE html>
<html lang="en">
  <head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configuration</title>
    <link rel="canonical" href="https://docs.axoniq.io/axon-framework-reference/4.11/axon-framework-commands/configuration/">
    <link rel="prev" href="../infrastructure/">
    <link rel="next" href="../../events/">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/vendor/tabs.css">
    <link rel="icon" href="../../../../_/img/favicon.png" sizes="32x32">
    <link rel="apple-touch-icon" href="../../../../_/img/favicon.png"><!-- 180×180 -->
    <link rel="manifest" href="../../../../_/static/manifest.webmanifest">

        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QD58ZB');</script>
        <!-- End Google Tag Manager -->

    <script>var uiRootPath = '../../../../_'</script>


<link rel="icon" href="../../../../_/img/favicon.png" type="image/png">
  </head>
  <body class="article">
    <div class="header_container">
      
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QD58ZB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.axoniq.io">
        <img src="../../../../_/img/docs-logo.png" class="header_logo"/>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-center">
        <a class="navbar-item" href="../../../../home/basics/">Basics</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../../../home/guides/">Guides</a>
          <div class="navbar-dropdown card">
            <a class="navbar-item" href="../../../../home/guides/axon-framework">Axon Framework</a>
            <a class="navbar-item" href="../../../../home/guides/axon-server">Axon Server</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../../../home/reference/">Reference</a>
          <div class="navbar-dropdown card">
                <a class="navbar-item" href="../../../4.11/">Axon Framework</a>
                <a class="navbar-item" href="../../../../axon-framework-extensions/">Axon Framework Extensions</a>
                <a class="navbar-item" href="../../../../axon-server-reference/v2025.1/">Axon Server</a>
                <a class="navbar-item" href="../../../../synapse-reference/v0.12/">Axon Synapse</a>
                <a class="navbar-item" href="../../../../axoniq-console-reference/">AxonIQ Console</a>
          </div>
        </div>
      </div>
      <div class="navbar-end">
          <div class="navbar-item search hide-for-print">
            <div id="search-field" class="field">
              <input id="search-input" type="text" placeholder="Search AxonIQ Docs">
            </div>
          </div>
        <a class="navbar-item navbar-button" href="https://platform.axoniq.io" target="_blank">Axoniq Platform</a>
      </div>
    </div>
  </nav>
</header>
      <div class="toolbar card" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../home/" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../">Axon Framework Reference</a></li>
    <li><a href="../">Commands</a></li>
    <li><a href="./">Configuration</a></li>
  </ul>
</nav>
<div class="page-actions">
  <button class="actions-menu-toggle" title="Show actions related to this page">Actions</button>
  <div class="actions-menu toolbar_dropdown_menu card">
      <a class="action item" href="https://github.com/AxonFramework/AxonFramework/edit/axon-4.12.x/docs/old-reference-guide/modules/axon-framework-commands/pages/configuration.adoc">Edit this Page</a>
    
    <a class="action item" href="https://discuss.axoniq.io/search?q&#x3D;Configuration" target="discuss_search">View Discussions</a>
    <a class="action item" href="https://discuss.axoniq.io/new-topic?category&#x3D;library&amp;title&#x3D;%22Configuration%22%20Discussion&amp;body&#x3D;%3C!--%20Replace%20this%20comment%20with%20your%20comment%2Fsuggestion%2Fquestion%2F...%20--%3E%0A%0A%0A%3C!--%0AKeep%20the%20section%20below!%0ALinking%20back%20to%20the%20documentation%20URL%20not%20only%20helps%20people%20go%20to%20the%20page%0Abut%20also%20helps%20find%20relevant%20discussions%20from%20the%20documentation%20page%20via%20the%20%22View%20Discussion%22%20menu.%0A--%3E%0A%5Bdetails%3D%22Related%20library%20page%22%5D%0A%5BConfiguration%5D(https%3A%2F%2Fdocs.axoniq.io%2Faxon-framework-reference%2F4.12%2Faxon-framework-commands%2Fconfiguration%2F)%0A%5B%2Fdetails%5D%0A" target="discuss_add">Start new discussion</a>
  </div>
</div>


<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">4.12</button>
  <div class="version-menu toolbar_dropdown_menu card">
    <a class="version item is-current" href="./">4.12</a>
    <a class="version item" href="../../../4.11/axon-framework-commands/configuration/">4.11</a>
    <a class="version item" href="../../../4.10/axon-framework-commands/configuration/">4.10</a>
    <a class="version item is-missing" href="../../../0/">older releases</a>
  </div>
</div>
</div>
    </div>
    <div class="content_container">
      <div class="body">
<div class="nav-container" data-component="axon-framework-reference" data-version="4.12">
    <aside class="nav card">
      <div class="panels">
        <div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../">Axon Framework</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../upgrading-to-4-7/">Upgrading to Axon Framework 4.7</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../messaging-concepts/">Messaging Concepts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/anatomy-message/">Anatomy of a Message</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/message-correlation/">Message Correlation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/message-intercepting/">Message Intercepting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/supported-parameters-annotated-handlers/">Supported Parameters for Annotated Handlers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/exception-handling/">Exception Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/unit-of-work/">Unit of Work</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../messaging-concepts/timeouts/">Timeouts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../">Commands</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../command-handlers/">Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../command-dispatchers/">Dispatching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../modeling/aggregate/">Aggregates</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../modeling/multi-entity-aggregates/">Multi-Entity Aggregates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../modeling/state-stored-aggregates/">State Stored Aggregates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../modeling/aggregate-creation-from-another-aggregate/">Aggregate Creation from another Aggregate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../modeling/aggregate-polymorphism/">Aggregate Polymorphism</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../modeling/conflict-resolution/">Conflict Resolution</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../infrastructure/">Infrastructure</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="./">Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../events/">Events</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../events/event-handlers/">Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../events/event-dispatchers/">Dispatching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../events/event-processors/">Event Processors</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../events/event-processors/subscribing/">Subscribing Event Processor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../events/event-processors/streaming/">Streaming Event Processor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../events/event-processors/dead-letter-queue/">Dead-Letter Queue</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../events/infrastructure/">Infrastructure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../events/event-versioning/">Event Versioning</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../queries/">Queries</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/query-handlers/">Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/query-dispatchers/">Dispatching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/implementations/">Implementations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../queries/configuration/">Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../sagas/">Sagas</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../sagas/implementation/">Implementation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../sagas/associations/">Associations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../sagas/infrastructure/">Infrastructure</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../deadlines/">Deadlines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../deadlines/deadline-managers/">Deadline Managers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../deadlines/event-schedulers/">Event Schedulers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../testing/">Testing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../testing/commands-events/">Commands / Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../testing/sagas-1/">Sagas</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../serialization/">Serialization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../tuning/">Tuning</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../tuning/event-snapshots/">Event Snapshots</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../tuning/event-processing/">Event Processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../tuning/command-processing/">Command Processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../tuning/rdbms-tuning/">Relational Databases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../monitoring/">Monitoring</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../monitoring/tracing/">Distributed Tracing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../monitoring/metrics/">Metrics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../monitoring/health/">Health Indicators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../monitoring/processors/">Event Processor Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../monitoring/message-tracking/">Message Tracking</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../spring-boot-integration/">Spring Boot Integration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../modules/">Modules</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../release-notes/">Release Notes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../release-notes/major-releases/">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../release-notes/minor-releases/">Minor Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../known-issues-and-workarounds/">Known Issues and Workarounds</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
      </div>
    </aside>
</div>
<main class="article">
    <div class="page_content">
        <aside class="toc sidebar" data-title="Page content" data-levels="2">
  <div class="toc-menu"></div>
</aside>
          <article class="doc">
                <h1 class="page">Configuration</h1>
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This page describes how you can configure your Aggregate model.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aggregate_configuration"><a class="anchor" href="#_aggregate_configuration"></a>Aggregate configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Core concepts within the Command Model are the <a href="../modeling/aggregate/" class="xref page">Aggregates</a> that are implemented.
To instantiate a default Aggregate configuration, you do the following:</p>
</div>
<div id="_tabs_1" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_1_configuration_api" class="tab">
<p>Configuration API</p>
</li>
<li id="_tabs_1_spring_boot" class="tab">
<p>Spring Boot</p>
</li>
</ul>
</div>
<div id="_tabs_1_configuration_api--panel" class="tabpanel" aria-labelledby="_tabs_1_configuration_api">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Configurer configurer = DefaultConfigurer.defaultConfiguration()
       .configureAggregate(GiftCard.class);</code></pre>
</div>
</div>
</div>
<div id="_tabs_1_spring_boot--panel" class="tabpanel" aria-labelledby="_tabs_1_spring_boot">
<div class="paragraph">
<p>The <code>@Aggregate</code> annotation (in the <code>org.axonframework.spring.stereotype</code> package) triggers auto configuration to set up the necessary components to use the annotated type as an aggregate. Note that only the aggregate root needs to be annotated.</p>
</div>
<div class="paragraph">
<p>Axon will automatically register all the <code>@CommandHandler</code> annotated methods with the command bus and set up a repository if none is present.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// ...
import org.axonframework.spring.stereotype.Aggregate;
// ...
@Aggregate
public class GiftCard {
    @AggregateIdentifier
    private String id;

    @CommandHandler
    public GiftCard(IssueCardCommand cmd) {
       apply(new CardIssuedEvent(cmd.getCardId(), cmd.getAmount()));
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="registering-a-command-handler"><a class="anchor" href="#registering-a-command-handler"></a>Registering a command handler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Often the command handler functions are placed directly on the <a href="../modeling/aggregate/" class="xref page">aggregate</a>. When this approach is taken, simply registering the Aggregate as described above is sufficient for all its command handler methods to be registered too.</p>
</div>
<div class="paragraph">
<p><a href="../command-handlers/#external_command_handlers" class="xref page">External Command Handlers</a> however do require direct registration as being a command handler, which is shown in the following sample:</p>
</div>
<div id="_tabs_2" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_2_configuration_api" class="tab">
<p>Configuration API</p>
</li>
<li id="_tabs_2_spring_boot" class="tab">
<p>Spring Boot</p>
</li>
</ul>
</div>
<div id="_tabs_2_configuration_api--panel" class="tabpanel" aria-labelledby="_tabs_2_configuration_api">
<div class="paragraph">
<p>Given the existence of the following Command Handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class GiftCardCommandHandler {

    private final Repository&lt;GiftCard&gt; giftCardRepository;

    @CommandHandler
    public void handle(RedeemCardCommand cmd) {
        giftCardRepository.load(cmd.getCardId())
                          .execute(giftCard -&gt; giftCard.handle(cmd));
    }
    // omitted constructor
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following is needed to register a <code>GiftCardCommandHandler</code> as being a Command Handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Configurer axonConfigurer = DefaultConfigurer.defaultConfiguration()
    .registerCommandHandler(conf -&gt; new GiftCardCommandHandler());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, a more general approach to registering <em>all</em> types of message handlers in a component can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Configurer axonConfigurer = DefaultConfigurer.defaultConfiguration()
    .registerMessageHandler(conf -&gt; new GiftCardCommandHandler());</code></pre>
</div>
</div>
</div>
<div id="_tabs_2_spring_boot--panel" class="tabpanel" aria-labelledby="_tabs_2_spring_boot">
<div class="paragraph">
<p>When using Spring Boot, simply specifying the Command Handler as a bean is sufficient:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component
public class GiftCardCommandHandler {

    private final Repository&lt;GiftCard&gt; giftCardRepository;

    @CommandHandler
    public void handle(RedeemCardCommand cmd) {
        giftCardRepository.load(cmd.getCardId())
                          .execute(giftCard -&gt; giftCard.handle(cmd));
    }
    // omitted constructor
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<div class="title">Duplicate Command Handlers</div>
<p>As specified in the <a href="../../messaging-concepts/" class="xref page">Messaging Concepts</a> section, a command always has exactly one destination. That means there should only be a single Command Handler method for any given command.</p>
</div>
<div class="paragraph">
<p>By default, when a duplicate Command Handler method is registered, the last registration will be kept and a warning is logged. This behavior can be adjusted by specifying a different <code>DuplicateCommandHandlerResolver</code>, as is described in the <a href="../../tuning/" class="xref page">Runtime Tuning</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_command_model_repositories"><a class="anchor" href="#_command_model_repositories"></a>Command model repositories</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The repository is the mechanism that provides access to aggregates. The repository acts as a gateway to the actual storage mechanism used to persist the data. In CQRS, repositories only need to be able to find aggregates based on their unique identifier. Any other types of queries should be performed against the query database.</p>
</div>
<div class="paragraph">
<p>In Axon Framework, all repositories must implement the <code>Repository</code> interface. This interface prescribes three methods: <code>load(identifier, version)</code>, <code>load(identifier)</code> and <code>newInstance(factoryMethod)</code>. The <code>load</code> methods allows you to load aggregates from the repository. The optional <code>version</code> parameter is used to detect concurrent modifications (see <a href="../modeling/conflict-resolution/" class="xref page">Conflict resolution</a>). <code>newInstance</code> is used to register newly created aggregates in the repository.</p>
</div>
<div class="paragraph">
<p>Depending on your underlying persistence storage and auditing needs, there are a number of base implementations that provide basic functionality needed by most repositories. Axon Framework makes a distinction between repositories that save the current state of the aggregate (see <a href="#standard-repositories">Standard repositories</a>), and those that store the events of an aggregate (see <a href="#event-sourcing-repositories">Event Sourcing repositories</a>).</p>
</div>
<div class="paragraph">
<p>Note that the Repository interface does not prescribe a <code>delete(identifier)</code> method. Deleting aggregates is done by invoking the <code>AggregateLifecycle.markDeleted()</code> method from within an aggregate. Deleting an aggregate is a state migration like any other, with the only difference that it is irreversible in many cases. You should create your own meaningful method on your aggregate which sets the aggregate&#8217;s state to "deleted". This also allows you to register any events that you would like to have published.</p>
</div>
<div id="_tabs_3" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_3_configuration_api" class="tab">
<p>Configuration API</p>
</li>
<li id="_tabs_3_spring_boot" class="tab">
<p>Spring Boot</p>
</li>
</ul>
</div>
<div id="_tabs_3_configuration_api--panel" class="tabpanel" aria-labelledby="_tabs_3_configuration_api">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Configurer configurer = DefaultConfigurer.defaultConfiguration()
        .configureAggregate(
            AggregateConfigurer.defaultConfiguration(GiftCard.class)
                .configureRepository(c -&gt; EventSourcingRepository.builder(GiftCard.class)
                .eventStore(c.eventStore())
                .build())
        );</code></pre>
</div>
</div>
</div>
<div id="_tabs_3_spring_boot--panel" class="tabpanel" aria-labelledby="_tabs_3_spring_boot">
<div class="paragraph">
<p>To fully customize the repository used, you can define one in the application context. For Axon Framework to use this repository for the intended aggregate, define the bean name of the repository in the <code>repository</code> attribute on <code>@Aggregate</code> Annotation. Alternatively, specify the bean name of the repository to be the aggregate&#8217;s name, (first character lowercase), suffixed with <code>Repository</code>. So on a class of type <code>GiftCard</code>, the default repository name is <code>giftCardRepository</code>. If no bean with that name is found, Axon will define an <code>EventSourcingRepository</code> (which fails if no <code>EventStore</code> is available).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Bean
public Repository&lt;GiftCard&gt; repositoryForGiftCard(EventStore eventStore) {
    return EventSourcingRepository.builder(GiftCard.class).eventStore(eventStore).build();
}

@Aggregate(repository = "repositoryForGiftCard")
public class GiftCard { /*...*/ }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this requires full configuration of the Repository, including any <code>SnapshotTriggerDefinition</code> or <code>AggregateFactory</code> that may otherwise have been configured automatically.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="standard-repositories"><a class="anchor" href="#standard-repositories"></a>Standard repositories</h3>
<div class="paragraph">
<p>Standard repositories store the actual state of an aggregate. Upon each change, the new state will overwrite the old. This makes it possible for the query components of the application to use the same information the command component also uses. This could, depending on the type of application you are creating, be the simplest solution. If that is the case, Axon provides some building blocks that help you implement such a repository.</p>
</div>
<div class="paragraph">
<p>Axon provides one out-of-the-box implementation for a standard Repository: the <code>GenericJpaRepository</code>. It expects the Aggregate to be a valid JPA Entity. It is configured with an <code>EntityManagerProvider</code> which provides the <code>EntityManager</code> to manage the actual persistence, and a class specifying the actual type of aggregate stored in the repository. You also pass in the <code>EventBus</code> to which events are to be published when the aggregate invokes the static <code>AggregateLifecycle.apply()</code> method.</p>
</div>
<div class="paragraph">
<p>You can also easily implement your own repository. In that case, it is best to extend from the abstract <code>LockingRepository</code>. As aggregate wrapper type, it is recommended to use the <code>AnnotatedAggregate</code>. See the sources of <code>GenericJpaRepository</code> for an example.</p>
</div>
</div>
<div class="sect2">
<h3 id="event-sourcing-repositories"><a class="anchor" href="#event-sourcing-repositories"></a>Event Sourcing repositories</h3>
<div class="paragraph">
<p>Aggregate roots that are able to reconstruct their state based on events may also be configured to be loaded by an event sourcing repository.
Those repositories do not store the aggregate itself, but the series of events generated by the aggregate.
Based on these events, the state of an aggregate can be restored at any time.</p>
</div>
<div class="paragraph">
<p>The <code>EventSourcingRepository</code> implementation provides the basic functionality needed by any event sourcing repository in the Axon Framework.
It depends on an <code>EventStore</code> (see <a href="../../events/infrastructure/" class="xref page">Event store implementations</a>), which abstracts the actual storage mechanism for the events.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aggregate_factories"><a class="anchor" href="#_aggregate_factories"></a>Aggregate factories</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>AggregateFactory</code> specifies how an aggregate instance is created based on a given <em>event stream.</em></p>
</div>
<div class="paragraph">
<p>This makes the <code>AggregateFactory</code> a configurable component for the <code>EventSourcingRepository</code> <em>only</em>.
Furthermore, it is only invoked for existing aggregate event streams, as an event stream is required.
Hence, the command constructing the aggregate will not trigger an <code>AggregateFactory</code> invocation.</p>
</div>
<div class="paragraph">
<p>Axon Framework comes with two <code>AggregateFactory</code> implementations that you may use.
If they do not suffice, it is really easy to create your own implementation.</p>
</div>
<div class="sect2">
<h3 id="_genericaggregatefactory"><a class="anchor" href="#_genericaggregatefactory"></a><code>GenericAggregateFactory</code></h3>
<div class="paragraph">
<p>The <code>GenericAggregateFactory</code> is a special <code>AggregateFactory</code> implementation that can be used for any type of event sourced aggregate root.
The <code>GenericAggregateFactory</code> creates an instance of the aggregate type the repository manages.
The aggregate class must be non-abstract and declare a default no-arg constructor that does no initialization at all.</p>
</div>
<div class="paragraph">
<p>The <code>GenericAggregateFactory</code> is suitable for most scenarios where aggregates do not need special injection of non-serializable resources.</p>
</div>
</div>
<div class="sect2">
<h3 id="_springprototypeaggregatefactory"><a class="anchor" href="#_springprototypeaggregatefactory"></a><code>SpringPrototypeAggregateFactory</code></h3>
<div class="paragraph">
<p>Depending on your architectural choices, it might be useful to inject dependencies into your aggregates using Spring.
You could, for example, inject query repositories into your aggregate to ensure the existence (or nonexistence) of certain values.</p>
</div>
<div class="paragraph">
<p>To inject dependencies into your aggregates, you need to configure a prototype bean of your aggregate root in the Spring context that also defines the <code>SpringPrototypeAggregateFactory</code>.
Instead of creating regular instances of using a constructor, it uses the Spring Application Context to instantiate your aggregates.
This will also inject any dependencies in your aggregate.</p>
</div>
<div class="paragraph">
<p>Note that although you can inject dependencies as global fields of an aggregate, you can also inject them as parameters.
When it comes to parameters added to message handling methods, Axon uses the so-called <a href="../../messaging-concepts/supported-parameters-annotated-handlers/" class="xref page">Parameter Resolver</a> support to inject your beans.
As such, the <code>SpringPrototypeAggregateFactory</code> <em>does not</em> play any role to inject dependencies to message handling methods.</p>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_your_own_aggregatefactory"><a class="anchor" href="#_implementing_your_own_aggregatefactory"></a>Implementing your own <code>AggregateFactory</code></h3>
<div class="paragraph">
<p>In some cases, the <code>GenericAggregateFactory</code> just doesn&#8217;t deliver what you need.
For example, you could have an abstract aggregate type with multiple implementations for different scenarios (for example, <code>PublicUserAccount</code> and <code>BackOfficeAccount</code> both extending an <code>Account</code>).
Instead of creating different repositories for each of the aggregates, you could use a single repository, and configure an AggregateFactory that is aware of the different implementations.</p>
</div>
<div class="paragraph">
<p>The bulk of the work the aggregate factory does is creating uninitialized aggregate instances.
It must do so using a given aggregate identifier and the first event from the stream.
Usually, this event is a creation event which contains hints about the expected type of aggregate.
You can use this information to choose an implementation and invoke its constructor.
Make sure no events are applied by that constructor; the aggregate must be uninitialized.</p>
</div>
<div class="paragraph">
<p>Initializing aggregates based on the events can be a time-consuming effort, compared to the direct aggregate loading of the simple repository implementations.
The <code>CachingEventSourcingRepository</code> provides a cache from which aggregates can be loaded if available.</p>
</div>
</div>
</div>
</div>
        <nav class="pagination">
  <span class="prev"><a href="../infrastructure/">Infrastructure</a></span>
  <span class="next"><a href="../../events/">Events</a></span>
</nav>
    </article>
  </div>
</main>
</div>
      <footer class="footer">
  <div class="secondary-footer">
    <p>Copyright © 2025 AxonIQ BV. All Rights Reserved</p>
  </div>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../_/js/vendor/page-actions.js"></script>
<script async src="../../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab" data-sync-storage-scope="session"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
    </div>
  </body>
</html>
