<!DOCTYPE html>
<html lang="en">
  <head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Receiving Commands</title>
    <link rel="canonical" href="https://docs.axoniq.io/synapse-reference/v0.11/receiving-commands/">
    <link rel="prev" href="../receiving-messages/">
    <link rel="next" href="../receiving-queries/">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/vendor/tabs.css">
    <link rel="icon" href="../../../_/img/favicon.ico" sizes="32x32">
    <link rel="icon" href="../../../_/img/icon.svg" type="image/svg+xml" media="(prefers-color-scheme: light)">
    <link rel="icon" href="../../../_/img/icon-light.svg" type="image/svg+xml" media="(prefers-color-scheme: dark)">
    <link rel="apple-touch-icon" href="../../../_/img/apple-touch-icon.png"><!-- 180Ã—180 -->
    <link rel="manifest" href="../../../_/static/manifest.webmanifest">
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QD58ZB');</script>
        <!-- End Google Tag Manager -->

    <script>var uiRootPath = '../../../_'</script>


  </head>
  <body class="article">
    <div class="banner">
    <a href="https://console.axoniq.io">Gain deep insights into Axon Framework applications with AxonIQ console. <span class="banner_button">Start now</span></a>
</div>    
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QD58ZB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.axoniq.io"><img src="../../../_/img/logo-dark4x.png" class="header_logo" /></a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="../../../home/basics/">Basics</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../../home/guides/">Guides</a>
          <div class="navbar-dropdown card">
            <a class="navbar-item" href="../../../home/guides/axon-framework">Axon Framework</a>
            <a class="navbar-item" href="../../../home/guides/axon-server">Axon Server</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../../home/reference/">Reference</a>
          <div class="navbar-dropdown card">
                <a class="navbar-item" href="../../../axon-framework-reference/4.11/">Axon Framework</a>
                <a class="navbar-item" href="../../../axon-framework-extensions/">Axon Framework Extensions</a>
                <a class="navbar-item" href="../../../axon-server-reference/v2024.2/">Axon Server</a>
                <a class="navbar-item" href="../../v0.11/">Axon Synapse</a>
                <a class="navbar-item" href="../../../axoniq-console-reference/">AxonIQ Console</a>
          </div>
        </div>
      </div>
      <div class="navbar-end">
        <div class="navbar-item search hide-for-print">
          <div id="search-field" class="field">
            <input id="search-input" type="text" placeholder="Search AxonIQ Docs">
          </div>
        </div>
        <a class="navbar-item navbar-button" href="https://academy.axoniq.io" target="_blank">AxonIQ Academy</a>
        <a class="navbar-item navbar-button" href="https://discuss.axoniq.io" target="_blank">AxonIQ Discuss</a>
        <a class="navbar-item navbar-button" href="https://console.axoniq.io" target="_blank">AxonIQ Console</a>
      </div>
    </div>
  </nav>
</header>
    <div class="toolbar card" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../home/" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../">Axon Synapse Reference</a></li>
    <li><a href="../receiving-messages/">Receiving Messages</a></li>
    <li><a href="./">Receiving Commands</a></li>
  </ul>
</nav>
<div class="page-actions">
  <button class="actions-menu-toggle" title="Show actions related to this page">Actions</button>
  <div class="actions-menu toolbar_dropdown_menu card">

    <a class="action item" href="https://discuss.axoniq.io/search?q&#x3D;Receiving%20Commands" target="discuss_search">View Discussions</a>
    <a class="action item" href="https://discuss.axoniq.io/new-topic?category&#x3D;library&amp;title&#x3D;%22Receiving%20Commands%22%20Discussion&amp;body&#x3D;%3C!--%20Replace%20this%20comment%20with%20your%20comment%2Fsuggestion%2Fquestion%2F...%20--%3E%0A%0A%0A%3C!--%0AKeep%20the%20section%20below!%0ALinking%20back%20to%20the%20documentation%20URL%20not%20only%20helps%20people%20go%20to%20the%20page%0Abut%20also%20helps%20find%20relevant%20discussions%20from%20the%20documentation%20page%20via%20the%20%22View%20Discussion%22%20menu.%0A--%3E%0A%5Bdetails%3D%22Related%20library%20page%22%5D%0A%5BReceiving%20Commands%5D(https%3A%2F%2Fdocs.axoniq.io%2Fsynapse-reference%2Fv0.9%2Freceiving-commands%2F)%0A%5B%2Fdetails%5D%0A" target="discuss_add">Start new discussion</a>
  </div>
</div>


<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">v0.9</button>
  <div class="version-menu toolbar_dropdown_menu card">
    <a class="version item" href="../../v0.12/receiving-commands/">v0.12</a>
    <a class="version item" href="../../v0.11/receiving-commands/">v0.11</a>
    <a class="version item" href="../../v0.10/receiving-commands/">v0.10</a>
    <a class="version item is-current" href="./">v0.9</a>
    <a class="version item" href="../../v0.8/receiving-commands/">v0.8</a>
    <a class="version item" href="../../v0.7/receiving-commands/">v0.7</a>
    <a class="version item" href="../../v0.6/receiving-commands/">v0.6</a>
  </div>
</div>
</div>
    <div class="content_container">
      <div class="body">
<div class="nav-container" data-component="synapse-reference" data-version="v0.9">
    <aside class="nav card">
      <div class="panels">
        <div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../">Axon Synapse</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../overview/">High-Level Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installation/">Installation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../configuration/">Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../access-control/">Access Control</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../sending-messages/">Sending Messages</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sending-commands/">Sending Commands</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sending-queries/">Sending Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sending-events/">Sending Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../receiving-messages/">Receiving Messages</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="./">Receiving Commands</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../receiving-queries/">Receiving Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../receiving-events/">Receiving Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../aggregates/">Aggregates</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../multi-context/">Multi-Context</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../storage/">Storage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ha/">High Availability</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ha/ha-config/">HA Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release-notes/">Release Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../openapi/">Open API Documentation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openapi/synapse/">Axon Synapse API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openapi/client-message/">Client Message API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openapi/client-raw/">Client Raw API</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
      </div>
    </aside>
</div>
<main class="article">
    <div class="page_content">
        <aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
          <article class="doc">
            <h1 class="page">Receiving Commands</h1>
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Any service available at an accessible URL can be a command handler. Synapse can send commands to such services via HTTP requests. The service must be able to handle requests containing commands. A command handler may return a response message or send a status without a body.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_endpoint_types"><a class="anchor" href="#_endpoint_types"></a>Endpoint types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Axon Synapse can send HTTP requests containing commands in two different ways. Each endpoint that registers as a command handler must support one of them.</p>
</div>
<div class="sect2">
<h3 id="_http_raw"><a class="anchor" href="#_http_raw"></a><code>http-raw</code></h3>
<div class="paragraph">
<p>Axon Synapse serializes a single command directly into the HTTP request&#8217;s body when interacting with <code>http-raw</code> endpoints. It provides all other relevant information in the HTTP headers of the request:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Content-Type</code></p>
</li>
<li>
<p><code>AxonIQ-MessageId</code></p>
</li>
<li>
<p><code>AxonIQ-CommandName</code></p>
</li>
<li>
<p><code>AxonIQ-PayloadType</code></p>
</li>
<li>
<p><code>AxonIQ-Priority</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please refer to the <a href="../openapi/client-raw/#operation/handleCommand" class="xref page">API documentation</a> for detailed information about the HTTP request structure.</p>
</div>
</div>
<div class="sect2">
<h3 id="_http_message"><a class="anchor" href="#_http_message"></a><code>http-message</code></h3>
<div class="paragraph">
<p>When interacting with <code>http-message</code> endpoints, Axon Synapse generates a JSON message that contains the serialized command and all information related to the command. It then sends that JSON message in the HTTP request&#8217;s body.</p>
</div>
<div class="paragraph">
<p>Please refer to the <a href="../openapi/client-message/#operation/handleCommandMessage" class="xref page">API documentation</a> for detailed information about the HTTP request structure.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_registering_command_handlers"><a class="anchor" href="#_registering_command_handlers"></a>Registering command handlers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Command handlers must explicitly register in Axon Synapse to receive commands from Axon Server. There are two ways to register a command handler -
using Synapse&#8217;s Web interface or through the Synapse HTTP API.</p>
</div>
<div class="paragraph">
<p>In both cases, Axon Synapse needs the following information:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Command names</dt>
<dd>
<p>a list of names for the commands that this handler can handle</p>
</dd>
<dt class="hdlist1">Client ID</dt>
<dd>
<p>unique id for the handler application instance</p>
</dd>
<dt class="hdlist1">Component name</dt>
<dd>
<p>a logical name for the handler application</p>
</dd>
<dt class="hdlist1">HTTP Endpoint</dt>
<dd>
<p>the URL of the handler</p>
</dd>
<dt class="hdlist1">Endpoint Type</dt>
<dd>
<p>specifies whether the handler expects a raw or message request type</p>
</dd>
<dt class="hdlist1">Endpoint Options</dt>
<dd>
<p>any key/value pairs that Axon Synapse should include in requests to the handler (as HTTP headers)</p>
</dd>
<dt class="hdlist1">Load Factor</dt>
<dd>
<p>relative weight for this handler, if there are multiple handlers for a command, handlers with a higher load factor get a higher percentage of the requests.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For a full list of parameters, including optional ones, please refer to the <a href="../openapi/synapse/#tag/command-handlers/operation/registerCommandHandler" class="xref page">API documentation</a>.</p>
</div>
<div class="sect2">
<h3 id="_registering_a_command_handler_via_axon_synapse_ui"><a class="anchor" href="#_registering_a_command_handler_via_axon_synapse_ui"></a>Registering a command handler via Axon Synapse UI</h3>
<div class="paragraph">
<p>To register a command handler via Axon Synapse UI, go to <span class="menuseq"><b class="menu">Command Handlers</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Register new command handler</b></span> and fill in the form:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/register_command_handler.png" alt="Screenshot of the Axon Synapse UI for registering a new command handler">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_registering_a_command_handler_via_axon_synapse_api"><a class="anchor" href="#_registering_a_command_handler_via_axon_synapse_api"></a>Registering a command handler via Axon Synapse API</h3>
<div class="paragraph">
<p>To register a command handler via Axon Synapse API, send a JSON request to the respective endpoint.
You can find detailed information about the endpoint in the <a href="../openapi/synapse/#tag/command-handlers/operation/registerCommandHandler" class="xref page">API documentation</a>.</p>
</div>
<div class="paragraph">
<p>Below is a sample JSON request to register a handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-http hljs" data-lang="http">POST http://synapse:8080/v1/contexts/default/handlers/commands
Content-Type: application/json

{
  "names": [
    "local.application.client.Command"
  ],
  "endpoint": "https://client.application.local/v1/message",
  "endpointType": "http-raw",
  "endpointOptions": [
    {
      "key": "string",
      "value": "string"
    }
  ],
  "clientId": "application-name-7c78946494-p86ts",
  "componentName": "application-name",
  "loadFactor": 100,
  "concurrency": 1,
  "enabled": true
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_concurrency_control"><a class="anchor" href="#_concurrency_control"></a>Concurrency control</h3>
<div class="paragraph">
<p>For a given command handler, synapse allows you to specify the maximum amount of concurrent requests, Synapse calls your application with.
You can achieve this by setting the <code>maxConcurrency</code> parameter for a given registration.</p>
</div>
<div class="paragraph">
<p>Synapse does however never send you two concurrent requests for the same routing key.
This allows you not to keep track of ordering of concurrent requests.
However, this also might lead to lower rates of concurrent processing than specified in the <code>maxConcurrency</code> parameter.
The decision-making whether Synapse may send a request concurrently, works in the following order:
1. ensure there are less than <code>maxConcurrency</code> requests already ongoing.
2. ensure there is no other request running for the current <code>routingKey</code>.</p>
</div>
<div class="paragraph">
<p>While this may allow a lot of requests for the same routingKey block processing for commands of a different routing key that arrive later and Synapse could forward it,
this approach the safest and most defensive one.</p>
</div>
<div class="paragraph">
<p>Note that the <code>maxConcurrency</code> parameter refers to the <strong>maximum</strong>  amount of concurrent requests.
Depending on your routing key, your application might observe a lower amount of concurrency (see section above).</p>
</div>
</div>
</div>
</div>
        <nav class="pagination">
  <span class="prev"><a href="../receiving-messages/">Receiving Messages</a></span>
  <span class="next"><a href="../receiving-queries/">Receiving Queries</a></span>
</nav>
    </article>
  </div>
</main>
</div>
      <footer class="footer">
  <div class="primary-footer">
    <div class="footer-logo ">
      <a href="https://axoniq.io/">
        <img src="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png" alt="Logo AxonIQ" loading="lazy" srcset="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=45&amp;height=10&amp;name=Logo%20AxonIQ%20(2).png 45w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png 90w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=135&amp;height=30&amp;name=Logo%20AxonIQ%20(2).png 135w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=180&amp;height=40&amp;name=Logo%20AxonIQ%20(2).png 180w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=225&amp;height=50&amp;name=Logo%20AxonIQ%20(2).png 225w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=270&amp;height=60&amp;name=Logo%20AxonIQ%20(2).png 270w" sizes="(max-width: 90px) 100vw, 90px" width="90" height="20">
      </a>
    </div>

    <div class="footer-menu">
	    <h3>Products</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-framework">Axon Framework</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-server">Axon Server</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axoniq-cloud">AxonIQ Cloud</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axoniq-console">AxonIQ Console</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-synapse">Axon Synapse</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/blog/protect-sensitive-data-in-an-event-sourced-application">AxonIQ Data Protection</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Sites</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="http://support.axoniq.io/">Customer Support Portal</a></li>
          <li><a class="ext" target="_blank" href="https://academy.axoniq.io/">AxonIQ Academy</a></li>
          <li><a class="ext" target="_blank" href="https://console.axoniq.io/">AxonIQ Console</a></li>
          <li><a class="ext" target="_blank" href="https://discuss.axoniq.io/">AxonIQ Discuss</a></li>
          <li><a class="ext" target="_blank" href="https://console.cloud.axoniq.io">AxonIQ Cloud</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Follow us</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.youtube.com/axoniq">YouTube</a></li>
          <li><a class="ext" target="_blank" href="https://www.linkedin.com/company/axoniq">LinkedIn</a></li>
          <li><a class="ext" target="_blank" href="https://github.com/AxonIQ">GitHub</a></li>
          <li><a class="ext" target="_blank" href="https://axoniq.bsky.social/">Bluesky</a></li>
          <li><a class="ext" target="_blank" href="https://www.instagram.com/axoniq/">Instagram</a></li>
          <li><a class="ext" target="_blank" href="https://www.facebook.com/AxonIQ.io">Facebook</a></li>
          <li><a class="ext" target="_blank" href="https://twitter.com/axon_iq">Twitter</a></li>
          <li><a class="ext" target="_blank" href="https://medium.com/axoniq">Medium</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script async src="../../../_/js/vendor/page-actions.js"></script>
<script async src="../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab" data-sync-storage-scope="session"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
    </div>
  </body>
</html>
