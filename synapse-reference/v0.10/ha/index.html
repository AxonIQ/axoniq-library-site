<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>High Availability</title>
    <link rel="canonical" href="https://docs.axoniq.io/synapse-reference/latest/ha/">
    <link rel="prev" href="../storage/">
    <link rel="next" href="ha-config/">
    <meta name="generator" content="Antora 3.1.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/vendor/tabs.css">
    <link rel="icon" href="../../../_/img/favicon.ico" sizes="32x32">
    <link rel="icon" href="../../../_/img/icon.svg" type="image/svg+xml" media="(prefers-color-scheme: light)">
    <link rel="icon" href="../../../_/img/icon-light.svg" type="image/svg+xml" media="(prefers-color-scheme: dark)">
    <link rel="apple-touch-icon" href="../../../_/img/apple-touch-icon.png"><!-- 180Ã—180 -->
    <link rel="manifest" href="../../../_/static/manifest.webmanifest">
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QD58ZB');</script>
        <!-- End Google Tag Manager -->

    <script>var uiRootPath = '../../../_'</script>


  </head>
  <body class="article">

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QD58ZB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.axoniq.io"><img src="../../../_/img/logo-dark4x.png" class="header_logo" /></a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="../../../home/basics/">Basics</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Guides</a>
          <div class="navbar-dropdown card">
              <a class="navbar-item" href="../../../home/guides/axon-framework/">Axon Framework</a>
              <a class="navbar-item" href="../../../home/guides/axon-server/">Axon Server</a>
              <a class="navbar-item" href="../../../home/guides/migration/">Migration</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Reference</a>
          <div class="navbar-dropdown card">
                <a class="navbar-item" href="../../../axon-framework-reference/latest/">Axon Framework</a>
                <a class="navbar-item" href="../../../axon-framework-extensions/">Axon Framework Extensions</a>
                <a class="navbar-item" href="../../../axon-server-reference/latest/">Axon Server</a>
                <a class="navbar-item" href="../../../synapse_ref/latest/">Axon Synapse</a>
                <a class="navbar-item" href="../../latest/">Axon Synapse</a>
                <a class="navbar-item" href="../../../axoniq-console-reference/latest/">AxonIQ Console</a>
          </div>
        </div>
      </div>
      <div class="navbar-end">
        <div class="navbar-item search hide-for-print">
          <div id="search-field" class="field">
            <input id="search-input" type="text" placeholder="Search AxonIQ Docs">
          </div>
        </div>
        <a class="navbar-item navbar-button" href="https://academy.axoniq.io" target="_blank">AxonIQ Academy</a>
        <a class="navbar-item navbar-button" href="https://discuss.axoniq.io" target="_blank">AxonIQ Discuss</a>
        <a class="navbar-item navbar-button" href="https://console.axoniq.io" target="_blank">AxonIQ Console</a>
      </div>
    </div>
  </nav>
</header>
<div class="toolbar card" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../home/" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../">Axon Synapse Reference</a></li>
    <li><a href="./">High Availability</a></li>
  </ul>
</nav>
<div class="page-actions">
  <button class="actions-menu-toggle" title="Show actions related to this page">Actions</button>
  <div class="actions-menu toolbar_dropdown_menu card">

    <a class="action item" href="https://discuss.axoniq.io/search?q&#x3D;https%3A%2F%2Fdocs.axoniq.io%2Fsynapse-reference%2Fv0.10%2Fha%2F%20%23library" target="discuss_search">View Discussions</a>
    <a class="action item" href="https://discuss.axoniq.io/new-topic?category&#x3D;library&amp;title&#x3D;%22High%20Availability%22%20library%20page%20...&amp;body&#x3D;%3C!--%20Replace%20this%20comment%20with%20your%20comment%2Fsuggestion%2Fquestion%2F...%20--%3E%0A%0A%0A%3C!--%0AKeep%20the%20section%20below!%0ALinking%20back%20to%20the%20documentation%20URL%20not%20only%20helps%20people%20go%20to%20the%20page%0Abut%20also%20helps%20find%20relevant%20discussions%20from%20the%20documentation%20page%20via%20the%20%22View%20Discussion%22%20menu.%0A--%3E%0A%5Bdetails%3D%22Related%20library%20page%22%5D%0A%5BHigh%20Availability%5D(https%3A%2F%2Fdocs.axoniq.io%2Fsynapse-reference%2Fv0.10%2Fha%2F)%0A%5B%2Fdetails%5D%0A" target="discuss_add">Start new discussion</a>
  </div>
</div>


<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">v0.10</button>
  <div class="version-menu toolbar_dropdown_menu card">
    <a class="version item" href="../../latest/ha/">v0.11</a>
    <a class="version item is-current" href="./">v0.10</a>
    <a class="version item" href="../../v0.9/ha/">v0.9</a>
    <a class="version item" href="../../v0.8/ha/">v0.8</a>
    <a class="version item" href="../../v0.7/ha/">v0.7</a>
  </div>
</div>
</div>
<div class="body">
<div class="nav-container" data-component="synapse-reference" data-version="v0.10">
  <aside class="nav card">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../">Axon Synapse</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../overview/">High-Level Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installation/">Installation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../configuration/">Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../access-control/">Access Control</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../sending-messages/">Sending Messages</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sending-commands/">Sending Commands</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sending-queries/">Sending Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sending-events/">Sending Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../receiving-messages/">Receiving Messages</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../receiving-commands/">Receiving Commands</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../receiving-queries/">Receiving Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../receiving-events/">Receiving Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../aggregates/">Aggregates</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../multi-context/">Multi-Context</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../storage/">Storage</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="./">High Availability</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ha-config/">HA Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release-notes/">Release Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../openapi/">Open API Documentation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openapi/synapse/">Axon Synapse API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openapi/client-message/">Client Message API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openapi/client-raw/">Client Raw API</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
    <div class="content">
        <aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
          <article class="doc">
            <h1 class="page">High Availability</h1>
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Synapse does support high availability (HA).</p>
</div>
<div class="paragraph">
<p>This page explains how the HA features in Synapse work.
To see how to configure them, refer to <a href="ha-config/" class="xref page">HA Configuration</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For using HA, you need to have selected AxonServer as a means of storing your Synapse configuration. Refer to <a href="../storage/" class="xref page">Storage</a> on how to do this.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Whilst it&#8217;s possible to simply run multiple independent Synapse instances without shared configuration, this is highly discouraged and generally regarded as a bad idea.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_ha_in_synapse_covers"><a class="anchor" href="#_what_ha_in_synapse_covers"></a>What HA in synapse covers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using HA in Synapse does provide you with the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tolerate individual Synapse instances to go down for maintenance or crash</p>
</li>
<li>
<p>Provide a way for the different handler types to balance themselves and be re-assigned when a Synapse instance goes down.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Synapse handles the different handler types in different ways:</p>
</div>
<div class="sect2">
<h3 id="_command_handlers"><a class="anchor" href="#_command_handlers"></a>Command handlers</h3>
<div class="paragraph">
<p>Each Synapse instance registers all configured command handlers with AxonServer. AxonServer then makes sure to send the commands to the correct handler instance via the Synapse instance used to register the handler.</p>
</div>
</div>
<div class="sect2">
<h3 id="_event_handlers"><a class="anchor" href="#_event_handlers"></a>Event handlers</h3>
<div class="paragraph">
<p>To prevent duplication of events as far as possible, Synapse instances cooperate to register event handlers only from one Synapse instance. This allows your client application to receive events from only one Synapse instance, as long as the topology doesn&#8217;t change.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When changing synapse instances, you may see slight duplication of events delivered. This is normal and unavoidable.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When topology changes (for example when a Synapse instance crashes or a new one appears), handlers are re-assigned to available Synapse instances according to a consistent hashing algorithm. This makes sure that if a Synapse instance goes down, other instances pick up the now unassigned event handlers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_handlers"><a class="anchor" href="#_query_handlers"></a>Query handlers</h3>
<div class="paragraph">
<p>As with Command Handlers, each Synapse instance registers all configured query handlers with AxonServer. Again, AxonServer then makes sure to send the queries to the correct client application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_infrastructure"><a class="anchor" href="#_infrastructure"></a>Infrastructure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To be fully high-available, it&#8217;s not enough to have Synapse set to HA. One should take the following aspects into consideration.</p>
</div>
<div class="sect2">
<h3 id="_axon_server"><a class="anchor" href="#_axon_server"></a>Axon server</h3>
<div class="paragraph">
<p>Synapse instances (and other client applications directly connecting to AxonServer, like AxonFramework applications) should have the addresses of all primary AxonServer nodes in the cluster configured. This allows them to reconnect if an AxonServer node were to go down.</p>
</div>
</div>
<div class="sect2">
<h3 id="_synapse"><a class="anchor" href="#_synapse"></a>Synapse</h3>
<div class="paragraph">
<p>Using the AxonServer as storage implementation and enabling HA allows you to tolerate synapse nodes going down and the remaining ones taking over.</p>
</div>
</div>
<div class="sect2">
<h3 id="_client_applications"><a class="anchor" href="#_client_applications"></a>Client applications</h3>
<div class="paragraph">
<p><!-- vale Google.OxfordComma = NO -->
If you use Synapse to publish events, commands or queries, make sure that your client applications know all available Synapse instances and can retry if one should go down. Alternatively, add a reverse proxy with multiple upstream destinations for the publish endpoints.</p>
</div>
<div class="paragraph">
<p>Further, have your client applications run in a highly available manner.
If Synapse is available but your client application goes down, you didn&#8217;t win much in regards to availability.
Further, since registered handlers in Synapse only can have one configured URL, make sure to place a reverse proxy with multiple upstream destinations in between Synapse and the client applications it&#8217;s calling. Thereby, synapse can retry calling endpoints if one of the instances of your client application were to go down.</p>
</div>
</div>
</div>
</div>
        <nav class="pagination">
  <span class="prev"><a href="../storage/">Storage</a></span>
  <span class="next"><a href="ha-config/">HA Configuration</a></span>
</nav>
    </article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="primary-footer">
    <div class="footer-logo ">
      <a href="https://axoniq.io/">
        <img src="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png" alt="Logo AxonIQ" loading="lazy" srcset="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=45&amp;height=10&amp;name=Logo%20AxonIQ%20(2).png 45w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png 90w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=135&amp;height=30&amp;name=Logo%20AxonIQ%20(2).png 135w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=180&amp;height=40&amp;name=Logo%20AxonIQ%20(2).png 180w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=225&amp;height=50&amp;name=Logo%20AxonIQ%20(2).png 225w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=270&amp;height=60&amp;name=Logo%20AxonIQ%20(2).png 270w" sizes="(max-width: 90px) 100vw, 90px" width="90" height="20">
      </a>
    </div>

    <div class="footer-menu">
	    <h3>Products</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-framework">Axon Framework</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-server">Axon Server</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axoniq-cloud">AxonIQ Cloud</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axoniq-console">AxonIQ Console</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-synapse">Axon Synapse</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/blog/protect-sensitive-data-in-an-event-sourced-application">AxonIQ Data Protection</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Sites</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="http://support.axoniq.io/">Customer Support Portal</a></li>
          <li><a class="ext" target="_blank" href="https://academy.axoniq.io/">AxonIQ Academy</a></li>
          <li><a class="ext" target="_blank" href="https://console.axoniq.io/">AxonIQ Console</a></li>
          <li><a class="ext" target="_blank" href="https://discuss.axoniq.io/">AxonIQ Discuss</a></li>
          <li><a class="ext" target="_blank" href="https://console.cloud.axoniq.io">AxonIQ Cloud</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Follow us</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.youtube.com/axoniq">YouTube</a></li>
          <li><a class="ext" target="_blank" href="https://www.linkedin.com/company/axoniq">LinkedIn</a></li>
          <li><a class="ext" target="_blank" href="https://www.facebook.com/AxonIQ.io">Facebook</a></li>
          <li><a class="ext" target="_blank" href="https://twitter.com/axon_iq">Twitter</a></li>
          <li><a class="ext" target="_blank" href="https://github.com/AxonIQ">GitHub</a></li>
          <li><a class="ext" target="_blank" href="https://medium.com/axoniq">Medium</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script async src="../../../_/js/vendor/page-actions.js"></script>
<script async src="../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab" data-sync-storage-scope="session"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
