<!DOCTYPE html>
<html lang="en">
  <head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Feature: Send Notification When Student Subscribed</title>
    <link rel="canonical" href="https://docs.axoniq.io/axon-framework-5-getting-started/implement-stateless-event-handler/">
    <link rel="prev" href="../configure-axon-server/">
    <link rel="next" href="../implement-stateful-event-handler/">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/vendor/tabs.css">
    <link rel="icon" href="../../_/img/favicon.png" sizes="32x32">
    <link rel="apple-touch-icon" href="../../_/img/favicon.png"><!-- 180×180 -->
    <link rel="manifest" href="../../_/static/manifest.webmanifest">

        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QD58ZB');</script>
        <!-- End Google Tag Manager -->

    <script>var uiRootPath = '../../_'</script>


<link rel="icon" href="../../_/img/favicon.png" type="image/png">
  </head>
  <body class="article">
    <div class="header_container">
      
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QD58ZB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.axoniq.io">
        <img src="../../_/img/docs-logo.png" class="header_logo"/>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-center">
        <a class="navbar-item" href="../../home/basics/">Basics</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../home/guides/">Guides</a>
          <div class="navbar-dropdown card">
            <a class="navbar-item" href="../../home/guides/axon-framework">Axon Framework</a>
            <a class="navbar-item" href="../../home/guides/axon-server">Axon Server</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../home/reference/">Reference</a>
          <div class="navbar-dropdown card">
                <a class="navbar-item" href="../../axon-framework-reference/5.0/">Axon Framework</a>
                <a class="navbar-item" href="../../axon-framework-extensions/">Axon Framework Extensions</a>
                <a class="navbar-item" href="../../axon-server-reference/development/">Axon Server</a>
                <a class="navbar-item" href="../../synapse-reference/v0.12/">Axon Synapse</a>
                <a class="navbar-item" href="../../axoniq-platform-reference/">Axoniq Platform</a>
          </div>
        </div>
      </div>
      <div class="navbar-end">
          <div class="navbar-item search hide-for-print">
            <div id="search-field" class="field">
              <input id="search-input" type="text" placeholder="Search AxonIQ Docs">
            </div>
          </div>
        <a class="navbar-item navbar-button" href="https://platform.axoniq.io" target="_blank">Axoniq Platform</a>
      </div>
    </div>
  </nav>
</header>
      <div class="toolbar card" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../home/" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../">Getting Started with Axon Framework 5 </a></li>
    <li><a href="./">Feature: Send Notification When Student Subscribed</a></li>
  </ul>
</nav>
<div class="page-actions">
  <button class="actions-menu-toggle" title="Show actions related to this page">Actions</button>
  <div class="actions-menu toolbar_dropdown_menu card">
      <a class="action item" href="https://github.com/AxonFramework/AxonFramework/edit/axon-5.0.x/docs/af5-getting-started/modules/ROOT/pages/implement-stateless-event-handler.adoc">Edit this Page</a>
    
    <a class="action item" href="https://discuss.axoniq.io/search?q&#x3D;Feature%3A%20Send%20Notification%20When%20Student%20Subscribed" target="discuss_search">View Discussions</a>
    <a class="action item" href="https://discuss.axoniq.io/new-topic?category&#x3D;library&amp;title&#x3D;%22Feature%3A%20Send%20Notification%20When%20Student%20Subscribed%22%20Discussion&amp;body&#x3D;%3C!--%20Replace%20this%20comment%20with%20your%20comment%2Fsuggestion%2Fquestion%2F...%20--%3E%0A%0A%0A%3C!--%0AKeep%20the%20section%20below!%0ALinking%20back%20to%20the%20documentation%20URL%20not%20only%20helps%20people%20go%20to%20the%20page%0Abut%20also%20helps%20find%20relevant%20discussions%20from%20the%20documentation%20page%20via%20the%20%22View%20Discussion%22%20menu.%0A--%3E%0A%5Bdetails%3D%22Related%20library%20page%22%5D%0A%5BFeature%3A%20Send%20Notification%20When%20Student%20Subscribed%5D(https%3A%2F%2Fdocs.axoniq.io%2Faxon-framework-5-getting-started%2Fimplement-stateless-event-handler%2F)%0A%5B%2Fdetails%5D%0A" target="discuss_add">Start new discussion</a>
  </div>
</div>


<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">master</button>
  <div class="version-menu toolbar_dropdown_menu card">
    <a class="version item is-current" href="./">master</a>
    <a class="version item" href="../main/implement-stateless-event-handler/">main</a>
  </div>
</div>
</div>
    </div>
    <div class="content_container">
      <div class="body">
<div class="nav-container" data-component="axon-framework-5-getting-started" data-version="master">
    <aside class="nav card">
      <div class="panels">
        <div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../">Getting Started with Axon Framework 5</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../sample-domain-event-modeling/">University Domain</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../project-structure/">Project Structure</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../implement-command-create-course/">Feature: Course Creation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../implement-command-subscribe-student/">Feature: Subscribe Student</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../configure-axon-server/">Connecting to Axon Server</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="./">Feature: Send Notification When Student Subscribed</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../implement-stateful-event-handler/">Feature: Send Notification To The Administrator When All Courses Are Fully Booked</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../implement-read-model/">Feature: Build Course Statistics Read Model (Projection)</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
      </div>
    </aside>
</div>
<main class="article">
    <div class="page_content">
        <aside class="toc sidebar" data-title="Page content" data-levels="2">
  <div class="toc-menu"></div>
</aside>
          <article class="doc">
                <h1 class="page">Feature: Send Notification When Student Subscribed</h1>
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>One of the greatest benefits of using an event-driven architecture is the ability to react to events that occur in your system.
Thanks to that, you can implement features that are decoupled from the core business logic and add new behavior without changing existing parts of the system.</p>
</div>
<div class="paragraph">
<p>In this example, we will implement a stateless event handler that sends a notification when a student subscribes to a course.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_a_stateless_event_handler"><a class="anchor" href="#_what_is_a_stateless_event_handler"></a>What is a stateless event handler?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A stateless event handler is a component that reacts to events without maintaining any internal state between event processing.
Unlike command handlers that need to validate business rules against current state, stateless event handlers simply perform actions in response to events.</p>
</div>
<div class="paragraph">
<p>Common use cases for stateless event handlers include:
- Sending notifications (email, text messages, push notifications)
- Logging or auditing events
- Triggering external system integrations
- Updating search indices
- Sending events to message queues</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_understanding_the_notification_feature"><a class="anchor" href="#_understanding_the_notification_feature"></a>Understanding the notification feature</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Our goal is to send a notification to a student whenever they subscribe to a course. Let&#8217;s look at the Event Modeling diagram for this feature:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/EventModeling_WhenStudentSubscribedThenSendNotification.jpg" alt="EventModeling WhenStudentSubscribedThenSendNotification">
</div>
</div>
<div class="paragraph">
<p>The diagram shows the automation flow:
- <strong>Orange sticky (Event)</strong>: <code>StudentSubscribedToCourse</code> - the trigger event containing student and course IDs
- <strong>Gear (Automation)</strong>: The stateless event handler that processes the event
- <strong>Blue sticky (External System)</strong>: <code>SendNotification</code> - the side effect that sends a notification
- <strong>Green sticky (Event tracking)</strong>: Tracks progress of processed events in Event Modeling methodology</p>
</div>
<div class="paragraph">
<p>The green sticky represents an <strong>Event tracking</strong> mechanism from Event Modeling - a way to track which tasks have been completed. In this case, it would track which student subscription notifications have already been sent. However, with Axon Framework, you don&#8217;t need to manually implement this tracking because every <code>EventProcessor</code> automatically tracks its position and processed events using tracking tokens.</p>
</div>
<div class="paragraph">
<p>This serves two key business purposes:</p>
</div>
<div class="paragraph">
<p><strong>Self-Service Confirmation</strong>: When students register themselves, they get immediate confirmation of successful enrollment.</p>
</div>
<div class="paragraph">
<p><strong>Administrative Transparency</strong>: When the dean&#8217;s office enrolls students in mandatory courses or prerequisites, students are automatically informed of these actions.</p>
</div>
<div class="paragraph">
<p>This is a perfect example of a stateless operation because:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>No validation needed</strong> - The subscription already happened successfully</p>
</li>
<li>
<p><strong>No state tracking</strong> - We don&#8217;t need to remember previous notifications</p>
</li>
<li>
<p><strong>Side effect only</strong> - We&#8217;re just performing an action (sending notification)</p>
</li>
<li>
<p><strong>Decoupled</strong> - This feature doesn&#8217;t affect the core subscription logic</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up_the_notification_infrastructure"><a class="anchor" href="#_setting_up_the_notification_infrastructure"></a>Setting up the notification infrastructure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before we implement our event handler, we need to set up the notification service infrastructure.</p>
</div>
<div class="sect2">
<h3 id="_step_1_define_the_notification_service_interface"><a class="anchor" href="#_step_1_define_the_notification_service_interface"></a>Step 1: Define the notification service interface</h3>
<div class="listingblock">
<div class="title">src/main/java/io/axoniq/demo/university/shared/application/notifier/NotificationService.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface NotificationService { <i class="conum" data-value="1"></i><b>(1)</b>

    record Notification(String recipientId, String message) { <i class="conum" data-value="2"></i><b>(2)</b>
    }

    void sendNotification(Notification notification); <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We define a simple interface for sending notifications</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A record representing a notification with recipient ID and message</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The main method for sending notifications</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_create_infrastructure_implementations"><a class="anchor" href="#_step_2_create_infrastructure_implementations"></a>Step 2: Create Infrastructure Implementations</h3>
<div class="paragraph">
<p>Let&#8217;s create two implementations - one for logging and one for testing.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These are simplified implementations for tutorial purposes. In a real application, the <code>LoggingNotificationService</code> would likely be replaced with implementations that send actual emails, text messages, push notifications etc.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">src/main/java/io/axoniq/demo/university/shared/infrastructure/notifier/LoggingNotificationService.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class LoggingNotificationService implements NotificationService { <i class="conum" data-value="1"></i><b>(1)</b>

    private static final Logger logger = Logger.getLogger(LoggingNotificationService.class.getName());

    @Override
    public void sendNotification(Notification notification) { <i class="conum" data-value="2"></i><b>(2)</b>
        logger.info("Sending notification to " + notification.recipientId() + ": " + notification.message());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A simple implementation that logs notifications</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In a real system, this might send emails, text messages, or push notifications</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For testing purposes, we need a way to verify that notifications were sent:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/io/axoniq/demo/university/shared/infrastructure/notifier/RecordingNotificationService.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class RecordingNotificationService implements NotificationService { <i class="conum" data-value="1"></i><b>(1)</b>

    private final NotificationService delegate; <i class="conum" data-value="2"></i><b>(2)</b>
    private final ConcurrentLinkedQueue&lt;Notification&gt; recorded = new ConcurrentLinkedQueue&lt;&gt;(); <i class="conum" data-value="3"></i><b>(3)</b>

    public RecordingNotificationService(NotificationService delegate) {
        this.delegate = delegate;
    }

    @Override
    public void sendNotification(Notification notification) {
        delegate.sendNotification(notification); <i class="conum" data-value="4"></i><b>(4)</b>
        recorded.add(notification); <i class="conum" data-value="5"></i><b>(5)</b>
    }

    public List&lt;Notification&gt; sent() { <i class="conum" data-value="6"></i><b>(6)</b>
        return List.copyOf(recorded);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A decorator that records notifications for testing while still delegating to a real implementation</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The actual notification service to delegate to</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Thread-safe queue to store sent notifications</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Send the notification using the delegate</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Record the notification for test verification</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Provide access to sent notifications for assertions</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_configure_the_notification_service"><a class="anchor" href="#_step_3_configure_the_notification_service"></a>Step 3: Configure the notification service</h3>
<div class="listingblock">
<div class="title">src/main/java/io/axoniq/demo/university/shared/configuration/NotificationServiceConfiguration.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class NotificationServiceConfiguration {

    public static EventSourcingConfigurer configure(EventSourcingConfigurer configurer) {
        return configurer.componentRegistry(cr -&gt; cr.registerComponent( <i class="conum" data-value="1"></i><b>(1)</b>
                NotificationService.class, <i class="conum" data-value="2"></i><b>(2)</b>
                cfg -&gt; new RecordingNotificationService(new LoggingNotificationService()) <i class="conum" data-value="3"></i><b>(3)</b>
        ));
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We register the service with Axon&#8217;s component registry</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Register it under the <code>NotificationService</code> interface type</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Create a recording service that wraps the logging service - perfect for testing</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementing_the_event_handler"><a class="anchor" href="#_implementing_the_event_handler"></a>Implementing the event handler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we have our notification infrastructure, let&#8217;s implement our stateless event handler step by step.</p>
</div>
<div class="sect2">
<h3 id="_step_4_create_the_event_handler"><a class="anchor" href="#_step_4_create_the_event_handler"></a>Step 4: Create the event handler</h3>
<div class="listingblock">
<div class="title">src/main/java/io/axoniq/demo/university/faculty/automation/studentsubscribednotifier/WhenStudentSubscribedThenSendNotification.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class WhenStudentSubscribedThenSendNotification { <i class="conum" data-value="1"></i><b>(1)</b>

    private final NotificationService notificationService; <i class="conum" data-value="2"></i><b>(2)</b>

    public WhenStudentSubscribedThenSendNotification(NotificationService notificationService) {
        this.notificationService = notificationService;
    }

    @EventHandler <i class="conum" data-value="3"></i><b>(3)</b>
    void react(StudentSubscribedToCourse event) { <i class="conum" data-value="4"></i><b>(4)</b>
        var notification = new NotificationService.Notification( <i class="conum" data-value="5"></i><b>(5)</b>
                event.studentId().toString(),
                "You have subscribed to course " + event.courseId()
        );
        notificationService.sendNotification(notification); <i class="conum" data-value="6"></i><b>(6)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The class name clearly describes what happens: "When student subscribed, then send notification"</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We inject the <code>NotificationService</code> dependency for sending notifications</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>@EventHandler</code> annotation marks this method to handle events</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The method parameter defines which event type we want to handle</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We create a notification with the student ID and a message about the subscription</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>We send the notification using the injected service</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<strong>No exactly once delivery guarantee</strong> - Event handlers may be executed more than once in case of failures or retries. This means your <code>NotificationService</code> should be idempotent to avoid sending duplicate notifications and being considered a spammer. Consider implementing deduplication mechanisms like tracking sent notification IDs or using external services that handle deduplication.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_create_the_configuration"><a class="anchor" href="#_step_5_create_the_configuration"></a>Step 5: Create the Configuration</h3>
<div class="paragraph">
<p>Now we need to configure our event handler to be processed by an event processor.</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/io/axoniq/demo/university/faculty/automation/studentsubscribednotifier/StudentSubscribedNotifierConfiguration.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class StudentSubscribedNotifierConfiguration {

    public static EventSourcingConfigurer configure(EventSourcingConfigurer configurer) {
        PooledStreamingEventProcessorModule automationProcessor = EventProcessorModule <i class="conum" data-value="1"></i><b>(1)</b>
                .pooledStreaming("Automation_WhenStudentSubscribedThenSendNotification_Processor") <i class="conum" data-value="2"></i><b>(2)</b>
                .eventHandlingComponents( <i class="conum" data-value="3"></i><b>(3)</b>
                        c -&gt; c.autodetected(cfg -&gt; new WhenStudentSubscribedThenSendNotification(cfg.getComponent(NotificationService.class))) <i class="conum" data-value="4"></i><b>(4)</b>
                ).notCustomized();

        return configurer
                .modelling(modelling -&gt; modelling.messaging(messaging -&gt; messaging.eventProcessing(eventProcessing -&gt;
                        eventProcessing.pooledStreaming(ps -&gt; ps.processor(automationProcessor)) <i class="conum" data-value="5"></i><b>(5)</b>
                )));
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We use <code>PooledStreamingEventProcessor</code> for efficient event processing</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We give the processor a descriptive name that indicates its purpose</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We configure which components should be registered as event handlers</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We create our event handler instance with the required <code>NotificationService</code> dependency</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We register the processor module with the event processing configuration</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_the_event_handler"><a class="anchor" href="#_testing_the_event_handler"></a>Testing the event handler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s create a test to verify our event handler works correctly.</p>
</div>
<div class="listingblock">
<div class="title">src/test/java/io/axoniq/demo/university/faculty/automation/studentsubscribednotifier/WhenStudentSubscribedThenSendNotificationTest.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class WhenStudentSubscribedThenSendNotificationAxonFixtureTest {

    private AxonTestFixture fixture;

    @BeforeEach
    void beforeEach() {
        var application = new UniversityAxonApplication();
        var sliceConfigurer = application.configurer(configurer -&gt; { <i class="conum" data-value="1"></i><b>(1)</b>
            configurer = NotificationServiceConfiguration.configure(configurer);
            return StudentSubscribedNotifierConfiguration.configure(configurer);
        });
        fixture = AxonTestFixture.with(sliceConfigurer);
    }

    @AfterEach
    void afterEach() {
        fixture.stop();
    }

    @Test
    void automationTest() {
        var studentId = StudentId.random();
        var courseId = CourseId.random();

        var expectedNotification = new NotificationService.Notification(studentId.raw(), "You have subscribed to course " + courseId);

        fixture.given()
                .events(new StudentSubscribedToCourse(studentId, courseId)) <i class="conum" data-value="2"></i><b>(2)</b>
                .then()
                .await(r -&gt; r.expect(cfg -&gt; assertNotificationSent(cfg, expectedNotification))); <i class="conum" data-value="3"></i><b>(3)</b>
    }

    private void assertNotificationSent(Configuration configuration, NotificationService.Notification expectedNotification) {
        var notificationService = (RecordingNotificationService) configuration.getComponent(NotificationService.class);
        assertThat(notificationService.sent()).contains(expectedNotification); <i class="conum" data-value="4"></i><b>(4)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We configure both the notification service and our event handler for testing</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We use <code>events()</code> to publish the <code>StudentSubscribedToCourse</code> event</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>await</code> method from <code>AxonTestFixture</code> use the Awaitility library under the hood, to wait for asynchronous processing to complete</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We assert that the expected notification was sent</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_key_concepts_review"><a class="anchor" href="#_key_concepts_review"></a>Key concepts review</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_integration_with_the_main_application"><a class="anchor" href="#_integration_with_the_main_application"></a>Integration with the main application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use this feature in your main application, you need to register both the notification service and the event handler configurations:</p>
</div>
<div class="listingblock">
<div class="title">src/main/java/io/axoniq/demo/university/UniversityAxonApplication.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class UniversityAxonApplication {

    public static ApplicationConfigurer configurer() {
        return configurer(c -&gt; {
            // Other configurations...
            NotificationServiceConfiguration.configure(c); <i class="conum" data-value="1"></i><b>(1)</b>
            StudentSubscribedNotifierConfiguration.configure(c); <i class="conum" data-value="2"></i><b>(2)</b>
        });
    }

    // rest omitted for brevity
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Register the notification service infrastructure</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Register the notification automation configuration that depends on the service</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary"><a class="anchor" href="#_summary"></a>Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, you learned how to implement a stateless event handler for sending notifications. Key takeaways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Stateless event handlers</strong> are perfect for side effects like notifications</p>
</li>
<li>
<p><strong>Asynchronous testing</strong> requires tools like Awaitility for reliable tests</p>
</li>
<li>
<p><strong>Decoupled architecture</strong> makes the system more maintainable and scalable</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This pattern can be applied to many similar scenarios: audit logging, search index updates, webhook notifications, and external system integrations.</p>
</div>
</div>
</div>
        <nav class="pagination">
  <span class="prev"><a href="../configure-axon-server/">Connecting to Axon Server</a></span>
  <span class="next"><a href="../implement-stateful-event-handler/">Feature: Send Notification To The Administrator When All Courses Are Fully Booked</a></span>
</nav>
    </article>
  </div>
</main>
</div>
      <footer class="footer">
  <div class="secondary-footer">
    <p>Copyright © 2025 AxonIQ BV. All Rights Reserved</p>
    <img referrerpolicy="no-referrer-when-downgrade" src="https://static.scarf.sh/a.png?x-pxid=e0b2b5cb-139e-4753-acab-bae43f90c5d3" />
  </div>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/page-actions.js"></script>
<script async src="../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab" data-sync-storage-scope="session"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
    </div>
  </body>
</html>
