<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>High Availability</title>
    <link rel="canonical" href="https://library.axoniq.io/synapse_ref/v0.9/ha/index.html">
    <link rel="prev" href="../storage/index.html">
    <link rel="next" href="ha-config.html">
    <meta name="generator" content="Antora 3.1.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/vendor/tabs.css">

        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QD58ZB');</script>
        <!-- End Google Tag Manager -->

    <script>var uiRootPath = '../../../_'</script>


  </head>
  <body class="article">

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QD58ZB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://library.axoniq.io">ðŸ“š AxonIQ Library</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Explanations</a>
          <div class="navbar-dropdown">
                <a class="navbar-item" href="../../../concepts/index.html">Software Development Concepts</a>
                <a class="navbar-item" href="../../../understanding-axon/index.html">Understanding Axon</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">References</a>
          <div class="navbar-dropdown">
                <a class="navbar-item" href="../../../axon_framework_ref/index.html">Axon Framework</a>
                <a class="navbar-item" href="../../../axon_server_ref/index.html">Axon Server</a>
                <a class="navbar-item" href="../../v0.9/index.html">Axon Synapse</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Tutorials</a>
          <div class="navbar-dropdown">
                <a class="navbar-item" href="../../../axon_framework_fundamentals/index.html">Axon Framework Fundamentals</a>
                <a class="navbar-item" href="../../../axon-server-fundamentals/index.html">Axon Server Fundamentals</a>
                <a class="navbar-item" href="../../../synapse-quick-start/v0.9/index.html">Axon Synapse Quick Start</a>
                <a class="navbar-item" href="../../../giftcard/index.html">Building a Giftcard Application</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">How-to guides</a>
          <div class="navbar-dropdown">
          </div>
        </div>
        <a class="navbar-item" href="https://academy.axoniq.io" target="_blank">AxonIQ Academy</a>
        <a class="navbar-item" href="https://discuss.axoniq.io" target="_blank">Discuss</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="synapse_ref" data-version="v0.8">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Axon Synapse</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../overview.html">High-Level Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../access-control.html">Access Control</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../sending-messages.html">Sending Messages</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sending-commands.html">Sending Commands</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sending-queries.html">Sending Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sending-events.html">Sending Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../receiving-messages.html">Receiving Messages</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../receiving-commands.html">Receiving Commands</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../receiving-queries.html">Receiving Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../receiving-events.html">Receiving Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../aggregates.html">Aggregates</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../multi-context.html">Multi-Context</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../storage/index.html">Storage</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">High Availability</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ha-config.html">HA Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release-notes.html">Release Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../openapi/index.html">Open API Documentation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openapi/synapse.html">Axon Synapse API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openapi/client-message.html">Client Message API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../openapi/client-raw.html">Client Raw API</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Axon Synapse</a></li>
    <li><a href="index.html">High Availability</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">v0.8</button>
  <div class="version-menu">
    <a class="version" href="../../development/ha/index.html">development</a>
    <a class="version" href="../../v0.9/ha/index.html">v0.9</a>
    <a class="version is-current" href="index.html">v0.8</a>
    <a class="version" href="../../v0.7/ha/index.html">v0.7</a>
    <a class="version is-missing" href="../../v0.6/index.html">v0.6</a>
  </div>
</div>
<div class="page-actions">
  <button class="actions-menu-toggle" title="Show actions related to this page">Actions</button>
  <div class="actions-menu">

    <a class="action" href="https://discuss.axoniq.io/search?q&#x3D;https%3A%2F%2Flibrary.axoniq.io%2Fsynapse_ref%2Fv0.8%2Fha%2Findex.html%20%23library" target="discuss_search">View Discussions</a>
    <a class="action" href="https://discuss.axoniq.io/new-topic?category&#x3D;library&amp;title&#x3D;%22High%20Availability%22%20library%20page%20...&amp;body&#x3D;%3C!--%20Replace%20this%20comment%20with%20your%20comment%2Fsuggestion%2Fquestion%2F...%20--%3E%0A%0A%0A%3C!--%0AKeep%20the%20section%20below!%0ALinking%20back%20to%20the%20documentation%20URL%20not%20only%20helps%20people%20go%20to%20the%20page%0Abut%20also%20helps%20find%20relevant%20discussions%20from%20the%20documentation%20page%20via%20the%20%22View%20Discussion%22%20menu.%0A--%3E%0A%5Bdetails%3D%22Related%20library%20page%22%5D%0A%5BHigh%20Availability%5D(https%3A%2F%2Flibrary.axoniq.io%2Fsynapse_ref%2Fv0.8%2Fha%2Findex.html)%0A%5B%2Fdetails%5D%0A" target="discuss_add">Start new discussion</a>
  </div>
</div>


</div>
    <div class="content">
        <aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
          <article class="doc">
            <h1 class="page">High Availability</h1>
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Synapse does support high availability (HA).</p>
</div>
<div class="paragraph">
<p>This page explains how the HA features in Synapse work.
To see how to configure them, refer to <a href="ha-config.html" class="xref page">HA Configuration</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For using HA, you need to have selected AxonServer as a means of storing your Synapse configuration. Refer to <a href="../storage/index.html" class="xref page">Storage</a> on how to do this.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Whilst it&#8217;s possible to simply run multiple independent Synapse instances without shared configuration, this is highly discouraged and generally regarded as a bad idea.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_ha_in_synapse_covers"><a class="anchor" href="#_what_ha_in_synapse_covers"></a>What HA in synapse covers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using HA in Synapse does provide you with the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tolerate individual Synapse instances to go down for maintenance or crash</p>
</li>
<li>
<p>Provide a way for the different handler types to balance themselves and be re-assigned when a Synapse instance goes down.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Synapse handles the different handler types in different ways:</p>
</div>
<div class="sect2">
<h3 id="_command_handlers"><a class="anchor" href="#_command_handlers"></a>Command handlers</h3>
<div class="paragraph">
<p>Each Synapse instance registers all configured command handlers with AxonServer. AxonServer then makes sure to send the commands to the correct handler instance via the Synapse instance used to register the handler.</p>
</div>
</div>
<div class="sect2">
<h3 id="_event_handlers"><a class="anchor" href="#_event_handlers"></a>Event handlers</h3>
<div class="paragraph">
<p>To prevent duplication of events as far as possible, Synapse instances cooperate to register event handlers only from one Synapse instance. This allows your client application to receive events from only one Synapse instance, as long as the topology doesn&#8217;t change.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When changing synapse instances, you may see slight duplication of events delivered. This is normal and unavoidable.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When topology changes (for example when a Synapse instance crashes or a new one appears), handlers are re-assigned to available Synapse instances according to a consistent hashing algorithm. This makes sure that if a Synapse instance goes down, other instances pick up the now unassigned event handlers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_handlers"><a class="anchor" href="#_query_handlers"></a>Query handlers</h3>
<div class="paragraph">
<p>As with Command Handlers, each Synapse instance registers all configured query handlers with AxonServer. Again, AxonServer then makes sure to send the queries to the correct client application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_infrastructure"><a class="anchor" href="#_infrastructure"></a>Infrastructure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To be fully high-available, it&#8217;s not enough to have Synapse set to HA. One should take the following aspects into consideration.</p>
</div>
<div class="sect2">
<h3 id="_axon_server"><a class="anchor" href="#_axon_server"></a>Axon server</h3>
<div class="paragraph">
<p>Synapse instances (and other client applications directly connecting to AxonServer, like AxonFramework applications) should have the addresses of all primary AxonServer nodes in the cluster configured. This allows them to reconnect if an AxonServer node were to go down.</p>
</div>
</div>
<div class="sect2">
<h3 id="_synapse"><a class="anchor" href="#_synapse"></a>Synapse</h3>
<div class="paragraph">
<p>Using the AxonServer as storage implementation and enabling HA allows you to tolerate synapse nodes going down and the remaining ones taking over.</p>
</div>
</div>
<div class="sect2">
<h3 id="_client_applications"><a class="anchor" href="#_client_applications"></a>Client applications</h3>
<div class="paragraph">
<p><!-- vale Google.OxfordComma = NO -->
If you use Synapse to publish events, commands or queries, make sure that your client applications know all available Synapse instances and can retry if one should go down. Alternatively, add a reverse proxy with multiple upstream destinations for the publish endpoints.</p>
</div>
<div class="paragraph">
<p>Further, have your client applications run in a highly available manner.
If Synapse is available but your client application goes down, you didn&#8217;t win much in regards to availability.
Further, since registered handlers in Synapse only can have one configured URL, make sure to place a reverse proxy with multiple upstream destinations in between Synapse and the client applications it&#8217;s calling. Thereby, synapse can retry calling endpoints if one of the instances of your client application were to go down.</p>
</div>
</div>
</div>
</div>
        <nav class="pagination">
  <span class="prev"><a href="../storage/index.html">Storage</a></span>
  <span class="next"><a href="ha-config.html">HA Configuration</a></span>
</nav>
    </article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="primary-footer">
    <div class="footer-logo ">
      <a href="https://axoniq.io/">
        <img src="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png" alt="Logo AxonIQ" loading="lazy" srcset="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=45&amp;height=10&amp;name=Logo%20AxonIQ%20(2).png 45w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png 90w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=135&amp;height=30&amp;name=Logo%20AxonIQ%20(2).png 135w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=180&amp;height=40&amp;name=Logo%20AxonIQ%20(2).png 180w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=225&amp;height=50&amp;name=Logo%20AxonIQ%20(2).png 225w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=270&amp;height=60&amp;name=Logo%20AxonIQ%20(2).png 270w" sizes="(max-width: 90px) 100vw, 90px" width="90" height="20">
      </a>
    </div>

    <div class="footer-menu">
	    <h3>Products</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-framework/overview">Axon Framework</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-server/overview">Axon Server Standard</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-server-enterprise/overview">Axon Server Enterprise</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axoniq-cloud/overview">AxonIQ Cloud</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-data-protection/overview">AxonIQ Data Protection</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Sites</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="http://support.axoniq.io/"> Client Support Portal</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/">AxonIQ Developer Portal</a></li>
          <li><a class="ext" target="_blank" href="https://academy.axoniq.io/">AxonIQ Academy</a></li>
          <li><a class="ext" target="_blank" href="https://discuss.axoniq.io/">AxonIQ Discuss</a></li>
          <li><a class="ext" target="_blank" href="https://start.axoniq.io/">AxonIQ Initializr</a></li>
          <li><a class="ext" target="_blank" href="https://console.cloud.axoniq.io">AxonIQ Cloud</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Follow us</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.youtube.com/axoniq">YouTube</a></li>
          <li><a class="ext" target="_blank" href="https://www.linkedin.com/company/axoniq">LinkedIn</a></li>
          <li><a class="ext" target="_blank" href="https://www.facebook.com/AxonIQ.io">Facebook</a></li>
          <li><a class="ext" target="_blank" href="https://twitter.com/axon_iq">Twitter</a></li>
          <li><a class="ext" target="_blank" href="https://github.com/AxonIQ">GitHub</a></li>
          <li><a class="ext" target="_blank" href="https://medium.com/axoniq">Medium</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script async src="../../../_/js/vendor/page-actions.js"></script>
<script async src="../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab" data-sync-storage-scope="session"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
