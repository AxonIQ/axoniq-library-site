<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Creating the Query Model</title>
    <link rel="canonical" href="https://library.axoniq.io/bikerental-demo/main/create-bike-status-projection.html">
    <link rel="prev" href="unit-testing-commands.html">
    <meta name="generator" content="Antora 3.1.1">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/vendor/tabs.css">
    <link rel="icon" href="../../_/img/favicon.ico" sizes="32x32">
    <link rel="icon" href="../../_/img/icon.svg" type="image/svg+xml" media="(prefers-color-scheme: light)">
    <link rel="icon" href="../../_/img/icon-light.svg" type="image/svg+xml" media="(prefers-color-scheme: dark)">
    <link rel="apple-touch-icon" href="../../_/img/apple-touch-icon.png"><!-- 180Ã—180 -->
    <link rel="manifest" href="../../_/static/manifest.webmanifest">
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QD58ZB');</script>
        <!-- End Google Tag Manager -->

    <script>var uiRootPath = '../../_'</script>


  </head>
  <body class="article">

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QD58ZB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://library.axoniq.io">Docs</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="../../home/basics.html">Basics</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Guides</a>
          <div class="navbar-dropdown">
              <a class="navbar-item" href="../../home/guides/axon-framework.html">Axon Framework</a>
              <a class="navbar-item" href="../../home/guides/axon-server.html">Axon Server</a>
              <a class="navbar-item" href="../../home/guides/migration.html">Migration</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Reference</a>
          <div class="navbar-dropdown">
                <a class="navbar-item" href="../../axon_framework_ref/introduction.html">Axon Framework</a>
                <a class="navbar-item" href="../../axon_server_ref/index.html">Axon Server</a>
                <a class="navbar-item" href="../../synapse_ref/latest/index.html">Axon Synapse</a>
                <a class="navbar-item" href="../../axoniq_console_ref/main/index.html">AxonIQ Console</a>
          </div>
        </div>
        <a class="navbar-item" href="https://academy.axoniq.io" target="_blank">AxonIQ Academy</a>
        <a class="navbar-item" href="https://discuss.axoniq.io" target="_blank">AxonIQ Discuss</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="bikerental-demo" data-version="main">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Building An Axon Framework Application From Scratch</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="create-axon-framework-project.html">Create New Project</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bootstraping-axonframework.html">Bootstrap AxonFramework</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="implement-create-bike.html">Create New Bike Feature</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="run-app-with-docker-compose.html">Running Your Application Locally With Docker Compose</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="invoking-create-bike-endpoint.html">Invoking the Register Bike Endpoint</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="unit-testing-commands.html">Add Unit Tests For Command Handlers</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="create-bike-status-projection.html">Creating the Query Model</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Building An Axon Framework Application From Scratch </a></li>
    <li><a href="create-bike-status-projection.html">Creating the Query Model</a></li>
  </ul>
</nav>
<div class="page-actions">
  <button class="actions-menu-toggle" title="Show actions related to this page">Actions</button>
  <div class="actions-menu">
      <a class="action" href="https://github.com/AxonIQ/bike-rental-quick-start/edit/main/docs/tutorial/modules/ROOT/pages/create-bike-status-projection.adoc">Edit this Page</a>
    
    <a class="action" href="https://discuss.axoniq.io/search?q&#x3D;https%3A%2F%2Flibrary.axoniq.io%2Fbikerental-demo%2Fmain%2Fcreate-bike-status-projection.html%20%23library" target="discuss_search">View Discussions</a>
    <a class="action" href="https://discuss.axoniq.io/new-topic?category&#x3D;library&amp;title&#x3D;%22Creating%20the%20Query%20Model%22%20library%20page%20...&amp;body&#x3D;%3C!--%20Replace%20this%20comment%20with%20your%20comment%2Fsuggestion%2Fquestion%2F...%20--%3E%0A%0A%0A%3C!--%0AKeep%20the%20section%20below!%0ALinking%20back%20to%20the%20documentation%20URL%20not%20only%20helps%20people%20go%20to%20the%20page%0Abut%20also%20helps%20find%20relevant%20discussions%20from%20the%20documentation%20page%20via%20the%20%22View%20Discussion%22%20menu.%0A--%3E%0A%5Bdetails%3D%22Related%20library%20page%22%5D%0A%5BCreating%20the%20Query%20Model%5D(https%3A%2F%2Flibrary.axoniq.io%2Fbikerental-demo%2Fmain%2Fcreate-bike-status-projection.html)%0A%5B%2Fdetails%5D%0A" target="discuss_add">Start new discussion</a>
  </div>
</div>


</div>
    <div class="content">
        <aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
          <article class="doc">
            <h1 class="page">Creating the Query Model</h1>
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this tutorial step, we will implement the Query Model, a component whose primary goal is to receive and handle any request for information about our system. These requests, which only expect some information in return and whose processing does not imply making any changes in our system, are known as <strong>Queries</strong>.</p>
</div>
<div class="paragraph">
<p>In order to efficiently handle and process a query request, we will design our system to maintain a version (or a <em>view</em>) of the data that is updated and aligned with the format in which users can request information from the system. This component that aims to keep a copy of the data aligned with the structure of the expected query response is called the <strong>Projection</strong>.</p>
</div>
<div class="paragraph">
<p>To keep the projection up to date with the changes made by other components (the command handlers) in the system, <strong>the Query Model component must receive the event messages that represent the notification of changes made by the command model</strong> and modify the projection accordingly. This way, our query model will be ready to handle any query request to return this updated information view.</p>
</div>
<div class="paragraph">
<p>If we recall the main diagram of our application, it&#8217;s now time to focus on the bottom half of the diagram: implementing the components needed to handle and respond to queries.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/logic-diagram.png" alt="Design diagram with the logical modules for rental application: An UI/API module contains the HTTP Controller that receives the HTTP POST request to register a new bike. The HTTP Controller sends a RegisterBikeCommand to the Command Model module" width="including a CommandHandler to maintain the Bike aggregates. After processing a RegisterBikeCommand" height="the CommandHandler sends a BikeRegisteredEvent to the Query Model module">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_the_bikestatus_response_message"><a class="anchor" href="#_creating_the_bikestatus_response_message"></a>Creating the <code>BikeStatus</code> response message</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If, as we have just stated, our projection component will focus on handling queries to request information from our system, the first thing we need to consider when designing the query model is the exact request we will handle and how we will return the information.</p>
</div>
<div class="paragraph">
<p>In this case, we will implement support in our application to return information about one or more bikes, including where the bike is, whether it is available or rented and who has rented it.</p>
</div>
<div class="paragraph">
<p>So, we will model all the information expected from these queries in the <code>BikeStatus</code> class. We will define this class in the <code>core-api</code>:</p>
</div>
<div class="listingblock">
<div class="title">core-api/src/main/java/io/axoniq/demo/bikerental/coreapi/rental/BikeStatus.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class BikeStatus {

    private String bikeId;
    private String bikeType;
    private String location;
    private String renter;
    private RentalStatus status;

    public BikeStatus() {
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class defines the fields with the information we need to present in the query response message.</p>
</div>
<div class="paragraph">
<p>To model the status of the bike, we will define the following Java enum:</p>
</div>
<div class="listingblock">
<div class="title">core-api/src/main/java/io/axoniq/demo/bikerental/coreapi/rental/RentalStatus.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.axoniq.demo.bikerental.coreapi.rental;

public enum RentalStatus {

    AVAILABLE,
    REQUESTED,
    RENTED
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, after we have all the fields for the <code>BikeStatus</code> response message, it&#8217;s convenient to add methods to retrieve the information from the class. So, we can add the accessor methods:</p>
</div>
<div class="listingblock">
<div class="title">core-api/src/main/java/io/axoniq/demo/bikerental/coreapi/rental/BikeStatus.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class BikeStatus {

    // Accessor methods
    public String getBikeId() {
        return bikeId;
    }

    public String getBikeType() {
        return bikeType;
    }

    public String getLocation() {
        return location;
    }

    public String getRenter() {
        return renter;
    }

    public RentalStatus getStatus() {
        return status;
    }

    public String description() {
        switch (status) {
            case RENTED:
                return String.format("Bike %s was rented by %s in %s", bikeId, renter, location);
            case AVAILABLE:
                return String.format("Bike %s is available for rental in %s.", bikeId, location);
            case REQUESTED:
                return String.format("Bike %s is requested by %s in %s", bikeId, renter, location);
            default:
                return "Status unknown";
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_the_bikestatus_projection"><a class="anchor" href="#_creating_the_bikestatus_projection"></a>Creating the <code>BikeStatus</code> projection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we have modeled the information we want to expose in response to requests to check the status of a bike. We can now create the component to keep this information updated and ready to be returned when a query request is processed.</p>
</div>
<div class="sect2">
<h3 id="_creating_the_bikestatus_class_and_the_spring_jparepository"><a class="anchor" href="#_creating_the_bikestatus_class_and_the_spring_jparepository"></a>Creating the <code>BikeStatus</code> class and the Spring <code>JpaRepository</code></h3>
<div class="paragraph">
<p>We need to create a <code>BikeStatusProjection</code> class in the <code>&#8230;&#8203;rental.query</code> package of our <code>rental</code> module:</p>
</div>
<div class="listingblock">
<div class="title">rental/src/main/java/io/axoniq/demo/bikerental/rental/query/BikeStatusProjection.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component
public class BikeStatusProjection {

    private final BikeStatusRepository bikeStatusRepository; <i class="conum" data-value="1"></i><b>(1)</b>

    public BikeStatusProjection(BikeStatusRepostory repository) {
        this.bikeStatusRepository = repository;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We will use a Spring repository to persist the <code>BikeStatus</code> model, which will be updated with the latest state based on the changes represented by the events received from the command model.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We need to define the Spring JPA repository we will use in our projection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Repository <i class="conum" data-value="1"></i><b>(1)</b>
public interface BikeStatusRepository
        extends JpaRepository&lt;BikeStatus, String&gt; { <i class="conum" data-value="2"></i><b>(2)</b>


}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>org.springframework.stereotype.Repository</code> annotation instructs Spring to generate a <code>Repository</code> component from this interface.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The convention for Spring JPA repositories is to create an interface that extends from <code>JpaRepository&lt;T, ID&gt;</code> where <code>T</code> is the type of the persisted classes and <code>ID</code> is the type of the identifier field in <code>T</code>. In this case, <code>T</code> should be annotated with <code>@Entity</code> and the <code>ID</code> should be of the same type as the field annotated with <code>@Id</code> in <code>T</code></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>With Spring Data support, this is all we need to define to have a <code>Repository</code> implementation that supports the basic operations of storing, updating, altering, querying, and dropping <code>BikeStatus</code> instances in the DB.</p>
</div>
<div class="paragraph">
<p>You can learn more about Spring Data Repositories in the section dedicated to <a href="https://docs.spring.io/spring-data/jpa/reference/repositories/definition.html">"Defining Repository Interfaces" from the Spring Data JPA Reference</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, to make the repository work, we must modify our <code>BikeStatus</code> class to add the persistence annotations. Open the <code>BikeStatus</code> class from the <code>core-api</code> module and introduce the following changes:</p>
</div>
<div class="listingblock">
<div class="title">core-api/src/main/java/io/axoniq/demo/bikerental/coreapi/rental/BikeStatus.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Entity <i class="conum" data-value="1"></i><b>(1)</b>
public class BikeStatus {

    @Id <i class="conum" data-value="2"></i><b>(2)</b>
    private String bikeId;
    private String bikeType;
    private String location;
    private String renter;
    private RentalStatus status;

    public BikeStatus() {
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>Entity</code> annotation marks this class as a persistent entity. This is the <code>T</code> in the Spring&#8217;s <code>JpaRepository&lt;T,ID&gt;</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This annotation instruct the persistent layer to consider <code>bikeId</code> as the Id for the persistent record. The type of the field annotated with <code>@Id</code> (in this case <code>String</code>) is the <code>ID</code> in the Spring&#8217;s <code>JpaRepository&lt;T,ID&gt;</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With these changes we are ready to define the methods in our <code>BikeStatusProjection</code> that should handle the events that notify changes made by the command model and update and persist the <code>BikeStatus</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_define_the_bikeregisteredevent_handler"><a class="anchor" href="#_define_the_bikeregisteredevent_handler"></a>Define the <code>BikeRegisteredEvent</code> handler.</h3>
<div class="paragraph">
<p>To keep the list of our bikes in the query model up to date, we need to define a method that will be invoked whenever a new bike is registered in the system (the <code>BikeRegisteredEvent</code> represents that notification). We can do this by adding an <code>@EventHandler</code> method to our <code>BikeStatusProjection</code>:</p>
</div>
<div class="listingblock">
<div class="title">rental/src/main/java/io/axoniq/demo/bikerental/rental/query/BikeStatusProjection.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component
public class BikeStatusProjection {

    @EventHandler <i class="conum" data-value="1"></i><b>(1)</b>
    public void on(BikeRegisteredEvent event) { <i class="conum" data-value="2"></i><b>(2)</b>
        var bikeStatus = new BikeStatus(event.bikeId(), event.bikeType(), event.location()); <i class="conum" data-value="3"></i><b>(3)</b>
        bikeStatusRepository.save(bikeStatus); <i class="conum" data-value="4"></i><b>(4)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@EventHandler</code> annotation instructs Axon Framework to register this component as a subscriber to <code>BikeRegisteredEvent</code> and call this method for each one.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>By default, Axon Framework uses the first argument in the method definition to match the type of events received and passes the event as an argument to the method.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Since <code>BikeRegisteredEvent</code> implies that a new bike has been created in the system, we need to create a new instance of <code>BikeStatus</code> to represent the state of this new bike.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Finally, we will persist the <code>BikeStatus</code> using the <code>bikeStatusRepository</code></td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handling_the_queries_from_the_projection"><a class="anchor" href="#_handling_the_queries_from_the_projection"></a>Handling the queries from the projection.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Our next task in defining our projection is to implement the support for handling queries and returning the current information we have.</p>
</div>
<div class="paragraph">
<p>We need to add a <code>@QueryHandler</code> method for each query we want to support. Since we already have the bike statuses persisted in the way we need to return the information, we only need to query the database and return that.</p>
</div>
<div class="paragraph">
<p>Before jumping into creating the methds to handle the queries, we need to consider how we are going to identify the different queries.</p>
</div>
<div class="sect2">
<h3 id="_using_named_queries"><a class="anchor" href="#_using_named_queries"></a>Using named queries.</h3>
<div class="paragraph">
<p>Axon Framework allows different ways to identify a query message and link that query to the right method for handling it. In this tutorial we are going to start using the most simple way to identify a query: by assigning each query a name.</p>
</div>
<div class="paragraph">
<p>We are going to use <code>String</code> constants to make sure we always refer to the same query name, both in the modules that send the query messages and in the components that are handling them.</p>
</div>
<div class="paragraph">
<p>So, as the first step we will create a class to define and share those query names in different components. Define the following class in the <code>core-api</code> module:</p>
</div>
<div class="listingblock">
<div class="title">/core-api/src/main/java/io/axoniq/demo/bikerental/coreapi/rental/BikeStatusNamedQueries.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.axoniq.demo.bikerental.coreapi.rental;

public class BikeStatusNamedQueries {
    public static final String FIND_ALL = "findAll";
    public static final String FIND_ONE = "findOne";
    public static final String FIND_AVAILABLE = "findAvailable";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that we have the names of the queries defined, let&#8217;s define the methods that will handle and respond them.</p>
</div>
</div>
<div class="sect2">
<h3 id="_implement_a_query_to_return_all_the_bikes"><a class="anchor" href="#_implement_a_query_to_return_all_the_bikes"></a>Implement a query to return all the bikes.</h3>
<div class="paragraph">
<p>Let&#8217;s start by implementing a method to return all the bikes (with their status) defined in our system. Add the following method to your <code>BikeStatusProjection</code> class:</p>
</div>
<div class="listingblock">
<div class="title">rental/src/main/java/io/axoniq/demo/bikerental/rental/query/BikeStatusProjection.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component
public class BikeStatusProjection {

    @QueryHandler(queryName = BikeStatusNamedQueries.FIND_ALL) <i class="conum" data-value="1"></i><b>(1)</b>
    public Iterable&lt;BikeStatus&gt; findAll() { <i class="conum" data-value="2"></i><b>(2)</b>
        return bikeStatusRepository.findAll(); <i class="conum" data-value="3"></i><b>(3)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>org.axonframework.queryhandling.QueryHandler</code> annotation instructs Axon Framework to register this method as a target to invoke for certain types of queries. In this case, we identify the queries by name (although the type of the query message could also identify them, but we will see an example of that later), and we declare the specific name of the query to be handled by this method with the <code>queryName</code> attribute.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Since our query has no parameters (we want to retrieve the information for <strong>all the bikes</strong> in our system), our query handler method does not receive any parameters. It only needs to return the list of items we find in our DB.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>As we have the information already prepared and aligned with the response format (thanks to the `EventHandler`s), we only need to retrieve the information from the repository and return it.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In short, we have defined a query handler method that Axon Framework will call upon the reception of a query message to <code>FIND_ALL</code> the bikes in our system. And the method will simply retrieve the up-to-date information from the DB and return the <code>BikeStatus</code> for all the bikes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_support_for_other_queries_in_our_projection"><a class="anchor" href="#_implementing_support_for_other_queries_in_our_projection"></a>Implementing support for other queries in our projection.</h3>
<div class="paragraph">
<p>We may need to support different query requests for information about the bikes in our system. The same projection can be used to satisfy different queries.</p>
</div>
<div class="paragraph">
<p>For example, if we want to support queries to return all the available bikes, filtering by the type, or the <code>BikeStatus</code> for a specific bike by its <code>bikeId</code>, we can add the following two methods to our <code>BikeStatusProjection</code>:</p>
</div>
<div class="listingblock">
<div class="title">rental/src/main/java/io/axoniq/demo/bikerental/rental/query/BikeStatusProjection.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component
public class BikeStatusProjection {

    @QueryHandler(queryName = BikeStatusNamedQueries.FIND_AVAILABLE) <i class="conum" data-value="1"></i><b>(1)</b>
    public Iterable&lt;BikeStatus&gt; findAvailable(String bikeType) { <i class="conum" data-value="2"></i><b>(2)</b>
        return bikeStatusRepository.findAllByBikeTypeAndStatus(bikeType, RentalStatus.AVAILABLE);
    }

    @QueryHandler(queryName = BikeStatusNamedQueries.FIND_ONE) <i class="conum" data-value="3"></i><b>(3)</b>
    public BikeStatus findOne(String bikeId) { <i class="conum" data-value="4"></i><b>(4)</b>
        return bikeStatusRepository.findById(bikeId).orElse(null); <i class="conum" data-value="5"></i><b>(5)</b>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We define a new <code>QueryHandler</code> method for the <code>findAvailable</code> query.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The query will filter by the type of the bike, so we need to add the <code>bikeType</code> argument to the method.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We need to add a specific method to our <code>BikeStatusRepository</code> that implements the query to the DB. We will do that right after this. Since we are using Spring Data, the name of the method should follow a specific pattern. (More on this in a few lines)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We define another <code>QueryHandler</code> method for the <code>FIND_ONE</code> query.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>In this query, we only need to return one bike, and we need the <code>bikeId</code> as an argument to the method. In this case, we will return a single <code>BikeStatus</code> because we are returning a single element and not a collection.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The default <code>findById</code> method provided by the Spring Data <code>JpaRepository</code> returns an <code>Optional&lt;T&gt;</code> when we look up an item based on its <code>id</code>. This is because the <code>id</code> we are looking for may not exist in our DB. So we add a fallback to return <code>null</code> in case there is no bike  with the given <code>bikeId</code> in the DB.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>One last thing we need to add is a method to our Spring Data <code>BikeStatusRepository</code> to support the specific method to filter all records from the DB all the records by <code>bikeType</code> and <code>status</code>. Fortunately, thanks to Spring Data we only need to define a method in the <code>BikeStatusRepository</code> interface following a specific naming pattern, and Spring Data will generate the implementation with the corresponding SQL query to the DB.</p>
</div>
<div class="paragraph">
<p>So, go to the <code>BikeStatusRepository</code> and add the following method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Repository <i class="conum" data-value="1"></i><b>(1)</b>
public interface BikeStatusRepository
        extends JpaRepository&lt;BikeStatus, String&gt; { <i class="conum" data-value="2"></i><b>(2)</b>

    List&lt;BikeStatus&gt; findAllByBikeTypeAndStatus(String bikeType, RentalStatus status);
    long countBikeStatusesByBikeType(String bikeType);

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When we define a Spring Data JPA repository that extends <code>JpaRepository&lt;T,ID&gt;</code>, Spring Data generates for us the implementation of a basic set of methods to query the database. These generated methods cover the operations of creating, updating, querying and deleting registers from the database.</p>
</div>
<div class="paragraph">
<p>Sometimes we need to define additional queries to filter elements according to different criteria. For these types of queries, Spring Data allows us to simply define new methods in our interface and, if we follow a certain naming convention, Spring will be able to infer the query that needs to be executed against the database from the name of the method and its arguments.</p>
</div>
<div class="paragraph">
<p>This is sometimes called <strong>Derived Queries</strong>  and you can learn how to add specific methods for different queries in the section dedicated to <a href="https://docs.spring.io/spring-data/commons/reference/repositories/query-methods-details.html#repositories.query-methods.query-creation">Query Creation from the Spring Data Reference guide</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, our <code>BikeStatusProjection</code> fully supports answering to queries to <code>findAll</code> bikes, <code>findAvailable</code> bikes of a certain type, and <code>findOne</code> specific bike given its <code>bikeId</code>.</p>
</div>
<div class="paragraph">
<p>In the next section we will extend our <code>RestController</code> to add endpoints for these queries and route the queries to the system using <code>Query</code> messages.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_the_endpoint_to_accept_query_request"><a class="anchor" href="#_creating_the_endpoint_to_accept_query_request"></a>Creating the Endpoint to accept query request.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we have full support in our projection to handle queries, let&#8217;s implement and expose the endpoint in our controller that will receive HTTP requests for the query and route the corresponding query message internally.</p>
</div>
<div class="paragraph">
<p>To do this, we will add a couple of <code>@GetMapping</code> annotated methods in the <code>RentalController</code> we created in <a href="implement-create-bike.html#_implementing_the_http_rest_controller" class="xref page">Implementing the HTTP REST controller</a>. Those methods will use the <code>QueryGateway</code> that we already added to the <code>RentalController</code> to route the queries through Axon Framework:</p>
</div>
<div class="listingblock">
<div class="title">/rental/src/main/java/io/axoniq/demo/bikerental/rental/iu/RentalController.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RestController      <i class="conum" data-value="1"></i><b>(1)</b>
@RequestMapping("/") <i class="conum" data-value="2"></i><b>(2)</b>
public class RentalController {

    private final CommandGateway commandGateway;    <i class="conum" data-value="3"></i><b>(3)</b>
    private final QueryGateway queryGateway;        <i class="conum" data-value="4"></i><b>(4)</b>

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>RestController</code> annotation by spring defines this as a component that will expose the REST endpoint URLs.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>@RequestMapping</code> annotation establishes the root URL for all the endpoints exposed by this controller.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>CommandGateway</code> is the Axon Framework component that we already used to route commands.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>QueryGateway</code> is the Axon Framework component that we will use now to route the query messages.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We already configured the query handler methods in the last section to use the <code>queryName</code> attribute and link the method to the query by query name. So, we will add these query names as constants to our <code>RestController</code>:</p>
</div>
<div class="listingblock">
<div class="title">/rental/src/main/java/io/axoniq/demo/bikerental/rental/iu/RentalController.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RestController
@RequestMapping("/")
public class RestController {


}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_endpoint_for_findall_query"><a class="anchor" href="#_implementing_endpoint_for_findall_query"></a>Implementing endpoint for <code>findAll</code> query</h3>
<div class="paragraph">
<p>To implement the method that exposes the endpoint for returning all the bikes and their status, add the following method to our <code>RestController</code>:</p>
</div>
<div class="listingblock">
<div class="title">/rental/src/main/java/io/axoniq/demo/bikerental/rental/iu/RentalController.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RestController
@RequestMapping("/")
public class RestController {

    @GetMapping("/bikes") <i class="conum" data-value="1"></i><b>(1)</b>
    public CompletableFuture&lt;List&lt;BikeStatus&gt;&gt; findAll() { <i class="conum" data-value="2"></i><b>(2)</b>
        return queryGateway.query( <i class="conum" data-value="3"></i><b>(3)</b>
                BikeStatusNamedQueries.FIND_ALL, <i class="conum" data-value="4"></i><b>(4)</b>
                null, <i class="conum" data-value="5"></i><b>(5)</b>
                ResponseTypes.multipleInstancesOf(BikeStatus.class) <i class="conum" data-value="6"></i><b>(6)</b>
        );
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>GetMapping</code> Spring annotation specifies that this method will be invoked whenever a <code>GET</code> request to the URL <code>/bikes</code> is received by the application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The method will return a list of <code>BikeStatus</code> responses. See the info block below for an explanation on returning the <code>CompletableFuture</code> or the <code>List&lt;BikeStatus&gt;</code> directly.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We will use the <code>query</code> mehtod on the <code>queryGateway</code> component provided by AxonFramework to route the query. This method receives three parameters:</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The query. It could be an object or a <code>String</code> with the query name. In this case, as the queries are simple ones, we have choosen to use query names.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The query itself, with the parameters or criteria for filtering the results. In this case, the <code>findAll</code> query does not have any filter, so we specify <code>null</code> as the query.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The type of reponse we are expecting from this query. In this case, we expect one or more instances of <code>BikeStatus</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>A performance consideration on returning CompletableFutures from your RestController method.</strong></p>
</div>
<div class="paragraph">
<p>The <code>queryGateway</code> returns a <code>CompletableFuture&lt;T&gt;</code> which keeps a reference to the result of executing the query, and allows to get the results of type <code>T</code>
when they are ready.</p>
</div>
<div class="paragraph">
<p>This way, the call to the <code>query</code> method does not block and returns immediately after sending the query message to the query bus, even though the response message has not been calculated.</p>
</div>
<div class="paragraph">
<p>This way, with Axon Framework, any code sending a query message does not need to wait until the query is fully executed and can do something else while the response is received. Only when we call the <code>get()</code> method on the <code>CompletableFuture</code> the executing thread will block until the response is ready.</p>
</div>
<div class="paragraph">
<p>We could have implemented the method to return the result instead, by returning the result of callling the <code>CompletableFuture::get</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public List&lt;BikeStatus&gt; findAll() {
    CompletableFuture&lt;List&lt;BikeStatus&gt;&gt; result =
        queryGateway.query(FIND_ALL_QUERY, null, ResponseTypes.multipleInstanceOf(BikeStatus.class));
    return result.get(); <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>get()</code> call will block the thread until the result is received back.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this case, the thread calling the <code>findAll</code> method will be blocked until the response message is received, and thus, we are blocking one of the Tomcat&#8217;s worker threads.</p>
</div>
<div class="paragraph">
<p>By returning the <code>CompletableFuture&lt;List&lt;BikeStatus&gt;&gt;</code> we are not blocking the Tomcat Worker Thread inside <code>findAll</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_endpoint_for_findone_query"><a class="anchor" href="#_implementing_endpoint_for_findone_query"></a>Implementing endpoint for <code>findOne</code> query</h3>
<div class="paragraph">
<p>In a similar way, we can add another <code>@GetMapping</code> annotated method to expose the endpoint for receiving requests to get the BikeStatus for a specific bike given its <code>bikeId</code>:</p>
</div>
<div class="listingblock">
<div class="title">/rental/src/main/java/io/axoniq/demo/bikerental/rental/iu/RentalController.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RestController
@RequestMapping("/")
public class RestController {

    @GetMapping("/bikes/{bikeId}") <i class="conum" data-value="1"></i><b>(1)</b>
    public CompletableFuture&lt;BikeStatus&gt; findStatus(@PathVariable("bikeId") String bikeId) { <i class="conum" data-value="2"></i><b>(2)</b>
        return queryGateway.query(BikeStatusNamedQueries.FIND_ONE, bikeId, BikeStatus.class); <i class="conum" data-value="3"></i><b>(3)</b>
    }


}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@GetMapping</code> annotation configures the method to be invoked when a <code>GET</code> request to <code>/bikes/{bikeId}</code> is received, and defines the part of the URL that comes after <code>/bikes/</code> to be assigned to the <code>bikeId</code> path variable.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>@PathVariable("bikeId")</code> annotation instruct Spring to provide to the method argument the value of the URL that matches the <code>bikeId</code> path variable.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We use the <code>query</code> method of the <code>queryGateway</code> to send the query message. This time, we specify the provide <code>bikeId</code> as the query criteria as the second argument, and the <code>BikeStatus.class</code> as the type of the response we are expecting from the query.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_and_invoking_the_queries"><a class="anchor" href="#_running_and_invoking_the_queries"></a>Running and invoking the queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now we can run our application again as we described in <a href="run-app-with-docker-compose.html" class="xref page">Running your application in your local environment with Docker Compose</a> and test that our queries work.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When we invoked the endpoint to register new bikes after we implemented the command handler, the command handler triggered the corresponding <code>BikeRegisteredEvent</code> to notify all the components (like our projection) of the changes.</p>
</div>
<div class="paragraph">
<p>Back then, we didn&#8217;t have our <code>BikeStatusProjection</code> implemented, which means we didn&#8217;t have the event handlers for those <code>BikeRegisteredEvent</code>. What happen to those changes? Have we lost those events? How are we going to keep our query model updated?</p>
</div>
<div class="paragraph">
<p>Remember that Axon Server acts both as a Message Broker (optimized and configured for routing Events, Commands and Queries), but also as an Event Store. Which means not only that it keeps all those Events persisted, but also that its persistence is optimized for the storage and retrieval patterns needed in a Event-Sourcing architecture.</p>
</div>
<div class="paragraph">
<p>When we start Axon Server (as configured in the <code>docker-compose.yml</code> file), Axon Server will start and all the previous events are still available. When our application connects and register the event handlers for the <code>BikeRegisteredEvent</code>, Axon Server will know that this is a new component that needs all the events from the start. Consequently, Axon Server will deliver to our <code>BikeStatusProjection</code> all the past events in the order that they happened.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_invoking_the_findall_and_findone_queries"><a class="anchor" href="#_invoking_the_findall_and_findone_queries"></a>Invoking the <code>findAll</code> and <code>findOne</code> queries</h3>
<div class="paragraph">
<p>To test our <code>findAll</code> query we simply need to send a <code>HTTP GET</code> request to the following endpoint:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://localhost:8080/bikes</pre>
</div>
</div>
<div class="paragraph">
<p>To get the status of a specific bike, we need to send an <code>HTTP GET</code> request to the following URL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://localhost:8080/bikes/{bikeId}</pre>
</div>
</div>
<div class="sect3">
<h4 id="_from_the_command_line"><a class="anchor" href="#_from_the_command_line"></a>From the command line</h4>
<div class="paragraph">
<p>We can invoke the endpoint from the command line using the <code>curl</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">% curl -X GET "http://localhost:8080/bikes"
[
  {
    "bikeId": "8427681b-1ee6-4e0a-b5d8-c524b9ed553d",
    "bikeType": "city",
    "location": "Utrecht",
    "renter": null,
    "status": "AVAILABLE"
  },
  {
    "bikeId": "9f4572c0-c09d-4452-bd31-e0464143baf7",
    "bikeType": "city",
    "location": "Utrecht",
    "renter": null,
    "status": "AVAILABLE"
  },
  {
    "bikeId": "547a47fa-573b-4140-88af-0ea84862944b",
    "bikeType": "city",
    "location": "Utrecht",
    "renter": null,
    "status": "AVAILABLE"
  }
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also invoke the <code>findOne</code> query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">%% curl -X GET "http://localhost:8080/bikes/8427681b-1ee6-4e0a-b5d8-c524b9ed553d"
{
  "bikeId": "8427681b-1ee6-4e0a-b5d8-c524b9ed553d",
  "bikeType": "city",
  "location": "Utrecht",
  "renter": null,
  "status": "AVAILABLE"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_intellij_idea"><a class="anchor" href="#_using_intellij_idea"></a>Using IntelliJ IDEA</h4>
<div class="paragraph">
<p>If you are using IntelliJ IDEA you can edit the <code>requests.http</code> file we created at <a href="invoking-create-bike-endpoint.html#_using_intellij_idea" class="xref page">Invoking the Create Bike EndPoint Using IntelliJ IDEA</a> to add the following lines:</p>
</div>
<div class="listingblock">
<div class="title">/requests.http</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-httprequest hljs" data-lang="httprequest">### List all
# Show available bikes
GET {{rental}}/bikes
Accept: application/json

### Bike status
# Show bike status
GET {{rental}}/bikes/8427681b-1ee6-4e0a-b5d8-c524b9ed553d
Accept: application/json

###</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can click on the green "play" icon that is shown right to the left of the requests to execute the request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">GET http://localhost:8080/bikes

HTTP/1.1 200 OK
Vary: Origin
Vary: Access-Control-Request-Method
Vary: Access-Control-Request-Headers
Content-Type: application/json
Content-Length: 497

[
  {
    "bikeId": "4ee11ca7-3a38-4c37-9584-f016e450998e",
    "bikeType": "city",
    "location": "Utrecht",
    "renter": null,
    "status": "AVAILABLE"
  },
  {
    "bikeId": "9f4572c0-c09d-4452-bd31-e0464143baf7",
    "bikeType": "city",
    "location": "Utrecht",
    "renter": null,
    "status": "AVAILABLE"
  },
  {
    "bikeId": "547a47fa-573b-4140-88af-0ea84862944b",
    "bikeType": "city",
    "location": "Utrecht",
    "renter": null,
    "status": "AVAILABLE"
  },
  {
    "bikeId": "d29775ea-2cd6-4102-b887-552d4cdb84db",
    "bikeType": "city",
    "location": "Utrecht",
    "renter": null,
    "status": "AVAILABLE"
  }
]
Response file saved.
&gt; 2024-04-22T173839.200.json

Response code: 200 (OK); Time: 34ms (34 ms); Content length: 497 bytes (497 B)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion"><a class="anchor" href="#_conclusion"></a>Conclusion.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With this, we have implemented an example of the main message handler component that we will have on an application that is designed to be able to scale out easily:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We have a <strong>command model</strong> with the implementation of the <code>Bike</code> aggregate, that defines the <code>@CommandHandler</code> s and sends the events that notifies the changes made in the system as a result of processing the command. The <strong>command model</strong> also subscribes to those events using some <code>@EventSourcingHandler</code>. This way we can guarantee that the set of events produced by the command handler are the real <strong>source of truth</strong> for any changes in our system.</p>
</li>
<li>
<p>We also have defined the <strong>query model</strong> which consists of a <strong>Projection</strong> of the data kept in a structure that helps replying to any <strong>request for information</strong> as quick as posible. This queries are processed by the <code>@QueryHandlers</code> defined in the Projection.</p>
</li>
<li>
<p>To keep the data in the <strong>Projection</strong> up-to-date, we have defined a set of <code>@EventHandler</code> that will be invoked upon reception of the events sent by the <code>@CommandHandler</code>. This event handlers will update the projection&#8217;s DB accordinglu.</p>
</li>
<li>
<p>Finally, we have a <code>@RestController</code> that exposes the endpoints for invoking the request to register a new bike, or the queries to retrieve information about all or one specific bike. This controller methods, will send the corresponding <code>Command</code> or <code>Query</code> messages through the <code>CommandGateway</code> or <code>QueryGateway</code> provided by Axon Framework.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are the basic components that we will use to implement any further feature in our system. Sometimes, some of those features, can be a little bit more complex and the business logic may require additional things to consider.</p>
</div>
<div class="paragraph">
<p>We will explore some more advanced topics of building applications with Axon Framework in upcoming sections.</p>
</div>
</div>
</div>
        <nav class="pagination">
  <span class="prev"><a href="unit-testing-commands.html">Add Unit Tests For Command Handlers</a></span>
</nav>
    </article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="primary-footer">
    <div class="footer-logo ">
      <a href="https://axoniq.io/">
        <img src="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png" alt="Logo AxonIQ" loading="lazy" srcset="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=45&amp;height=10&amp;name=Logo%20AxonIQ%20(2).png 45w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png 90w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=135&amp;height=30&amp;name=Logo%20AxonIQ%20(2).png 135w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=180&amp;height=40&amp;name=Logo%20AxonIQ%20(2).png 180w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=225&amp;height=50&amp;name=Logo%20AxonIQ%20(2).png 225w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=270&amp;height=60&amp;name=Logo%20AxonIQ%20(2).png 270w" sizes="(max-width: 90px) 100vw, 90px" width="90" height="20">
      </a>
    </div>

    <div class="footer-menu">
	    <h3>Products</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-framework">Axon Framework</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-server">Axon Server</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axoniq-cloud">AxonIQ Cloud</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axoniq-console">AxonIQ Console</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-synapse">Axon Synapse</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/blog/protect-sensitive-data-in-an-event-sourced-application">AxonIQ Data Protection</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Sites</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="http://support.axoniq.io/">Customer Support Portal</a></li>
          <li><a class="ext" target="_blank" href="https://academy.axoniq.io/">AxonIQ Academy</a></li>
          <li><a class="ext" target="_blank" href="https://console.axoniq.io/">AxonIQ Console</a></li>
          <li><a class="ext" target="_blank" href="https://discuss.axoniq.io/">AxonIQ Discuss</a></li>
          <li><a class="ext" target="_blank" href="https://console.cloud.axoniq.io">AxonIQ Cloud</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Follow us</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.youtube.com/axoniq">YouTube</a></li>
          <li><a class="ext" target="_blank" href="https://www.linkedin.com/company/axoniq">LinkedIn</a></li>
          <li><a class="ext" target="_blank" href="https://www.facebook.com/AxonIQ.io">Facebook</a></li>
          <li><a class="ext" target="_blank" href="https://twitter.com/axon_iq">Twitter</a></li>
          <li><a class="ext" target="_blank" href="https://github.com/AxonIQ">GitHub</a></li>
          <li><a class="ext" target="_blank" href="https://medium.com/axoniq">Medium</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script async src="../../_/js/vendor/page-actions.js"></script>
<script async src="../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab" data-sync-storage-scope="session"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
