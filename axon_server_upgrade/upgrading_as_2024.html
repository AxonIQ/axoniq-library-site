<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Upgrading to Axon Server 2024.0.0</title>
    <link rel="canonical" href="https://library.axoniq.io/axon_server_upgrade/upgrading_as_2024.html">
    <link rel="prev" href="index.html">
    <meta name="description" content="The guides to upgrade to Axon Server 2024.0.0">
    <meta name="generator" content="Antora 3.1.1">
    <link rel="stylesheet" href="../_/css/site.css">
    <link rel="stylesheet" href="../_/css/vendor/tabs.css">

        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QD58ZB');</script>
        <!-- End Google Tag Manager -->

    <script>var uiRootPath = '../_'</script>


  </head>
  <body class="article">

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QD58ZB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://library.axoniq.io">Docs</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Reference Guides</a>
          <div class="navbar-dropdown">
                <a class="navbar-item" href="../axon_framework_ref/index.html">Axon Framework</a>
                <a class="navbar-item" href="../axon_server_ref/index.html">Axon Server</a>
                <a class="navbar-item" href="../synapse_ref/latest/index.html">Axon Synapse</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Tutorials</a>
          <div class="navbar-dropdown">
                <a class="navbar-item" href="../axon_framework_fundamentals/index.html">Axon Framework Fundamentals</a>
                <a class="navbar-item" href="../axon-server-fundamentals/index.html">Axon Server Fundamentals</a>
                <a class="navbar-item" href="../synapse-quick-start/latest/index.html">Axon Synapse Quick Start</a>
                <a class="navbar-item" href="../axoniq-console-getting-started/main/index.html">AxonIQ Console Getting Started</a>
                <a class="navbar-item" href="../bikerental-demo/main/index.html">Building An Axon Framework Application From Scratch</a>
          </div>
        </div>
        <a class="navbar-item" href="https://academy.axoniq.io" target="_blank">AxonIQ Academy</a>
        <a class="navbar-item" href="https://discuss.axoniq.io" target="_blank">Discuss</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="axon_server_upgrade" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Axon Server Upgrade Guides</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="upgrading_as_2024.html">Upgrading to Axon Server 2024.0.0</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Axon Server Upgrade Guides</a></li>
    <li><a href="upgrading_as_2024.html">Upgrading to Axon Server 2024.0.0</a></li>
  </ul>
</nav>
<div class="page-actions">
  <button class="actions-menu-toggle" title="Show actions related to this page">Actions</button>
  <div class="actions-menu">
      <a class="action" href="https://github.com/AxonIQ/axoniq-library-site/edit/main/content/axon-server-upgrade-guides/modules/ROOT/pages/upgrading_as_2024.adoc">Edit this Page</a>
    
    <a class="action" href="https://discuss.axoniq.io/search?q&#x3D;https%3A%2F%2Flibrary.axoniq.io%2Faxon_server_upgrade%2Fupgrading_as_2024.html%20%23library" target="discuss_search">View Discussions</a>
    <a class="action" href="https://discuss.axoniq.io/new-topic?category&#x3D;library&amp;title&#x3D;%22Upgrading%20to%20Axon%20Server%202024.0.0%22%20library%20page%20...&amp;body&#x3D;%3C!--%20Replace%20this%20comment%20with%20your%20comment%2Fsuggestion%2Fquestion%2F...%20--%3E%0A%0A%0A%3C!--%0AKeep%20the%20section%20below!%0ALinking%20back%20to%20the%20documentation%20URL%20not%20only%20helps%20people%20go%20to%20the%20page%0Abut%20also%20helps%20find%20relevant%20discussions%20from%20the%20documentation%20page%20via%20the%20%22View%20Discussion%22%20menu.%0A--%3E%0A%5Bdetails%3D%22Related%20library%20page%22%5D%0A%5BUpgrading%20to%20Axon%20Server%202024.0.0%5D(https%3A%2F%2Flibrary.axoniq.io%2Faxon_server_upgrade%2Fupgrading_as_2024.html)%0A%5B%2Fdetails%5D%0A" target="discuss_add">Start new discussion</a>
  </div>
</div>


</div>
    <div class="content">
        <aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
          <article class="doc">
            <h1 class="page">Upgrading to Axon Server 2024.0.0</h1>
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Axon Server 2024.0.0 uses an updated version of the H2 database to store the Control DB. This is required to solve some critical issues in the H2 version used in previous Axon Server versions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_perform_a_manual_upgrade_of_the_control_db_schemas"><a class="anchor" href="#_how_to_perform_a_manual_upgrade_of_the_control_db_schemas"></a>How to perform a manual upgrade of the control DB schemas</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you download Axon Server 2024.0, the package contains a new jar file <code>controldb-migration.jar</code>.  If you wish to upgrade, you need to place this jar file in the working directory of Axon Server (usually the same directory as the <code>axonserver.jar</code> file). When you start Axon Server, it invokes the <code>controldb-migration.jar</code> to migrate the Control DB. After the migration, a new DB file is in the same directory as the old Control DB. This new DB is called <code>axonserver-configdb</code>, the filename is <code>axonserver-configdb.mv.db</code>.  The docker image <code>axoniq/axonserver</code> already contains the <code>controldb-migration.jar</code>.</p>
</div>
<div class="paragraph">
<p>If you have configured the property <code>spring.datasource.url</code> in <code>axonserver.properties yourself</code>, you must update the database name before starting Axon Server. Change the name from <code>axonserver-controldb</code> to <code>axonserver-configdb</code>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="paragraph">
<p><code>spring.datasource.url=jdbc:h2:${axoniq.axonserver.controldb-path:./data}/axonserver-controldb;DEFRAG_ALWAYS=true</code></p>
</div>
<div class="paragraph">
<p>Should now look like this:</p>
</div>
<div class="paragraph">
<p><code>spring.datasource.url=jdbc:h2:${axoniq.axonserver.controldb-path:./data}/axonserver-configdb;DEFRAG_ALWAYS=true</code></p>
</div>
<div class="paragraph">
<p>Or</p>
</div>
<div class="paragraph">
<p><code>spring.datasource.url=jdbc:h2:${axoniq.axonserver.configdb-path:./data}/axonserver-configdb;DEFRAG_ALWAYS=true</code></p>
</div>
<div class="paragraph">
<p>The preferred property to define the location of the configuration database is changed to <code>axoniq.axonserver.configdb-path</code>. The property <code>axoniq.axonserver.controldb-path</code> is deprecated, but still works for this version.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_migration_of_extensions"><a class="anchor" href="#_migration_of_extensions"></a>Migration of extensions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you use the OAuth or LDAP extension for Axon Server, replace the jar files in the <code>exts</code> directory with those included in the new extension.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_upgrade_instructions"><a class="anchor" href="#_upgrade_instructions"></a>Upgrade instructions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The 2024.0.0 release is still compatible with previous releases, so you may do a rolling upgrade.
The upgrade should be reasonably straightforward:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stop the node</p>
</li>
<li>
<p>replace axon server jar</p>
</li>
<li>
<p>do the steps from above for the Control DB migration and extensions</p>
</li>
<li>
<p>start the node</p>
</li>
<li>
<p>Repeat the procedure for every node in the cluster</p>
</li>
</ul>
</div>
</div>
</div>
        <nav class="pagination">
  <span class="prev"><a href="index.html">Axon Server Upgrade Guides</a></span>
</nav>
    </article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="primary-footer">
    <div class="footer-logo ">
      <a href="https://axoniq.io/">
        <img src="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png" alt="Logo AxonIQ" loading="lazy" srcset="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=45&amp;height=10&amp;name=Logo%20AxonIQ%20(2).png 45w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png 90w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=135&amp;height=30&amp;name=Logo%20AxonIQ%20(2).png 135w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=180&amp;height=40&amp;name=Logo%20AxonIQ%20(2).png 180w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=225&amp;height=50&amp;name=Logo%20AxonIQ%20(2).png 225w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=270&amp;height=60&amp;name=Logo%20AxonIQ%20(2).png 270w" sizes="(max-width: 90px) 100vw, 90px" width="90" height="20">
      </a>
    </div>

    <div class="footer-menu">
	    <h3>Products</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-framework/overview">Axon Framework</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-server/overview">Axon Server Standard</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-server-enterprise/overview">Axon Server Enterprise</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axoniq-cloud/overview">AxonIQ Cloud</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/axon-data-protection/overview">AxonIQ Data Protection</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Sites</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="http://support.axoniq.io/"> Client Support Portal</a></li>
          <li><a class="ext" target="_blank" href="https://developer.axoniq.io/">AxonIQ Developer Portal</a></li>
          <li><a class="ext" target="_blank" href="https://academy.axoniq.io/">AxonIQ Academy</a></li>
          <li><a class="ext" target="_blank" href="https://discuss.axoniq.io/">AxonIQ Discuss</a></li>
          <li><a class="ext" target="_blank" href="https://start.axoniq.io/">AxonIQ Initializr</a></li>
          <li><a class="ext" target="_blank" href="https://console.cloud.axoniq.io">AxonIQ Cloud</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Follow us</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.youtube.com/axoniq">YouTube</a></li>
          <li><a class="ext" target="_blank" href="https://www.linkedin.com/company/axoniq">LinkedIn</a></li>
          <li><a class="ext" target="_blank" href="https://www.facebook.com/AxonIQ.io">Facebook</a></li>
          <li><a class="ext" target="_blank" href="https://twitter.com/axon_iq">Twitter</a></li>
          <li><a class="ext" target="_blank" href="https://github.com/AxonIQ">GitHub</a></li>
          <li><a class="ext" target="_blank" href="https://medium.com/axoniq">Medium</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
<script async src="../_/js/vendor/page-actions.js"></script>
<script async src="../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab" data-sync-storage-scope="session"></script>
<script src="../_/js/vendor/lunr.js"></script>
<script src="../_/js/search-ui.js" id="search-ui-script" data-site-root-path=".." data-snippet-length="100" data-stylesheet="../_/css/search.css"></script>
<script async src="../search-index.js"></script>
  </body>
</html>
