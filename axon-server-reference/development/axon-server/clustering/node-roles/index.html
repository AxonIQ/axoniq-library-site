<!DOCTYPE html>
<html lang="en">
  <head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Node Roles</title>
    <link rel="canonical" href="https://docs.axoniq.io/axon-server-reference/v2024.1/axon-server/clustering/node-roles/">
    <link rel="prev" href="../cluster-basics/">
    <link rel="next" href="../replication-groups/">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../../_/css/vendor/tabs.css">
    <link rel="icon" href="../../../../../_/img/favicon.ico" sizes="32x32">
    <link rel="icon" href="../../../../../_/img/icon.svg" type="image/svg+xml" media="(prefers-color-scheme: light)">
    <link rel="icon" href="../../../../../_/img/icon-light.svg" type="image/svg+xml" media="(prefers-color-scheme: dark)">
    <link rel="apple-touch-icon" href="../../../../../_/img/apple-touch-icon.png"><!-- 180Ã—180 -->
    <link rel="manifest" href="../../../../../_/static/manifest.webmanifest">
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QD58ZB');</script>
        <!-- End Google Tag Manager -->

    <script>var uiRootPath = '../../../../../_'</script>


  </head>
  <body class="article">
    <div class="banner">
    <a href="https://console.axoniq.io">Gain deep insights into Axon Framework applications with AxonIQ console. <span class="banner_button">Start now</span></a>
</div>    
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QD58ZB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.axoniq.io"><img src="../../../../../_/img/logo-dark4x.png" class="header_logo" /></a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="../../../../../home/basics/">Basics</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../../../../home/guides/">Guides</a>
          <div class="navbar-dropdown card">
            <a class="navbar-item" href="../../../../../home/guides/axon-framework">Axon Framework</a>
            <a class="navbar-item" href="../../../../../home/guides/axon-server">Axon Server</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../../../../home/reference/">Reference</a>
          <div class="navbar-dropdown card">
                <a class="navbar-item" href="../../../../../axon-framework-reference/4.11/">Axon Framework</a>
                <a class="navbar-item" href="../../../../../axon-framework-extensions/">Axon Framework Extensions</a>
                <a class="navbar-item" href="../../../../v2024.2/">Axon Server</a>
                <a class="navbar-item" href="../../../../../synapse-reference/v0.11/">Axon Synapse</a>
                <a class="navbar-item" href="../../../../../axoniq-console-reference/">AxonIQ Console</a>
          </div>
        </div>
      </div>
      <div class="navbar-end">
        <div class="navbar-item search hide-for-print">
          <div id="search-field" class="field">
            <input id="search-input" type="text" placeholder="Search AxonIQ Docs">
          </div>
        </div>
        <a class="navbar-item navbar-button" href="https://academy.axoniq.io" target="_blank">AxonIQ Academy</a>
        <a class="navbar-item navbar-button" href="https://discuss.axoniq.io" target="_blank">AxonIQ Discuss</a>
        <a class="navbar-item navbar-button" href="https://console.axoniq.io" target="_blank">AxonIQ Console</a>
      </div>
    </div>
  </nav>
</header>
    <div class="toolbar card" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../home/" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../">Axon Server Reference</a></li>
    <li><a href="../">Clustering</a></li>
    <li><a href="./">Node Roles</a></li>
  </ul>
</nav>
<div class="page-actions">
  <button class="actions-menu-toggle" title="Show actions related to this page">Actions</button>
  <div class="actions-menu toolbar_dropdown_menu card">

    <a class="action item" href="https://discuss.axoniq.io/search?q&#x3D;Node%20Roles" target="discuss_search">View Discussions</a>
    <a class="action item" href="https://discuss.axoniq.io/new-topic?category&#x3D;library&amp;title&#x3D;%22Node%20Roles%22%20Discussion&amp;body&#x3D;%3C!--%20Replace%20this%20comment%20with%20your%20comment%2Fsuggestion%2Fquestion%2F...%20--%3E%0A%0A%0A%3C!--%0AKeep%20the%20section%20below!%0ALinking%20back%20to%20the%20documentation%20URL%20not%20only%20helps%20people%20go%20to%20the%20page%0Abut%20also%20helps%20find%20relevant%20discussions%20from%20the%20documentation%20page%20via%20the%20%22View%20Discussion%22%20menu.%0A--%3E%0A%5Bdetails%3D%22Related%20library%20page%22%5D%0A%5BNode%20Roles%5D(https%3A%2F%2Fdocs.axoniq.io%2Faxon-server-reference%2Fdevelopment%2Faxon-server%2Fclustering%2Fnode-roles%2F)%0A%5B%2Fdetails%5D%0A" target="discuss_add">Start new discussion</a>
  </div>
</div>


<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">development</button>
  <div class="version-menu toolbar_dropdown_menu card">
    <a class="version item is-current" href="./">development</a>
    <a class="version item is-missing" href="../../../../v2024.2/">v2024.2</a>
    <a class="version item" href="../../../../v2024.1/axon-server/clustering/node-roles/">v2024.1</a>
    <a class="version item is-missing" href="../../../../0/">older releases</a>
  </div>
</div>
</div>
    <div class="content_container">
      <div class="body">
<div class="nav-container" data-component="axon-server-reference" data-version="development">
    <aside class="nav card">
      <div class="panels">
        <div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../">Axon Server</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../installation/">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/local-installation/">Local installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/docker-k8s/">Docker / K8s</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../administration/">Administration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../administration/admin-configuration/">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/admin-configuration/configuration/">System properties</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/admin-configuration/command-line-interface/">Command Line Interface</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/admin-configuration/rest-api/">REST API</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/admin-configuration/grpc-api/">gRPC API</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../administration/monitoring/">Monitoring</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/monitoring/actuator-endpoints/">Actuator Endpoints</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/monitoring/axon-server-metrics/">Axon Server Metrics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/monitoring/grpc-metrics/">gRPC Metrics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/monitoring/heartbeat-monitoring/">Heartbeat Monitoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/monitoring/diagnostics/">Diagnostics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/multi-context/">Multi-Context</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/tiered-storage/">Tiered Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/event-transformation/">Event Transformation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/tagging/">Tagging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/backups/">Backups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/recovery/">Recovery</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/plugins/">Axon Server Plugins</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../administration/logging/">Logging</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../administration/logging/logging-format/">Logging Format</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../administration/error-codes/">Error Codes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../">Clustering</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cluster-basics/">Cluster Basics</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="./">Node Roles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../replication-groups/">Replication Groups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../replication-logs/">Replication Logs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../security/">Security</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/ssl/">SSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-ee/">Access Control for Axon Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-clients/">Security for Axon Framework Client Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-cli/">Access Control and the CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-api/">Access Control on the REST and gRPC APIs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-ldap/">Axon Server EE - LDAP Extension</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-oauth2/">Axon Server EE - OAuth Extension</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../performance/">Performance</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../performance/tuning-event-processing/">Event Segments</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../performance/flow-control/">Flow Control</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../migration/">Migration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../migration/non-axon-server-to-axon-server/">Non-Axon Server to Axon Server</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../architecture/">Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../architecture/config-database/">Config Database</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../troubleshooting/">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../release-notes/">Release Notes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../rn-as-major-releases/">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../rn-as-minor-releases/">Patch Releases</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
      </div>
    </aside>
</div>
<main class="article">
    <div class="page_content">
        <aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
          <article class="doc">
            <h1 class="page">Node Roles</h1>
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><!-- vale Google.Passive = NO -->
<!-- vale Google.Will = NO -->
<!-- vale Google.We = NO -->
<!-- vale Google.EnDash = NO --></p>
</div>
<div class="paragraph">
<p>When you have larger clusters and specific requirements, you may want to have nodes acting in a different way within a replication group.
For this reason, in Axon Server 4.3, we have introduced a number of new roles that can be assigned to a node.</p>
</div>
<div class="paragraph">
<p>These are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Primary nodes -&gt;</em> This is the role for nodes prior to 4.3. Primary nodes handle client connections and messages, store events and may act as the leader for a replication group.</p>
</li>
<li>
<p><em>Backup nodes -&gt;</em> These nodes maintain a copy of the event store, but will never become the leader of a replication group.
There are two types of Backup nodes - <a href="#active-backup-node">Active Backup</a> and <a href="#passive-backup-node">Passive Backup</a>.</p>
</li>
<li>
<p><em>Messaging-only nodes</em> -&gt; They handle client connections and all types of messages (Commands/Queries/Events) but they do not have an event store.</p>
</li>
<li>
<p><em>Secondary nodes</em> -&gt; Support for tiered storage.
If a replication group contains secondary nodes the primary nodes will only retain recent data.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each replication group needs to have at least one Primary node.
This node is capable of becoming a leader and coordinating transactions across the replication group between the different member nodes.
Even if you are not using Axon Server as an event store, you still need a leader as transactions also include making changes to the replication group configuration and access control lists.
It is also possible to <a href="#changing-node-roles">change the role</a> that a particular node plays within a context.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="backup-nodes"><a class="anchor" href="#backup-nodes"></a>Backup nodes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use backup nodes for instance when you want to ensure that you have a copy of your event store in another data center.
As the backup node will never become the leader for a replication group it reduces the risk of high latency, compared to having a normal (Primary) node in another data center.
By default, clients can connect to backup nodes.
This can be disabled by setting the <code>axoniq.axonserver.force-connection-to-primary-or-messaging-node</code> property to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>Backup nodes come in two flavors</p>
</div>
<div class="sect2">
<h3 id="active-backup-node"><a class="anchor" href="#active-backup-node"></a>Active backup node</h3>
<div class="paragraph">
<p>Active backup nodes maintain a real time copy of the Event Store by being <em>active</em> <em>participants</em> in transactions.
To expand this, suppose a replication group within an Axon Server cluster has Active Backup nodes assigned to it (in addition to the Primary nodes).
When an event is raised within a context the transaction to commit it in the Event Store is only confirmed if it receives a successful acknowledgement from at-least a certain number of those Active Backup nodes.</p>
</div>
<div class="paragraph">
<p>It is possible to customize the number of active backup nodes involved in the transactions by changing the value of the property <code>axoniq.axonserver.replication.min-active-backups</code> . The default value of this parameter is <code>"1"</code> which means that if you have Active Backup nodes, at least one of them needs to be up at any time.
The higher the value set for this property, the higher the number of Active backup member nodes that need to be available for a successful transaction, so this property affects the availability of the cluster and hence needs to be carefully managed.</p>
</div>
<div class="paragraph">
<p>There are three possible ways to assign the ACTIVE_BACKUP role to a node within a replication group:</p>
</div>
<div class="paragraph">
<p>A) The Axon Server UI Console.
Navigate to the Replication Groups icon on the navigation menu of the console which will open up the replication group maintenance screen.
The nodes can be added as an ACTIVE_BACKUP role within a replication group.</p>
</div>
<div class="paragraph">
<p>B) The <em>add-node-to-replication-group</em> command with the role option as ACTIVE_BACKUP</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ java -jar axonserver-cli.jar add-node-to-replication-group  -S http://[node]:[port] -n [node name] -g [replication-group-name] -r PASSIVE_BACKUP</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Mandatory parameters</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-g</code> refers to an existing replication group</p>
</li>
<li>
<p><code>-n</code> refers to the node name that should be a member of this replication group</p>
</li>
<li>
<p><code>-r as PASSIVE_BACKUP</code> refers to the role of this node within the replication group</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Optional parameters</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-S</code> if not supplied connects by default to <a href="http://localhost:8024" class="bare">http://localhost:8024</a>. If supplied, it should be any node serving the <em>_admin</em> context</p>
</li>
<li>
<p><code>-t</code> refers to the access token to authenticate at server</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>C) Axon Server provided REST API (http:[server]:[port]/swagger-ui.html) which offers the <em>replication-group-rest-controller</em> to help perform role maintenance operations</p>
</div>
</div>
<div class="sect2">
<h3 id="passive-backup-node"><a class="anchor" href="#passive-backup-node"></a>Passive backup node</h3>
<div class="paragraph">
<p>Passive Backup nodes follow the primary nodes with on a best effort base.
If they are disconnected for some time, it will not impact the overall availability of the replication group.
Once the Passive backup nodes are connected again, they will update their event stores with the events that were added while they were gone.
If you don&#8217;t require the backup node to be fully up-to-date at any moment, you can configure one passive backup node.</p>
</div>
<div class="paragraph">
<p>There are three possible ways to assign the PASSIVE_BACKUP role to a node within a replication group:</p>
</div>
<div class="paragraph">
<p>A) The Axon Server UI Console.
Navigate to the Replication Groups icon on the navigation menu of the console which will open up the replication group maintenance screen.
The nodes can be added as a PASSIVE_BACKUP role within a replication group.</p>
</div>
<div class="paragraph">
<p>B) The <em>add-node-to-replication-group</em> command with the role option as PASSIVE_BACKUP</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ java -jar axonserver-cli.jar add-node-to-replication-group  -S http://[node]:[port] -n [node name] -g [replication-group-name] -r PASSIVE_BACKUP</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Mandatory parameters</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-g</code> refers to an existing replication group</p>
</li>
<li>
<p><code>-n</code> refers to the node name that should be a member of this replication group</p>
</li>
<li>
<p><code>-r as PASSIVE_BACKUP</code> refers to the role of this node within the replication group</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Optional parameters</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-S</code> if not supplied connects by default to <a href="http://localhost:8024" class="bare">http://localhost:8024</a>. If supplied, it should be any node serving the <em>_admin</em> context</p>
</li>
<li>
<p><code>-t</code> refers to the access token to authenticate at server</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>C) Axon Server provided REST API (http:[server]:[port]/swagger-ui.html) which offers the <em>replication-group-rest-controller</em> to help perform role maintenance operations</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="messaging-only-nodes"><a class="anchor" href="#messaging-only-nodes"></a>Messaging-only nodes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can add nodes as messaging-only nodes to a replication group, if you don&#8217;t want to use Axon Server as an event store, or if you want to have a large number of Axon Server nodes for a single replication group, without storing the events on each node.
As the name already suggests, messaging-only nodes only route messages, they do not store events themselves.
They do not participate in transactions and will clearly never become the leader for a replication-group.</p>
</div>
<div class="paragraph">
<p>There are three possible ways to assign the MESSAGING_ONLY role to a node within a replication group:</p>
</div>
<div class="paragraph">
<p>A) The Axon Server UI Console.
Navigate to the Replication Groups icon on the navigation menu of the console which will open up the replication group maintenance screen.
The nodes can be added as a MESSAGING_ONLY role within a replication group.</p>
</div>
<div class="paragraph">
<p>B) The <em>add-node-to-replication-group</em> command with the role option as MESSAGING_ONLY</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ java -jar axonserver-cli.jar add-node-to-replication-group  -S http://[node]:[port] -n [node name] -g [replication-group-name] -r MESSAGING_ONLY</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Mandatory parameters</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-c</code> refers to an existing replication group</p>
</li>
<li>
<p><code>-n</code> refers to the node name that should be a member of this replication group</p>
</li>
<li>
<p><code>-r as MESSAGING_ONLY</code> refers to the role of this node within the replication group</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Optional parameters</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-S</code> if not supplied connects by default to <a href="http://localhost:8024" class="bare">http://localhost:8024</a>. If supplied, it should be any node serving the <em>_admin</em> context</p>
</li>
<li>
<p><code>-t</code> refers to the access token to authenticate at server</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>C) Axon Server provided REST API (http:[server]:[port]/swagger-ui.html) which offers the <em>replication-group-rest-controller</em> to help perform role maintenance operations</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="secondary-nodes"><a class="anchor" href="#secondary-nodes"></a>Secondary nodes</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Axon Server version 4.4 and higher
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can add nodes as secondary nodes to a replication group, if you want to limit the amount of data stored on primary nodes.
You could for example have fast (more expensive) storage on the primary nodes and less expensive storage on the secondary nodes.
Most activity will take place on recent data, and only when you need to access older data you have to go to the secondary nodes.</p>
</div>
<div class="paragraph">
<p>Once you have defined secondary nodes for a replication group, this will apply for all contexts that are defined in the replication group.
You can configure the retention time per context, so for some contexts you may have a longer retention time than for others.</p>
</div>
<div class="paragraph">
<p>As the old data still needs to be available at least one SECONDARY node needs to be up at all times.
PRIMARY nodes will not delete information from their event stores until all SECONDARY nodes have this information.</p>
</div>
<div class="paragraph">
<p>There are three possible ways to assign the SECONDARY role to a node within a replication group:</p>
</div>
<div class="paragraph">
<p>A) The Axon Server UI Console.
Navigate to the Replication Groups icon on the navigation menu of the console which will open up the replication group maintenance screen.
The nodes can be added as a MESSAGING_ONLY role within a replication group.</p>
</div>
<div class="paragraph">
<p>B) The <em>add-node-to-replication-group</em> command with the role option as SECONDARY.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ java -jar axonserver-cli.jar add-node-to-replication-group  -S http://[node]:[port] -n [node name] -g [replication-group-name] -r SECONDARY</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Mandatory parameters</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-c</code> refers to an existing replication group</p>
</li>
<li>
<p><code>-n</code> refers to the node name that should be a member of this replication group</p>
</li>
<li>
<p><code>-r as SECONDARY</code> refers to the role of this node within the replication group</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Optional parameters</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-S</code> if not supplied connects by default to <a href="http://localhost:8024" class="bare">http://localhost:8024</a>. If supplied, it should be any node serving the <em>_admin</em> context</p>
</li>
<li>
<p><code>-t</code> refers to the access token to authenticate at server</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>C) Axon Server provided REST API (http:[server]:[port]/swagger-ui.html) which offers the <em>replication-group-rest-controller</em> to help perform role maintenance operations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="changing-node-roles"><a class="anchor" href="#changing-node-roles"></a>Changing node roles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes you may want to change the role a node has for a specific replication group.
This may happen when you have a pre-existing cluster replication grou configuration (pre 4.3) and now you want to be able to start using the new roles.
The way to do this is to remove a node from a replication group and then add it again in the new role.</p>
</div>
<div class="paragraph">
<p>When you remove the node from the replication group you have an option to preserve the event store.
Preserving the event store is recommended when you want to change the role for a node from <em>PRIMARY</em> to <em>BACKUP</em>, or vice versa, as it would prevent a full replication of the event store when the node is added again with the new role.</p>
</div>
<div class="paragraph">
<p>There are three possible ways to change the role of a node within a replication group:</p>
</div>
<div class="paragraph">
<p>A) The Axon Server UI Console.
Navigate to the Replication Groups icon on the navigation menu of the console which will open up the replication group maintenance screen.
You can choose to delete the specific node from the context (using the delete icon).
In case you would like to preserve the event store, click on the check-box in the pop-up.</p>
</div>
<div class="paragraph">
<p>B) The <em>delete-node-from-replication-group</em> command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">$ java -jar ./axonserver-cli.jar delete-node-from-replication-group -S http://[node]:[port] -g [replication-group-name] -n [node name]</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Mandatory parameters</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-g</code> refers to an existing replication group</p>
</li>
<li>
<p><code>-n</code> refers to the node name that should be a member of this replication group</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Optional parameters</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-S</code> if not supplied connects by default to <a href="http://localhost:8024" class="bare">http://localhost:8024</a>. If supplied, it should be any node serving the <em>_admin</em> context</p>
</li>
<li>
<p><code>-t</code> refers to the access token to authenticate at server</p>
</li>
<li>
<p><code>â€“preserve-event-store</code> removes the node from the replication group but leaves the event store files on that node.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>C) Axon Server provided REST API (http:[server]:[port]/swagger-ui.html) which offers the <em>replication-group-rest-controller</em> to help perform role maintenance operations</p>
</div>
</div>
</div>
        <nav class="pagination">
  <span class="prev"><a href="../cluster-basics/">Cluster Basics</a></span>
  <span class="next"><a href="../replication-groups/">Replication Groups</a></span>
</nav>
    </article>
  </div>
</main>
</div>
      <footer class="footer">
  <div class="primary-footer">
    <div class="footer-logo ">
      <a href="https://axoniq.io/">
        <img src="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png" alt="Logo AxonIQ" loading="lazy" srcset="https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=45&amp;height=10&amp;name=Logo%20AxonIQ%20(2).png 45w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=90&amp;height=20&amp;name=Logo%20AxonIQ%20(2).png 90w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=135&amp;height=30&amp;name=Logo%20AxonIQ%20(2).png 135w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=180&amp;height=40&amp;name=Logo%20AxonIQ%20(2).png 180w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=225&amp;height=50&amp;name=Logo%20AxonIQ%20(2).png 225w, https://www.axoniq.io/hs-fs/hubfs/Logo%20AxonIQ%20(2).png?width=270&amp;height=60&amp;name=Logo%20AxonIQ%20(2).png 270w" sizes="(max-width: 90px) 100vw, 90px" width="90" height="20">
      </a>
    </div>

    <div class="footer-menu">
	    <h3>Products</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-framework">Axon Framework</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-server">Axon Server</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axoniq-cloud">AxonIQ Cloud</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axoniq-console">AxonIQ Console</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/products/axon-synapse">Axon Synapse</a></li>
          <li><a class="ext" target="_blank" href="https://www.axoniq.io/blog/protect-sensitive-data-in-an-event-sourced-application">AxonIQ Data Protection</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Sites</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="http://support.axoniq.io/">Customer Support Portal</a></li>
          <li><a class="ext" target="_blank" href="https://academy.axoniq.io/">AxonIQ Academy</a></li>
          <li><a class="ext" target="_blank" href="https://console.axoniq.io/">AxonIQ Console</a></li>
          <li><a class="ext" target="_blank" href="https://discuss.axoniq.io/">AxonIQ Discuss</a></li>
          <li><a class="ext" target="_blank" href="https://console.cloud.axoniq.io">AxonIQ Cloud</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-menu">
	    <h3>Follow us</h3>
	    <div>
        <ul role="menu">
          <li><a class="ext" target="_blank" href="https://www.youtube.com/axoniq">YouTube</a></li>
          <li><a class="ext" target="_blank" href="https://www.linkedin.com/company/axoniq">LinkedIn</a></li>
          <li><a class="ext" target="_blank" href="https://github.com/AxonIQ">GitHub</a></li>
          <li><a class="ext" target="_blank" href="https://axoniq.bsky.social/">Bluesky</a></li>
          <li><a class="ext" target="_blank" href="https://www.instagram.com/axoniq/">Instagram</a></li>
          <li><a class="ext" target="_blank" href="https://www.facebook.com/AxonIQ.io">Facebook</a></li>
          <li><a class="ext" target="_blank" href="https://twitter.com/axon_iq">Twitter</a></li>
          <li><a class="ext" target="_blank" href="https://medium.com/axoniq">Medium</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>
<script id="site-script" src="../../../../../_/js/site.js" data-ui-root-path="../../../../../_"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../_/js/vendor/page-actions.js"></script>
<script async src="../../../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab" data-sync-storage-scope="session"></script>
<script src="../../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../../.." data-snippet-length="100" data-stylesheet="../../../../../_/css/search.css"></script>
<script async src="../../../../../search-index.js"></script>
    </div>
  </body>
</html>
