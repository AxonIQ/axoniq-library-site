<!DOCTYPE html>
<html lang="en">
  <head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Clusters</title>
    <link rel="canonical" href="https://docs.axoniq.io/axon-server-reference/v2024.2/axon-server/administration/clustering/">
    <link rel="prev" href="../monitoring/diagnostics/">
    <link rel="next" href="../replication-groups/">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../../_/css/vendor/tabs.css">
    <link rel="icon" href="../../../../../_/img/favicon.png" sizes="32x32">
    <link rel="apple-touch-icon" href="../../../../../_/img/favicon.png"><!-- 180×180 -->
    <link rel="manifest" href="../../../../../_/static/manifest.webmanifest">

        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QD58ZB');</script>
        <!-- End Google Tag Manager -->

    <script>var uiRootPath = '../../../../../_'</script>


<link rel="icon" href="../../../../../_/img/favicon.png" type="image/png">
  </head>
  <body class="article">
    <div class="header_container">
      
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QD58ZB"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.axoniq.io">
        <img src="../../../../../_/img/docs-logo.png" class="header_logo"/>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-center">
        <a class="navbar-item" href="../../../../../home/basics/">Basics</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../../../../home/guides/">Guides</a>
          <div class="navbar-dropdown card">
            <a class="navbar-item" href="../../../../../home/guides/axon-framework">Axon Framework</a>
            <a class="navbar-item" href="../../../../../home/guides/axon-server">Axon Server</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="../../../../../home/reference/">Reference</a>
          <div class="navbar-dropdown card">
                <a class="navbar-item" href="../../../../../axon-framework-reference/4.11/">Axon Framework</a>
                <a class="navbar-item" href="../../../../../axon-framework-extensions/">Axon Framework Extensions</a>
                <a class="navbar-item" href="../../../../development/">Axon Server</a>
                <a class="navbar-item" href="../../../../../synapse-reference/v0.12/">Axon Synapse</a>
                <a class="navbar-item" href="../../../../../axoniq-platform-reference/">Axoniq Platform</a>
          </div>
        </div>
      </div>
      <div class="navbar-end">
          <div class="navbar-item search hide-for-print">
            <div id="search-field" class="field">
              <input id="search-input" type="text" placeholder="Search AxonIQ Docs">
            </div>
          </div>
        <a class="navbar-item navbar-button" href="https://platform.axoniq.io" target="_blank">Axoniq Platform</a>
      </div>
    </div>
  </nav>
</header>
      <div class="toolbar card" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../home/" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../../">Axon Server Reference</a></li>
    <li><a href="../">Administration</a></li>
    <li><a href="./">Clusters</a></li>
  </ul>
</nav>
<div class="page-actions">
  <button class="actions-menu-toggle" title="Show actions related to this page">Actions</button>
  <div class="actions-menu toolbar_dropdown_menu card">

    <a class="action item" href="https://discuss.axoniq.io/search?q&#x3D;Clusters" target="discuss_search">View Discussions</a>
    <a class="action item" href="https://discuss.axoniq.io/new-topic?category&#x3D;library&amp;title&#x3D;%22Clusters%22%20Discussion&amp;body&#x3D;%3C!--%20Replace%20this%20comment%20with%20your%20comment%2Fsuggestion%2Fquestion%2F...%20--%3E%0A%0A%0A%3C!--%0AKeep%20the%20section%20below!%0ALinking%20back%20to%20the%20documentation%20URL%20not%20only%20helps%20people%20go%20to%20the%20page%0Abut%20also%20helps%20find%20relevant%20discussions%20from%20the%20documentation%20page%20via%20the%20%22View%20Discussion%22%20menu.%0A--%3E%0A%5Bdetails%3D%22Related%20library%20page%22%5D%0A%5BClusters%5D(https%3A%2F%2Fdocs.axoniq.io%2Faxon-server-reference%2Fv2024.2%2Faxon-server%2Fadministration%2Fclustering%2F)%0A%5B%2Fdetails%5D%0A" target="discuss_add">Start new discussion</a>
  </div>
</div>


<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">v2024.2</button>
  <div class="version-menu toolbar_dropdown_menu card">
    <a class="version item is-missing" href="../../../../development/">development</a>
    <a class="version item is-missing" href="../../../../v2025.2/">v2025.2</a>
    <a class="version item is-missing" href="../../../../v2025.1/">v2025.1</a>
    <a class="version item is-missing" href="../../../../v2025.0/">v2025.0</a>
    <a class="version item is-current" href="./">v2024.2</a>
    <a class="version item is-missing" href="../../../../v2024.1/">v2024.1</a>
    <a class="version item is-missing" href="../../../../0/">older releases</a>
  </div>
</div>
</div>
    </div>
    <div class="content_container">
      <div class="body">
<div class="nav-container" data-component="axon-server-reference" data-version="v2024.2">
    <aside class="nav card">
      <div class="panels">
        <div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../">Axon Server</a></h3>

<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../installation/">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/local-installation/">Local installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/docker-k8s/">Docker / K8s</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../">Administration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../admin-configuration/">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../admin-configuration/configuration/">System properties</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../admin-configuration/command-line-interface/">Command Line Interface</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../admin-configuration/rest-api/">REST API</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../admin-configuration/grpc-api/">gRPC API</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../monitoring/">Monitoring</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../monitoring/actuator-endpoints/">Actuator Endpoints</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../monitoring/axon-server-metrics/">Axon Server Metrics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../monitoring/grpc-metrics/">gRPC Metrics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../monitoring/heartbeat-monitoring/">Heartbeat Monitoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../monitoring/diagnostics/">Diagnostics</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="./">Clusters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../replication-groups/">Replication Groups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../multi-context/">Multi-Context</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tiered-storage/">Tiered Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../event-transformation/">Event Transformation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tagging/">Tagging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../backup-and-messaging-only-nodes/">Backup and Messaging-Only Nodes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../backups/">Backups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../recovery/">Recovery</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugins/">Axon Server Plugins</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../logging/">Logging</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../logging/logging-format/">Logging Format</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../error-codes/">Error Codes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../security/">Security</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/ssl/">SSL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-ee/">Access Control for Axon Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-clients/">Security for Axon Framework Client Applications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-cli/">Access Control and the CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-api/">Access Control on the REST and gRPC APIs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-ldap/">Axon Server EE - LDAP Extension</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../security/access-control-oauth2/">Axon Server EE - OAuth Extension</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../performance/">Performance</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../performance/tuning-event-processing/">Event Segments</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../performance/flow-control/">Flow Control</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../migration/">Migration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../migration/non-axon-server-to-axon-server/">Non-Axon Server to Axon Server</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../release-notes/">Release Notes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../rn-as-major-releases/">Major Releases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../rn-as-minor-releases/">Patch Releases</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
      </div>
    </aside>
</div>
<main class="article">
    <div class="page_content">
        <aside class="toc sidebar" data-title="Page content" data-levels="2">
  <div class="toc-menu"></div>
</aside>
          <article class="doc">
                <h1 class="page">Clusters</h1>
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><!-- vale Google.Passive = NO -->
<!-- vale Google.Will = NO -->
<!-- vale Google.We = NO -->
<!-- vale Google.EnDash = NO --></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This feature is part not supported in the <em>Developer</em> plan
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Axon Server can be deployed as a <em>cluster</em> to guarantee high availability.
A cluster of Axon Server nodes will provide multiple connection points for (Axon Framework-based) client applications, and thus share the load of managing message delivery and event storage.
Client applications will dynamically connect to a node in the cluster and automatically reconnect to another, should the node that they are currently connected to become unreachable.</p>
</div>
<div class="paragraph">
<p>An Axon Server EE cluster has 3 main areas of administration,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cluster Nodes - "Instances" of Axon Server that need to be part of the cluster.</p>
</li>
<li>
<p><a href="../replication-groups/" class="xref page">Replication Groups</a> - Responsible for event data replication and transaction management between the various nodes of a cluster.</p>
</li>
<li>
<p><a href="../multi-context/" class="xref page">Contexts</a> - Responsible for event storage within the various nodes of a cluster.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A visual representation of the relationship between the 3 is shown below.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../_images/clusters.jpg" alt="Relationship between Cluster Nodes / Replication Groups and Contexts"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setup_process"><a class="anchor" href="#_setup_process"></a>Setup process</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The cluster setup process always begins by designating any one clean/uninitialized Axon Server EE node as the first member of the cluster.
You can then run the "<a href="../admin-configuration/command-line-interface/#cluster-enterprise-edition-only" class="xref page">init-cluster</a>" command on it which will create the following replication groups and contexts -&gt; <em>admin/default.</em></p>
</div>
<div class="paragraph">
<p>From thereon, there are multiple ways to continue the setup depending upon your Event Store deployment topology.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any other Axon Server node can be added to the cluster using the "register-node" command without associating it with any Replication Group / Context.</p>
</li>
<li>
<p>New Replication Groups/Contexts can be added and cluster member nodes can be associated with these.</p>
</li>
<li>
<p>Member nodes can be removed from the cluster at any point of time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Axon provides two ways for automating cluster configuration.
The first is the <a href="#automatic-initialization">Automatic Initialization</a> feature and the other is the <a href="#cluster-templates">Cluster Template</a> feature.</p>
</div>
<div class="sect2">
<h3 id="automatic-initialization"><a class="anchor" href="#automatic-initialization"></a>Automatic initialization</h3>
<div class="paragraph">
<p>The manual process of member registration of the cluster can be bypassed by setting a couple of properties in the axonserver.properties file.</p>
</div>
<div class="paragraph">
<p>axoniq.axonserver.autocluster.first=internal-hostname:internal-port axoniq.axonserver.autocluster.contexts=context1,context2</p>
</div>
<div class="paragraph">
<p>The <em>axoniq.axonserver.autocluster.first</em> property defines the first node in the cluster, by specifying its internal hostname (the hostname used by other Axon Server nodes to connect to this host), and the internal port.
If the internal port is default (8224) it can be omitted.</p>
</div>
<div class="paragraph">
<p><em>axoniq.axonserver.autocluster.contexts</em> defines the contexts to create on the first node and the context to join for the other nodes.
All of these contexts will be joined as primary nodes.
When you don&#8217;t specify any contexts, the initial node will only create an admin context, the other nodes will join the cluster, but not be a member of any contexts.</p>
</div>
<div class="paragraph">
<p>The autocluster properties will only take effect on a clean start of a node.
If a node is already initialized, it will not create any contexts anymore, nor join the cluster again.</p>
</div>
</div>
<div class="sect2">
<h3 id="cluster-templates"><a class="anchor" href="#cluster-templates"></a>Cluster templates</h3>
<div class="paragraph">
<p>The cluster template is defined as a YAML file, describing a cluster&#8217;s configuration.
It is possible to predefine replication groups, contexts, metadata, applications (with tokens), and users (with their roles), so that the configuration can be shared across teams.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The cluster template runs exactly once, on the first clean Axon Server start-up, if there is no previous cluster configuration defined.
Therefore, the cluster template <strong>will not</strong> override any existing configuration.
Its purpose is to be used during active development, to be able to share the configuration across development teams.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_usage"><a class="anchor" href="#_usage"></a>Usage</h4>
<div class="paragraph">
<p>To use the cluster template feature, all you need to do is define a valid cluster template YAML file.
If this file is present on a fresh Axon Server startup, it will automatically be picked up and the cluster will be configured accordingly.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Each cluster node needs to have the cluster template YAML file copy.
Each node will read this file, find its own configuration and configure itself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Default path from which Axon Server reads configuration is <code>./cluster-template.yml</code></p>
</div>
<div class="paragraph">
<p>You can override this path anytime by setting Axon Server property: <code>axoniq.axonserver.clustertemplate.path:/mypath/cluster-template.yml</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_configuration"><a class="anchor" href="#_configuration"></a>Configuration</h4>
<div class="paragraph">
<p>Below you can find an example of a basic cluster setup: the _admin and default contexts are in separate replication nodes, replicated across all nodes that are marked as primary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">axoniq:
  axonserver:
    cluster-template:
      first: internal-hostname:internal-port
      replicationGroups:
      - name: _admin
        roles:
        - node: axonserver-1
          role: PRIMARY
        - node: axonserver-2
          role: PRIMARY
        - node: axonserver-3
          role: PRIMARY
        contexts:
        - name: _admin
      - name: default
        roles:
        - node: axonserver-2
          role: PRIMARY
        - node: axonserver-3
          role: PRIMARY
        - node: axonserver-1
          role: PRIMARY
        contexts:
        - name: default
      applications: []
      users: []</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../_images/cluster-template-default-configuration.png" alt="Cluster overview after default configuration is applied"></span></p>
</div>
<div class="paragraph">
<p><em>Cluster overview after default configuration is applied</em></p>
</div>
</div>
<div class="sect3">
<h4 id="_export"><a class="anchor" href="#_export"></a>Export</h4>
<div class="paragraph">
<p>In order to avoid mistakes while writing a cluster configuration file, we have implemented an export button that will generate a cluster template file based on current setup.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../../_images/cluster-template-export-button.png" alt="Cluster Template export button location"></span></p>
</div>
<div class="paragraph">
<p><em>Location of export button at Settings page</em></p>
</div>
<div class="paragraph">
<p><strong>Recommended mechanism - Creating an advanced cluster setup</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start a fresh Axon Server setup (use basic cluster template setup mentioned above).</p>
</li>
<li>
<p>Configure a cluster via the UI, by creating users, applications, replication groups and contexts.</p>
</li>
<li>
<p>Use the export button located at "Settings -&gt; Configuration" panel to download the current cluster configuration.</p>
</li>
<li>
<p>Replace the basic cluster template with the newly exported cluster template configuration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use export button from any admin node to ensure that the configuration file contains all the relevant information.</p>
</div>
</div>
</div>
</div>
</div>
        <nav class="pagination">
  <span class="prev"><a href="../monitoring/diagnostics/">Diagnostics</a></span>
  <span class="next"><a href="../replication-groups/">Replication Groups</a></span>
</nav>
    </article>
  </div>
</main>
</div>
      <footer class="footer">
  <div class="secondary-footer">
    <p>Copyright © 2025 AxonIQ BV. All Rights Reserved</p>
    <img referrerpolicy="no-referrer-when-downgrade" src="https://static.scarf.sh/a.png?x-pxid=e0b2b5cb-139e-4753-acab-bae43f90c5d3" />
  </div>
</footer>
<script id="site-script" src="../../../../../_/js/site.js" data-ui-root-path="../../../../../_"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script async src="../../../../../_/js/vendor/page-actions.js"></script>
<script async src="../../../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab" data-sync-storage-scope="session"></script>
<script src="../../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../../.." data-snippet-length="100" data-stylesheet="../../../../../_/css/search.css"></script>
<script async src="../../../../../search-index.js"></script>
    </div>
  </body>
</html>
